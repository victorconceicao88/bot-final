<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Faça seu pedido online no Restaurante Cozinha da Vivi - Comida caseira de qualidade">
  <title>Cozinha da Vivi - Pedido Online</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

  <style>
:root {
  --primary-color: #280b04;
  --secondary-color: #ffb501;
  --dark-color: #2f3542;
  --light-color: #f1f2f6;
  --success-color: #617c33;
}

body {
  font-family: 'Poppins', sans-serif;
  background-color: #fff1ea;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.main-content {
  flex: 1;
  background-color: #fff1ea;
}

/* Navbar Fixo */
.main-header {
  position: sticky;
  top: 0;
  z-index: 1030;
  background-color: #fff1e4;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  padding: 0.5rem 0;
}

.navbar-container {
  max-width: 1200px;
  margin: 0 auto;
  width: 100%;
  padding: 0 15px;
}

.logo-container {
  display: flex;
  align-items: center;
  gap: 15px;
  cursor: pointer;
}

.logo-img {
  height: 50px;
  width: 50px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--primary-color);
  transition: transform 0.2s;
}

.option-section .max-selection {
  color: #dc3545;
  font-size: 0.8rem;
  margin-top: 5px;
  display: none;
}
  
.option-item.disabled {
  opacity: 0.5;
  pointer-events: none;
}
  
.required-field {
  border: 1px solid #dc3545 !important;
}

.logo-img:hover {
  transform: scale(1.05);
}

.logo-text {
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.logo-text h1 {
  font-size: 1.25rem;
  margin-bottom: 0.25rem;
  line-height: 1.2;
  color: var(--primary-color);
  font-weight: 700;
}

.logo-text p {
  font-size: 0.75rem;
  margin-bottom: 0;
  color: #5a4a42;
}

/* Seção do Cardápio Atualizada */
.menu-section {
  margin-bottom: 3rem;
  padding: 0 15px;
}

.menu-header {
  display: flex;
  flex-direction: column;
  margin-bottom: 2rem;
}

.menu-title {
  margin-top: 10px;
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  font-size: 2rem;
  color: var(--primary-color);
  margin-bottom: 1.5rem;
  position: relative;
  display: inline-block;
  padding-bottom: 10px;
}

.menu-title:after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 60px;
  height: 4px;
  background-color: var(--secondary-color);
  border-radius: 2px;
}

#confirm-product-options.added {
    background-color: #617c33 !important;
    border-color: #617c33 !important;
}

.category-tabs {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  padding-bottom: 10px;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.category-tabs::-webkit-scrollbar {
  display: none;
}

.category-tab {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-width: 100px;
  padding: 12px 10px;
  border-radius: 12px;
  font-size: 0.85rem;
  font-weight: 500;
  transition: all 0.3s ease;
  border: 1px solid rgba(40, 11, 4, 0.1);
  background-color: white;
  color: var(--primary-color);
  cursor: pointer;
  text-align: center;
}

.category-tab i {
  font-size: 1.2rem;
  margin-bottom: 8px;
  color: var(--primary-color);
}

.category-tab.active {
  background-color: var(--primary-color);
  color: var(--secondary-color);
  border-color: var(--primary-color);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(40, 11, 4, 0.15);
}

.category-tab.active i {
  color: var(--secondary-color);
}

.category-tab:hover:not(.active) {
  background-color: #f8f9fa;
}

.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
}

.product-card {
  background-color: white;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
  height: 100%;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.product-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
  border-color: var(--primary-color);
}

.product-badge {
  position: absolute;
  top: 12px;
  right: 12px;
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 600;
  z-index: 1;
}

.product-image-container {
  position: relative;
  height: 200px;
  overflow: hidden;
}

.product-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.product-card:hover .product-image {
  transform: scale(1.05);
}

.product-content {
  padding: 18px;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.product-name {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--primary-color);
  margin-bottom: 8px;
  line-height: 1.3;
}

.product-description {
  font-size: 0.85rem;
  color: #6c757d;
  margin-bottom: 15px;
  line-height: 1.5;
  flex: 1;
}

.product-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: auto;
  padding-top: 15px;
  border-top: 1px solid rgba(0, 0, 0, 0.05);
}

.product-price {
  font-weight: 700;
  color: var(--primary-color);
  font-size: 1.2rem;
  margin: 0;
}

.add-to-cart {
  background-color: var(--primary-color);
  color: var(--secondary-color);
  border: none;
  border-radius: 8px;
  padding: 8px 16px;
  font-size: 0.9rem;
  font-weight: 500;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  gap: 6px;
  cursor: pointer;
}

.add-to-cart:hover {
  background-color: var(--primary-color);
  transform: scale(1.05);
}

.add-to-cart.added {
  background-color: var(--success-color) !important;
}

#confirm-product-options.added {
  background-color: var(--success-color) !important;
}

    
    .add-to-cart:hover {
      background-color: var(--primary-color);
      color: var(--secondary-color);
      transform: scale(1.05);
    }
    
    .card-header {
      background-color: var(--primary-color) !important;
      color: var(--secondary-color);
    }
    
    .remove-item {
      transition: all 0.3s;
    }
    
    .remove-item:hover {
      transform: scale(1.1);
    }
    
    .btn-primary {
      background-color: var(--primary-color);
      border-color: var(--primary-color);
      color: var(--secondary-color);
    }
    
    .btn-primary:hover {
      background-color: var(--primary-color);
      border-color: var(--primary-color);
      color: var(--secondary-color);
    }
    
    #checkout-button {
      transition: all 0.3s;
      background-color: var(--primary-color);
      border: none;
      color: var(--secondary-color);
    }
    
    #checkout-button:hover {
      background-color: var(--primary-color);
      color: var(--secondary-color);
    }
    
    #checkout-button:disabled {
      background-color: #adb5bd;
      color: white;
    }
    
    .badge.bg-primary {
      background-color: var(--primary-color) !important;
    }
    
    .badge.bg-success {
      background-color: #20c997 !important;
    }
    
    .sticky-top {
      top: 1rem;
    }
    
    .text-primary {
      color: var(--primary-color) !important;
    }
    
    .quantity-control {
      display: flex;
      align-items: center;
    }
    
    .quantity-btn {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: var(--light-color);
      border: none;
      cursor: pointer;
      padding: 0;
    }
    
    .quantity-input {
      width: 40px;
      text-align: center;
      border: none;
      background: transparent;
      font-weight: bold;
    }
    
    .cart-item-quantity {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .empty-cart-icon {
      font-size: 3rem;
      opacity: 0.2;
    }
    
    /* Checkout Page Styles */
    .checkout-container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    .checkout-step {
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid #eee;
    }
    
    .checkout-step:last-child {
      border-bottom: none;
    }
    
    .delivery-option-card {
      cursor: pointer;
      transition: all 0.3s;
      border: 2px solid transparent;
      border-radius: 8px;
    }
    
    .delivery-option-card:hover {
      border-color: var(--primary-color);
    }
    
    .delivery-option-card.active {
      border-color: var(--primary-color);
      background-color: rgba(40, 11, 4, 0.1);
    }
    
    .payment-method-card {
      cursor: pointer;
      transition: all 0.3s;
      border: 2px solid transparent;
      border-radius: 8px;
    }
    
    .payment-method-card:hover {
      border-color: var(--primary-color);
    }
    
    .payment-method-card.active {
      border-color: var(--primary-color);
      background-color: rgba(40, 11, 4, 0.1);
    }
    
    .payment-icon {
      font-size: 1.5rem;
      margin-right: 10px;
      color: var(--primary-color);
    }
    
    .payment-method-label {
      font-weight: 500;
      display: flex;
      align-items: center;
    }
    
    /* Admin Panel Styles */
    .admin-navbar {
      background-color: var(--primary-color);
      position: sticky;
      top: 0;
      z-index: 1020;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .admin-navbar .navbar-brand {
      font-weight: 600;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      color: var(--secondary-color);
    }
    
    .admin-navbar .navbar-brand img {
      margin-right: 10px;
    }
    
    .admin-navbar .btn-outline-light {
      color: var(--secondary-color);
      border-color: var(--secondary-color);
    }
    
    .admin-navbar .btn-outline-light:hover {
      background-color: var(--secondary-color);
      color: var(--primary-color);
    }
    
    .order-card {
      transition: all 0.3s;
      border-left: 4px solid var(--primary-color);
      margin-bottom: 15px;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      background-color: white;
    }
    
    .order-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .order-status-badge {
      font-size: 0.8rem;
      padding: 0.35em 0.65em;
    }
    
    .status-pending {
      background-color: #ffc107;
      color: #212529;
    }
    
    .status-preparing {
      background-color: #fd7e14;
      color: white;
    }
    
    .status-ready {
      background-color: #20c997;
      color: white;
    }
    
    .status-delivered {
      background-color: #198754;
      color: white;
    }
    
    .status-cancelled {
      background-color: #dc3545;
      color: white;
    }
    
    /* Kitchen Print Styles */
    .kitchen-order {
      font-family: 'Courier New', monospace;
      font-size: 14px;
      line-height: 1.3;
      padding: 10px;
      max-width: 58mm;
    }
    
    .kitchen-order-header {
      text-align: center;
      font-weight: bold;
      margin-bottom: 10px;
      border-bottom: 1px dashed #000;
      padding-bottom: 5px;
    }
    
    .kitchen-order-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 3px;
    }
    
    .kitchen-order-footer {
      border-top: 1px dashed #000;
      margin-top: 10px;
      padding-top: 5px;
      font-weight: bold;
    }
    
    /* Cart Sidebar Styles */
    .cart-sidebar {
      position: fixed;
      top: 0;
      right: -100%;
      width: 100%;
      max-width: 100%;
      height: 100vh;
      background-color: white;
      z-index: 1050;
      transition: right 0.3s ease;
      box-shadow: -5px 0 15px rgba(0,0,0,0.1);
      overflow-y: auto;
    }
    
    @media (min-width: 768px) {
      .cart-sidebar {
        right: -400px;
        max-width: 400px;
      }
    }
    
    .cart-sidebar.show {
      right: 0;
    }
    
    .cart-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      z-index: 1040;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease;
    }
    
    .cart-overlay.show {
      opacity: 1;
      visibility: visible;
    }
    
    /* Cart Icon Styles */
    .cart-icon-container {
      position: relative;
      cursor: pointer;
    }
    
    .cart-icon-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background-color: var(--primary-color);
      color: var(--secondary-color);
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
    }
    
    /* Admin Notification Bell */
    .notification-bell {
      position: relative;
      margin-right: 15px;
      cursor: pointer;
      color: var(--secondary-color);
      font-size: 1.2rem;
    }
    
    .notification-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background-color: var(--secondary-color);
      color: var(--primary-color);
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    
    /* New Order Notification */
    .new-order-notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: var(--primary-color);
      color: var(--secondary-color);
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      z-index: 1100;
      display: flex;
      align-items: center;
      animation: slideInUp 0.5s, pulse 2s infinite;
    }
    
    .new-order-notification i {
      margin-right: 10px;
      font-size: 1.2rem;
    }
    
    @keyframes slideInUp {
      from {
        transform: translateY(100%);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    /* Admin Day Tabs */
    .day-tabs {
      display: flex;
      overflow-x: auto;
      padding-bottom: 10px;
      margin-bottom: 15px;
      border-bottom: 1px solid #dee2e6;
    }
    
    .day-tab {
      padding: 8px 15px;
      margin-right: 5px;
      border-radius: 20px;
      background-color: #f8f9fa;
      border: 1px solid #dee2e6;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.3s;
    }
    
    .day-tab.active {
      background-color: var(--primary-color);
      color: var(--secondary-color);
      border-color: var(--primary-color);
    }
    
    /* Admin Order Accordion */
    .order-accordion {
      margin-bottom: 10px;
      border: 1px solid #dee2e6;
      border-radius: 5px;
      overflow: hidden;
    }
    
    .order-accordion-header {
      cursor: pointer;
      padding: 12px 15px;
      background-color: #f8f9fa;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background-color 0.2s;
    }
    
    .order-accordion-header:hover {
      background-color: #e9ecef;
    }
    
    .order-accordion-header .date {
      font-weight: 600;
      color: var(--dark-color);
    }
    
    /* Product Options Modal */
    .options-modal .modal-body {
      max-height: 60vh;
      overflow-y: auto;
    }
    
    .option-group {
      margin-bottom: 15px;
      border-bottom: 1px solid #eee;
      padding-bottom: 10px;
    }
    
    .option-group:last-child {
      border-bottom: none;
    }
    
    .option-group-title {
      font-weight: bold;
      margin-bottom: 10px;
      color: var(--dark-color);
    }
    
    .option-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    /* Highlight for new orders */
    .new-order {
      animation: highlight 2s;
      border-left: 4px solid var(--primary-color) !important;
    }
    
    @keyframes highlight {
      0% { background-color: rgba(40, 11, 4, 0.3); }
      100% { background-color: transparent; }
    }

    /* Menu Section Styling */
    .menu-section {
      margin-bottom: 3rem;
      padding: 0 15px;
    }
    
    .menu-title {
      font-family: 'Playfair Display', serif;
      font-weight: 700;
      font-size: 2rem;
      color: var(--primary-color);
      margin-bottom: 1.5rem;
      position: relative;
      display: inline-block;
      padding-bottom: 10px;
    }
    
    .menu-title:after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 4px;
      background-color: var(--secondary-color);
      border-radius: 2px;
    }

    .category-tabs {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      padding-bottom: 10px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .category-tabs::-webkit-scrollbar {
      display: none;
    }

    .category-tab {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-width: 100px;
      padding: 12px 10px;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 500;
      transition: all 0.3s ease;
      border: 1px solid rgba(40, 11, 4, 0.1);
      background-color: white;
      color: var(--primary-color);
      cursor: pointer;
      text-align: center;
    }
    
    .category-tab i {
      font-size: 1.2rem;
      margin-bottom: 8px;
      color: var(--primary-color);
    }
    
    .category-tab.active {
      background-color: var(--primary-color);
      color: var(--secondary-color);
      border-color: var(--primary-color);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(40, 11, 4, 0.15);
    }
    
    .category-tab.active i {
      color: var(--secondary-color);
    }
    
    .category-tab:hover:not(.active) {
      background-color: #f8f9fa;
    }
    
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }

    .product-card {
      background-color: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      height: 100%;
      border: 1px solid rgba(0, 0, 0, 0.05);
    }
    
    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      border-color: var(--primary-color);
    }
    
    .product-badge {
      position: absolute;
      top: 12px;
      right: 12px;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      z-index: 1;
    }
    
    .product-image-container {
      position: relative;
      height: 200px;
      overflow: hidden;
    }



    
    /* Product Card Styling */
    .product .card-body {
      padding: 1.25rem;
    }
    
    .product-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }
    
    .product-description {
      font-size: 0.875rem;
      color: #6c757d;
      margin-bottom: 1rem;
    }
    
    .product-price {
      font-weight: 700;
      color: var(--primary-color);
      font-size: 1.1rem;
      margin: 0;
    }
    
    /* Footer styles */
    footer {
      background-color: #ffb501 !important;
      color: #333333;
      font-family: 'Poppins', sans-serif;
    }
    
    footer h3 {
      font-weight: 600;
      color: #280b04;
    }
    
    footer .text-muted {
      color: #5a4a42 !important;
    }
    
    footer hr {
      border-color: #280b04;
      opacity: 0.2;
    }
    
    /* Product card footer */
    .product .card-footer {
      margin-top: auto;
      background: transparent;
      border-top: 1px solid rgba(0,0,0,0.1);
      padding: 0.75rem 1.25rem;
    }
    
    /* Price and button container */
    .product-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }
    
    /* Professional cart icon */
    .cart-icon {
      font-size: 1.25rem;
      color: var(--primary-color);
    }

    /* New professional admin orders styling */
    .admin-orders-container {
      background-color: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
    }

    .admin-order-card {
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom: 15px;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .admin-order-card:hover {
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }

    .admin-order-header {
      background-color: #f1f2f6;
      padding: 12px 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #e9ecef;
    }

    .admin-order-body {
      padding: 15px;
    }

    .admin-order-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px dashed #eee;
    }

    .admin-order-item:last-child {
      border-bottom: none;
    }

    .admin-order-footer {
      background-color: #f8f9fa;
      padding: 12px 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 1px solid #e9ecef;
    }

    .admin-order-actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .admin-order-total {
      font-weight: bold;
      color: var(--primary-color);
    }

    .admin-order-status {
      font-size: 0.8rem;
      padding: 4px 8px;
      border-radius: 20px;
      font-weight: 500;
    }

    .admin-order-new {
      background-color: rgba(40, 11, 4, 0.1);
      border-left: 4px solid var(--primary-color);
    }

    

    /* Responsive adjustments */
    @media (max-width: 992px) {
      .product-image {
        height: 180px;
      }
      
      .filter-buttons {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .filter-btn {
        margin-bottom: 5px;
        font-size: 0.8rem;
        padding: 0.25rem 0.5rem;
      }
      
      .checkout-step {
        padding-bottom: 1rem;
        margin-bottom: 1.5rem;
      }
      
      .admin-panel-container {
        padding-top: 10px;
      }
      
      .order-actions .btn {
        margin-bottom: 5px;
        width: 100%;
      }
      
      .payment-method-card {
        margin-bottom: 10px;
      }
      
      .order-accordion-header {
        padding: 10px;
      }
      
      /* Admin panel mobile adjustments */
      .admin-panel-container .row {
        flex-direction: column-reverse;
      }
      
      .admin-panel-container .col-md-3 {
        margin-bottom: 20px;
      }

      .admin-order-actions {
        flex-direction: column;
        gap: 5px;
      }

      .admin-order-actions .btn {
        width: 100%;
      }
    }
    
    @media (max-width: 768px) {

      .product-grid {
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  }
  
  .product-image-container {
    height: 180px;
  }
  
  .menu-title {
    font-size: 1.8rem;
  }
      .product-image {
        height: 160px;
      }
      
      .cart-item-quantity {
        flex-direction: row;
        align-items: center;
        gap: 10px;
      }
      
      .checkout-step {
        padding-bottom: 0.75rem;
        margin-bottom: 1rem;
      }
      
      .filter-buttons {
        margin-top: 10px;
      }
      
      .delivery-option-card, .payment-method-card {
        margin-bottom: 10px;
      }
      
      .admin-stats-card .stat-value {
        font-size: 1.2rem;
      }
      
      .admin-navbar .navbar-brand {
        font-size: 1rem;
      }
      
      .order-accordion-header {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .new-order-notification {
        width: calc(100% - 40px);
        left: 20px;
        right: auto;
      }
      
      .checkout-container {
        padding: 0 15px;
      }
      
      .card-body {
        padding: 1rem;
      }
      
      .logo-img {
        height: 45px;
        width: 45px;
      }
      
      .logo-text h1 {
        font-size: 1.1rem;
      }
      
      .logo-text p {
        font-size: 0.7rem;
      }
      
      .menu-title {
        font-size: 1.5rem;
      }

      /* Correção para o cardápio em mobile */
      .menu-header {
      display: flex;
      flex-direction: column;
      margin-bottom: 2rem;
    }
      
      .filter-buttons {
        margin-top: 15px;
        width: 100%;
        justify-content: flex-start;
      }
      
      .product-container .row {
        margin-left: -5px;
        margin-right: -5px;
      }
      
      .product-container .col-md-6, 
      .product-container .col-lg-4, 
      .product-container .col-xl-3 {
        padding-left: 5px;
        padding-right: 5px;
      }

      .admin-order-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }

      .admin-order-footer {
        flex-direction: column;
        gap: 10px;
        align-items: flex-start;
      }

      .admin-order-total {
        width: 100%;
        text-align: left;
      }
    }
    
    @media (max-width: 576px) {
      .product-grid {
    grid-template-columns: 1fr;
  }
  
  .category-tab {
    min-width: 80px;
    padding: 10px 8px;
    font-size: 0.8rem;
  }
  
  .category-tab i {
    font-size: 1rem;
  }
  
  .menu-title {
    font-size: 1.6rem;
  }
      
      .product {
        margin-bottom: 15px;
      }
      
      .product-image {
        height: 140px;
      }
      
      .product-name {
        font-size: 1rem;
      }
      
      .product-price {
        font-size: 1rem;
      }
      
      .add-to-cart {
        padding: 0.25rem 0.5rem;
        font-size: 0.8rem;
        min-width: 80px;
      }
      
      .filter-btn {
        padding: 0.25rem 0.75rem;
        font-size: 0.75rem;
      }
      
      .checkout-step h3 {
        font-size: 1.1rem;
      }
      
      .delivery-option-card, .payment-method-card {
        padding: 1rem;
      }
      
      .payment-method-label {
        font-size: 0.9rem;
      }
      
      .payment-icon {
        font-size: 1.2rem;
      }
      
      footer .col-md-4 {
        margin-bottom: 1.5rem;
      }
      
      .admin-stats-card .card-body {
        padding: 0.75rem;
      }
      
      .order-card {
        padding: 1rem;
      }
      
      .order-actions .btn {
        font-size: 0.7rem;
        padding: 0.2rem 0.4rem;
      }
      
      .cart-sidebar .card-body {
        padding: 1rem;
      }
      
      #checkout-button, #confirm-order-button {
        padding: 0.75rem;
        font-size: 1rem;
      }
      
      .modal-dialog {
        margin: 0.5rem auto;
      }
      
      .logo-img {
        height: 40px;
        width: 40px;
      }
      
      .logo-text h1 {
        font-size: 1rem;
      }
      
      .logo-text p {
        font-size: 0.65rem;
      }
      
      .menu-title {
        font-size: 1.5rem;
      }
    }
    
    /* Admin Panel Improvements */
    .admin-panel-container {
      padding-top: 20px;
    }
    
    .admin-stats-card {
      border-left: 4px solid var(--primary-color);
      margin-bottom: 20px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
    
    .admin-stats-card .card-body {
      padding: 1.5rem;
    }
    
    .admin-stats-card h5 {
      font-size: 1rem;
      margin-bottom: 0.5rem;
      color: var(--dark-color);
    }
    
    .admin-stats-card .stat-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--primary-color);
    }
    
    .order-actions {
      display: flex;
      gap: 5px;
      flex-wrap: wrap;
    }
    
    .order-actions .btn {
      padding: 0.25rem 0.5rem;
      font-size: 0.8rem;
    }
    
    /* Print Styles for Kitchen */
    @media print {
      body * {
        visibility: hidden;
      }
      #kitchen-order-print, #kitchen-order-print * {
        visibility: visible;
      }
      #kitchen-order-print {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: auto;
      }
    }
    
    /* Hidden admin access button */
    .admin-access-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-color: var(--dark-color);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 1000;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: all 0.3s;
    }
    
    .admin-access-btn:hover {
      transform: scale(1.1);
      background-color: var(--primary-color);
    }
    
    /* WhatsApp ready button */
    .whatsapp-ready-btn {
      background-color: #25D366;
      border-color: #25D366;
    }
    
    .whatsapp-ready-btn:hover {
      background-color: #128C7E;
      border-color: #128C7E;
    }
    
    /* MB Way payment icon */
    .mbway-icon {
      color: #9c27b0;
    }

    /* New styles for admin panel */
    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      background-color: var(--primary-color);
      color: white;
    }

    .admin-header h1 {
      font-size: 1.5rem;
      margin: 0;
      color: var(--secondary-color);
    }

    .admin-header .timestamp {
      font-size: 0.9rem;
      opacity: 0.8;
      color: var(--secondary-color);
    }

    .order-details {
      padding: 15px;
      border-bottom: 1px solid #eee;
    }

    .order-details-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .order-number {
      font-weight: bold;
      color: var(--primary-color);
    }

    .order-date {
      color: #666;
      font-size: 0.9rem;
    }

    .order-customer {
      margin-bottom: 10px;
    }

    .order-items {
      margin: 15px 0;
    }

    .order-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .order-total {
      font-weight: bold;
      text-align: right;
      margin-top: 10px;
    }

    .order-actions-container {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .order-actions-container .btn {
      flex: 1;
      min-width: 120px;
    }

    .orders-summary {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }

    .summary-item {
      text-align: center;
    }

    .summary-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--primary-color);
    }

    .summary-label {
      font-size: 0.9rem;
      color: #666;
    }

    /* Improved admin panel buttons */
    .admin-btn {
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 0.85rem;
      font-weight: 500;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .admin-btn i {
      font-size: 0.9rem;
    }

    /* Improved admin order card spacing */
    .admin-order-card {
      margin-bottom: 20px;
    }

    .admin-order-body {
      padding: 20px;
    }

    /* Better alignment for admin order items */
    .admin-order-item {
      padding: 10px 0;
    }

    /* Enhanced admin panel header */
    .admin-panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }

    /* Improved filter dropdowns */
    .admin-filter-dropdown {
      border-radius: 8px;
      padding: 8px 12px;
      border: 1px solid #ddd;
      font-size: 0.9rem;
    }

    /* Better spacing for admin stats cards */
    .admin-stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }

    /* Enhanced status badges */
    .status-badge {
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    /* Improved mobile menu section */
    .mobile-menu-section {
      padding: 0 10px;
    }

    .mobile-menu-section .row {
      margin-left: -5px;
      margin-right: -5px;
    }

    .mobile-menu-section .col-6 {
      padding-left: 5px;
      padding-right: 5px;
    }

    /* Better cart visibility control */
    .cart-visibility-control {
      display: block !important;
    }

    .admin-panel .cart-visibility-control {
      display: none !important;
    }
    
    /* Product options styling */
    .option-section {
      margin-bottom: 15px;
    }
    
    .option-section-title {
      font-weight: bold;
      margin-bottom: 10px;
      color: var(--primary-color);
      border-bottom: 1px solid #eee;
      padding-bottom: 5px;
    }
    
    .option-item {
      margin-bottom: 8px;
    }
    
    .option-item label {
      display: flex;
      align-items: center;
      cursor: pointer;
    }
    
    .option-item input[type="checkbox"],
    .option-item input[type="radio"] {
      margin-right: 8px;
    }
    
    .required-option {
      color: #dc3545;
      font-weight: bold;
    }
    
    /* Additional price styling */
    .additional-price {
      color: var(--success-color);
      font-weight: bold;
      margin-left: 5px;
    }

    .required-highlight {
      animation: pulse-border 0.5s ease-in-out;
      border-left: 3px solid #ff4444;
      padding-left: 8px;
    }

@keyframes pulse-border {
  0% { border-left-color: transparent; }
  50% { border-left-color: #ff4444; }
  100% { border-left-color: #ff4444; }
}
  </style>
</head>
<body>
  <!-- Main Navigation -->
  <header class="main-header">
    <div class="container navbar-container">
      <div class="d-flex justify-content-between align-items-center py-1">
        <div id="main-header" class="logo-container">
          <img src="vivi.jpg" alt="Cozinha da Vivi" class="logo-img">
          <div class="logo-text">
            <h1 class="mb-0">Cozinha da Vivi</h1>
            <p class="mb-0">Comida caseira com amor</p>
          </div>
        </div>
        <div class="cart-icon-container cart-visibility-control" id="cart-indicator" style="display: none;">
          <i class="fas fa-shopping-cart cart-icon"></i>
          <span id="cart-count" class="cart-icon-badge" style="display: none;">0</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Cart Overlay -->
  <div class="cart-overlay" id="cart-overlay"></div>

  <!-- Cart Sidebar -->
  <div class="cart-sidebar" id="cart-sidebar">
    <div class="card border-0 h-100">
      <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
        <h2 class="h5 mb-0"><i class="fas fa-shopping-cart me-2"></i> Seu Pedido</h2>
        <button class="btn btn-sm btn-outline-light" id="close-cart">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="card-body p-0 d-flex flex-column">
        <div id="cart-items" class="list-group list-group-flush flex-grow-1">
          <div class="list-group-item text-center py-4 empty-cart">
            <i class="fas fa-shopping-cart empty-cart-icon mb-3"></i>
            <p class="mb-0">Seu carrinho está vazio</p>
            <small class="text-muted">Adicione itens para continuar</small>
          </div>
        </div>
        <div class="p-3 border-top">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <span class="text-muted">Subtotal:</span>
            <span id="subtotal" class="fw-bold">€ 0,00</span>
          </div>
          
          <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="text-muted">Taxa de Entrega:</span>
            <span id="delivery-fee" class="fw-bold">€ 5,00</span>
          </div>
          
          <div class="d-flex justify-content-between align-items-center border-top pt-3">
            <span class="h5 mb-0">Total:</span>
            <span id="total" class="h4 mb-0 text-primary fw-bold">€ 0,00</span>
          </div>
          
          <button id="checkout-button" class="btn btn-primary w-100 mt-3 py-2 fw-bold" disabled>
            <i class="fas fa-check-circle me-2"></i> Finalizar Pedido
          </button>
          
          <p class="small text-muted mt-2 mb-0 text-center">
            <i class="fas fa-lock me-1"></i> Seus dados estão protegidos
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Seção de Produtos Atualizada -->
  <section id="products" class="menu-section">
    <div class="container">
      <div class="menu-header">
        <h2 class="menu-title">O Nosso Menu</h2>
        <div class="category-tabs">
          <div class="category-tab active" data-category="all">
            <i class="fas fa-utensils"></i>
            <span>Todos</span>
          </div>
          <div class="category-tab" data-category="churrasco">
            <i class="fas fa-fire-alt"></i>
            <span>Churrasco</span>
          </div>
          <div class="category-tab" data-category="burguers">
            <i class="fas fa-hamburger"></i>
            <span>Burguers</span>
          </div>
          <div class="category-tab" data-category="combos">
            <i class="fas fa-box-open"></i>
            <span>Combos</span>
          </div>
          <div class="category-tab" data-category="porcoes">
            <i class="fas fa-utensil-spoon"></i>
            <span>Porções</span>
          </div>
          <div class="category-tab" data-category="bebidas">
            <i class="fas fa-glass-whiskey"></i>
            <span>Bebidas</span>
          </div>
          <div class="category-tab" data-category="sobremesas">
            <i class="fas fa-ice-cream"></i>
            <span>Sobremesas</span>
          </div>
        </div>
      </div>

      <div class="product-grid" id="product-container">
        <!-- Churrasco Misto -->
        <div class="product-card" data-id="101" data-category="churrasco" data-has-options="true">
          <div class="product-badge bg-primary">Mais pedido</div>
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=500&auto=format&fit=crop" alt="Churrasco Misto" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Churrasco Misto</h3>
            <p class="product-description">Refeição completa com carnes e acompanhamentos selecionados, preparados na brasa com tempero especial.</p>
            <div class="product-footer">
              <span class="product-price">€ 12,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Maminha -->
        <div class="product-card" data-id="102" data-category="churrasco" data-has-options="true">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=500&auto=format&fit=crop" alt="Maminha" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Maminha</h3>
            <p class="product-description">Maminha suculenta grelhada na brasa, servida com acompanhamentos à escolha.</p>
            <div class="product-footer">
              <span class="product-price">€ 13,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Linguiça Toscana -->
        <div class="product-card" data-id="103" data-category="churrasco" data-has-options="true">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1603360946369-dc9bb6258143?w=500&auto=format&fit=crop" alt="Linguiça Toscana" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Linguiça Toscana</h3>
            <p class="product-description">Linguiça toscana artesanal grelhada, acompanhada de farofa e vinagrete.</p>
            <div class="product-footer">
              <span class="product-price">€ 12,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Costelinha de Porco -->
        <div class="product-card" data-id="104" data-category="churrasco" data-has-options="true">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1603360946369-dc9bb6258143?w=500&auto=format&fit=crop" alt="Costelinha de Porco" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Costelinha de Porco</h3>
            <p class="product-description">Costelinha de porco assada lentamente, com molho barbecue caseiro.</p>
            <div class="product-footer">
              <span class="product-price">€ 12,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- X-Salada -->
        <div class="product-card" data-id="201" data-category="burguers">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=500&auto=format&fit=crop" alt="X-Salada" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">X-Salada</h3>
            <p class="product-description">Pão de hambúrguer, bife de hambúrguer, fiambre, queijo, salada, batata palha e milho.</p>
            <div class="product-footer">
              <span class="product-price">€ 6,50</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- X-Bacon -->
        <div class="product-card" data-id="202" data-category="burguers">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=500&auto=format&fit=crop" alt="X-Bacon" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">X-Bacon</h3>
            <p class="product-description">Pão, hambúrguer, bacon, queijo, fiambre, ovo, alface, tomate, milho e batata palha.</p>
            <div class="product-footer">
              <span class="product-price">€ 8,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>
        
        <!-- X-frango -->
        <div class="product-card" data-id="203" data-category="burguers">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=500&auto=format&fit=crop" alt="X-Frango" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">X-Frango</h3>
            <p class="product-description">Pão, hambúrguer de frango, queijo, fiambre, ovo, alface, tomate, milho e batata palha.</p>
            <div class="product-footer">
              <span class="product-price">€ 8,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>
       
        <!-- Combo Frango Supreme -->
        <div class="product-card" data-id="301" data-category="combos">
          <div class="product-badge bg-success">Combo</div>
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1544025162-d76694265947?w=500&auto=format&fit=crop" alt="Combo Frango Supreme" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Combo Frango Supreme</h3>
            <p class="product-description">Sanduíche de frango com batata frita e bebida. Economize €2,50 em relação à compra separada.</p>
            <div class="product-footer">
              <span class="product-price">€ 10,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Combo X-Tudo -->
        <div class="product-card" data-id="302" data-category="combos">
          <div class="product-badge bg-success">Combo</div>
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1544025162-d76694265947?w=500&auto=format&fit=crop" alt="Combo X-Tudo" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Combo X-Tudo</h3>
            <p class="product-description">Sanduíche completo com batata frita e bebida. Economize €3,00 em relação à compra separada.</p>
            <div class="product-footer">
              <span class="product-price">€ 12,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Porção de Arroz -->
        <div class="product-card" data-id="401" data-category="porcoes">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=500&auto=format&fit=crop" alt="Porção de Arroz" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Porção de Arroz</h3>
            <p class="product-description">Porção de arroz branco soltinho, ideal para acompanhar seus pratos favoritos.</p>
            <div class="product-footer">
              <span class="product-price">€ 3,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Porção de Queijo Coalho -->
<div class="product-card" data-id="402" data-category="porcoes">
  <div class="product-image-container">
    <img src="https://images.unsplash.com/photo-1601050690597-df0568f70950?w=500&auto=format&fit=crop" alt="Queijo Coalho" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Queijo Coalho</h3>
    <p class="product-description">Queijo coalho grelhado, tradicional do nordeste brasileiro, perfeito para acompanhar molhos.</p>
    <div class="product-footer">
      <span class="product-price">€ 6,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Torresmo -->
<div class="product-card" data-id="403" data-category="porcoes">
  <div class="product-image-container">
    <img src="https://images.unsplash.com/photo-1601050690597-df0568f70950?w=500&auto=format&fit=crop" alt="Torresmo" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Torresmo</h3>
    <p class="product-description">Torresmo brasileiro: crocante e delicioso, feito com pedaços de carne de porco, ideal para acompanhar uma cerveja gelada.</p>
    <div class="product-footer">
      <span class="product-price">€ 6,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Porção de Mandioca -->
<div class="product-card" data-id="404" data-category="porcoes">
  <div class="product-image-container">
    <img src="https://images.unsplash.com/photo-1601050690597-df0568f70950?w=500&auto=format&fit=crop" alt="Mandioca" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Porção de Mandioca</h3>
    <p class="product-description">Mandioca frita crocante por fora e macia por dentro, acompanha molho à escolha.</p>
    <div class="product-footer">
      <span class="product-price">€ 6,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Porção de Batata Frita -->
<div class="product-card" data-id="405" data-category="porcoes">
  <div class="product-image-container">
    <img src="https://images.unsplash.com/photo-1541592106381-b31e9677c0e5?w=500&auto=format&fit=crop" alt="Batata Frita" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Porção de Batata Frita</h3>
    <p class="product-description">Batata frita crocante temperada com sal e ervas finas, acompanha molho à escolha.</p>
    <div class="product-footer">
      <span class="product-price">€ 3,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Porção de Carnes -->
<div class="product-card" data-id="406" data-category="porcoes" data-has-options="true">
  <div class="product-image-container">
    <img src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=500&auto=format&fit=crop" alt="Porção de Carnes" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Porção de Carnes</h3>
    <p class="product-description">Selecione suas carnes preferidas para montar sua porção especial.</p>
    <div class="product-footer">
      <span class="product-price">€ 10,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

        <!-- Coca-Cola (lata) -->
        <div class="product-card" data-id="5021" data-category="bebidas">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1554866585-cd94860890b7?w=500&auto=format&fit=crop" alt="Coca-Cola (lata)" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Coca-Cola (lata)</h3>
            <p class="product-description">Refrigerante Coca-Cola em lata 350ml, geladinho para acompanhar sua refeição.</p>
            <div class="product-footer">
              <span class="product-price">€ 2,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

  <!-- Açai Pequeno -->
<div class="product-card" data-id="601" data-category="sobremesas" data-has-options="true">
  <div class="product-image-container">
    <img src="https://images.unsplash.com/photo-1551024506-0bccd828d307?w=500&auto=format&fit=crop" alt="Açai Pequeno" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Açai Pequeno</h3>
    <p class="product-description">Açai cremoso com acompanhamentos à escolha. Tamanho pequeno (300ml).</p>
    <div class="product-footer">
      <span class="product-price">€ 6,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Açai Grande -->
<div class="product-card" data-id="602" data-category="sobremesas" data-has-options="true">
  <div class="product-image-container">
    <img src="https://images.unsplash.com/photo-1551024506-0bccd828d307?w=500&auto=format&fit=crop" alt="Açai Grande" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Açai Grande</h3>
    <p class="product-description">Açai cremoso com acompanhamentos à escolha. Tamanho grande (500ml).</p>
    <div class="product-footer">
      <span class="product-price">€ 10,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

        <!-- Pudim Caseiro -->
        <div class="product-card" data-id="603" data-category="sobremesas">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1563805042-7684c019e1cb?w=500&auto=format&fit=crop" alt="Pudim Caseiro" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Pudim Caseiro</h3>
            <p class="product-description">Pudim tradicional caseiro com calda de caramelo. Feito com ingredientes selecionados.</p>
            <div class="product-footer">
              <span class="product-price">€ 3,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

    <!-- Checkout Section (Hidden by default) -->
    <section id="checkout-section" class="container my-4 d-none">
      <div class="checkout-container">
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <div class="card border-0 shadow-sm mb-4">
              <div class="card-header bg-primary text-white">
                <h2 class="h5 mb-0"><i class="fas fa-shopping-cart me-2"></i> Finalizar Pedido</h2>
              </div>
              <div class="card-body">
                <div class="checkout-step">
                  <h3 class="h5 mb-3">1. Método de Recebimento</h3>
                  <div class="row g-3">
                    <div class="col-md-6">
                      <div class="card delivery-option-card p-3 active" id="delivery-option">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="delivery-method" id="delivery-method" value="entrega" checked>
                          <label class="form-check-label fw-bold" for="delivery-method">
                            <i class="fas fa-motorcycle me-2"></i> Entrega
                          </label>
                        </div>
                        <p class="small text-muted mt-2">Entregamos no seu endereço (Taxa: € 5,00)</p>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="card delivery-option-card p-3" id="pickup-option">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="delivery-method" id="pickup-method" value="retirada">
                          <label class="form-check-label fw-bold" for="pickup-method">
                            <i class="fas fa-store me-2"></i> Retirada
                          </label>
                        </div>
                        <p class="small text-muted mt-2">Retire seu pedido no restaurante</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="checkout-step">
                  <h3 class="h5 mb-3">2. Informações do Cliente</h3>
                  <form id="customer-info-form">
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label for="customer-name" class="form-label">Nome Completo *</label>
                        <input type="text" class="form-control" id="customer-name" required>
                      </div>
                      <div class="col-md-6">
                        <label for="customer-phone" class="form-label">Telefone *</label>
                        <input type="tel" class="form-control" id="customer-phone" required placeholder="Ex: +351 933 737 672">
                      </div>
                      <div class="col-12 delivery-field">
                        <label for="customer-address" class="form-label">Endereço *</label>
                        <input type="text" class="form-control" id="customer-address" placeholder="Rua, Número">
                      </div>
                      <div class="col-md-12 delivery-field">
                        <label for="customer-complement" class="form-label">Complemento</label>
                        <input type="text" class="form-control" id="customer-complement" placeholder="Apto, Bloco, Referência">
                      </div>
                      <div class="col-12">
                        <label for="customer-instructions" class="form-label">Instruções para entrega/pedido</label>
                        <textarea class="form-control" id="customer-instructions" rows="2" placeholder="Ex: Portão azul, tocar campainha ou Sem cebola, bem passado"></textarea>
                      </div>
                    </div>
                  </form>
                </div>

                <div class="checkout-step">
                  <h3 class="h5 mb-3">3. Método de Pagamento</h3>
                  <div class="row g-3">
                    <div class="col-md-6">
                      <div class="card payment-method-card p-3 active" id="mbway-payment">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="payment-method" id="mbway-method" value="mbway" checked>
                          <label class="form-check-label payment-method-label" for="mbway-method">
                            <i class="fas fa-mobile-alt payment-icon mbway-icon"></i> MB Way
                          </label>
                        </div>
                        <p class="small text-muted mt-2">Você receberá uma solicitação de pagamento via MB Way</p>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="card payment-method-card p-3" id="cash-payment">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="payment-method" id="cash-method" value="dinheiro">
                          <label class="form-check-label payment-method-label" for="cash-method">
                            <i class="fas fa-money-bill-wave payment-icon"></i> Dinheiro
                          </label>
                        </div>
                        <div id="cash-change-field" class="mt-2 d-none">
                          <label for="cash-change" class="form-label small">Valor para troco</label>
                          <input type="text" class="form-control form-control-sm" id="cash-change" placeholder="Ex: 50,00">
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="card payment-method-card p-3" id="card-payment">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="payment-method" id="card-method" value="cartao">
                          <label class="form-check-label payment-method-label" for="card-method">
                            <i class="fas fa-credit-card payment-icon"></i> Cartão
                          </label>
                        </div>
                        <p class="small text-muted mt-2">Pagamento com máquina na entrega/retirada</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="checkout-step">
                  <h3 class="h5 mb-3">4. Resumo do Pedido</h3>
                  <div class="card border-0 shadow-sm">
                    <div class="card-body p-0">
                      <div id="checkout-items" class="list-group list-group-flush">
                        <!-- Itens serão adicionados dinamicamente aqui -->
                      </div>
                      <div class="p-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                          <span class="text-muted">Subtotal:</span>
                          <span id="checkout-subtotal" class="fw-bold">€ 0,00</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                          <span class="text-muted">Taxa de Entrega:</span>
                          <span id="checkout-delivery-fee" class="fw-bold">€ 5,00</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center border-top pt-3">
                          <span class="h5 mb-0">Total:</span>
                          <span id="checkout-total" class="h4 mb-0 text-primary fw-bold">€ 0,00</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="d-grid gap-2">
                  <button id="confirm-order-button" class="btn btn-primary btn-lg py-3">
                    <i class="fas fa-check-circle me-2"></i> Confirmar Pedido
                  </button>
                  <button id="back-to-cart-button" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-2"></i> Voltar para o Carrinho
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Admin Panel (Hidden by default) -->
    <section id="admin-panel" class="container-fluid px-0 d-none">
      <nav class="navbar navbar-dark admin-navbar">
        <div class="container">
          <a class="navbar-brand" href="#">
            <i class="fas fa-utensils me-2"></i> Painel Administrativo
          </a>
          <div class="d-flex align-items-center">
            <div class="notification-bell" id="notification-bell">
              <i class="fas fa-bell"></i>
              <span class="notification-badge d-none" id="notification-badge">0</span>
            </div>
            <button id="admin-logout" class="btn btn-outline-light btn-sm">
              <i class="fas fa-sign-out-alt me-1"></i> Sair
            </button>
          </div>
        </div>
      </nav>

      <div class="container admin-panel-container my-4">
        <div class="row">
          <div class="col-md-3">
            <div class="admin-stats-container">
              <div class="card admin-stats-card">
                <div class="card-body">
                  <h5 class="card-title">Pedidos Hoje</h5>
                  <div class="stat-value text-primary" id="today-orders">0</div>
                </div>
              </div>
              
              <div class="card admin-stats-card">
                <div class="card-body">
                  <h5 class="card-title">Em Preparo</h5>
                  <div class="stat-value text-warning" id="preparing-orders">0</div>
                </div>
              </div>
              
              <div class="card admin-stats-card">
                <div class="card-body">
                  <h5 class="card-title">Para Entregar</h5>
                  <div class="stat-value text-info" id="delivery-orders">0</div>
                </div>
              </div>
            </div>

            <div class="card admin-card">
              <div class="card-body">
                <h3 class="h5 card-title">Filtros</h3>
                <div class="mb-3">
                  <label class="form-label">Status</label>
                  <select class="form-select admin-filter-dropdown" id="status-filter">
                    <option value="all">Todos</option>
                    <option value="pending">Pendentes</option>
                    <option value="preparing">Em Preparo</option>
                    <option value="ready">Prontos</option>
                    <option value="delivered">Entregues</option>
                    <option value="cancelled">Cancelados</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label class="form-label">Tipo</label>
                  <select class="form-select admin-filter-dropdown" id="type-filter">
                    <option value="all">Todos</option>
                    <option value="delivery">Entrega</option>
                    <option value="pickup">Retirada</option>
                  </select>
                </div>
                <button id="apply-filters" class="btn btn-primary w-100 admin-btn">
                  <i class="fas fa-filter me-1"></i> Aplicar
                </button>
              </div>
            </div>
          </div>

          <div class="col-md-9">
            <div class="card admin-card">
              <div class="card-header bg-white">
                <div class="d-flex justify-content-between align-items-center">
                  <h3 class="h5 mb-0">Pedidos Recentes</h3>
                  <div class="small text-muted" id="last-update">
                    Atualizado: agora
                  </div>
                </div>
              </div>
              <div class="card-body p-0">
                <div id="day-tabs" class="day-tabs"></div>
                <div class="admin-orders-container" id="orders-accordion">
                  <!-- Pedidos serão agrupados por data aqui -->
                  <div class="list-group-item text-center py-5">
                    <i class="fas fa-clipboard-list fa-3x text-muted mb-3"></i>
                    <p class="mb-0">Nenhum pedido encontrado</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal de Confirmação -->
  <div class="modal fade" id="confirmationModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">Pedido Confirmado!</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center py-4">
          <i class="fas fa-check-circle text-success mb-3" style="font-size: 3rem;"></i>
          <h4 class="mb-3">Seu pedido foi recebido!</h4>
          <p class="mb-4">Agora vamos preparar seu pedido com todo cuidado. Você será redirecionado para o WhatsApp para confirmar os detalhes.</p>
          <div class="d-flex justify-content-center">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Carregando...</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Login Admin -->
  <!-- Modal de Login Admin -->
<div class="modal fade" id="adminLoginModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Acesso Administrativo</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="admin-login-form">
          <div class="mb-3">
            <label for="admin-username" class="form-label">Usuário</label>
            <input type="text" class="form-control" id="admin-username" required>
          </div>
          <div class="mb-3">
            <label for="admin-password" class="form-label">Senha</label>
            <input type="password" class="form-control" id="admin-password" required>
          </div>
          <button type="submit" class="btn btn-primary w-100">
            <i class="fas fa-sign-in-alt me-1"></i> Entrar
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

  <!-- Modal para Visualizar Pedido da Cozinha -->
  <div class="modal fade" id="kitchenOrderModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">Pedido para Cozinha</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="kitchen-order-content">
          <!-- Conteúdo do pedido será inserido aqui -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
          <button type="button" class="btn btn-primary" id="print-kitchen-order">
            <i class="fas fa-print me-1"></i> Imprimir
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Opções do Produto -->
  <div class="modal fade options-modal" id="productOptionsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="productOptionsModalTitle">Opções do Produto</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="product-options-content">
          <!-- Conteúdo das opções será inserido aqui -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" id="confirm-product-options">
            <i class="fas fa-check me-1"></i> Confirmar
          </button>
        </div>
      </div>
    </div>
  </div>

  <footer style="background-color: #ffb501; color: #333333;" class="py-4">
    <div class="container">
      <div class="row">
        <div class="col-md-4 mb-4 mb-md-0">
          <h3 class="h5"><span class="text-primary">Cozinha</span> da Vivi</h3>
          <p class="small text-muted">Comida caseira feita com ingredientes frescos e muito amor.</p>
        </div>
        <div class="col-md-4 mb-4 mb-md-0">
          <h3 class="h5">Horário de Funcionamento</h3>
          <ul class="list-unstyled small text-muted">
            <li>Segunda a Sexta: 11h às 22h</li>
            <li>Sábado: 11h às 23h</li>
            <li>Domingo: 11h às 17h</li>
          </ul>
        </div>
        <div class="col-md-4">
          <h3 class="h5">Contato</h3>
          <ul class="list-unstyled small text-muted">
            <li><i class="fas fa-phone-alt me-2"></i> (31) 3333-4444</li>
            <li><i class="fas fa-map-marker-alt me-2"></i> Rua das Flores, 123 - Centro</li>
            <li><i class="fab fa-whatsapp me-2"></i> (31) 93373-7672</li>
          </ul>
        </div>
      </div>
      <hr class="my-4 bg-secondary">
      <div class="text-center small text-muted">
        <p class="mb-0">&copy; 2025 Cozinha da Vivi - Todos os direitos reservados</p>
      </div>
    </div>
  </footer>

  <!-- Botão de acesso admin (oculto para usuários comuns) -->
  <div class="admin-access-btn" id="admin-access-btn">
    <i class="fas fa-lock"></i>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  
  <script>
    // Configurações do Firebase (com suas credenciais)
    const firebaseConfig = {
      apiKey: "AIzaSyCV809Fi4JTLZclARfU4MtNSAVkJIrGcfk",
      authDomain: "cozinha-da-vivi-83d09.firebaseapp.com",
      projectId: "cozinha-da-vivi-83d09",
      storageBucket: "cozinha-da-vivi-83d09.appspot.com",
      messagingSenderId: "740046409209",
      appId: "1:740046409209:web:f8cff12dc530e22fba4128",
      databaseURL: "https://cozinha-da-vivi-83d09-default-rtdb.europe-west1.firebasedatabase.app"
    };

    // Inicializa o Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // Configurações do aplicativo
    const APP_CONFIG = {
      whatsappNumber: "351933737672",
      deliveryFee: 5.00,
      restaurantName: "Cozinha da Vivi",
      restaurantAddress: "Rua das Flores, 123 - Centro",
      adminCredentials: {
        username: "admin",
        password: "cozinhadavivi123"
      }
    };

    // Estado do aplicativo
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let orders = [];
    let isAdminLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
    let lastOrderCount = 0;
    let pendingOrdersCount = 0;
    let currentProductOptions = null;
    let newOrders = []; // Para rastrear novos pedidos
    let lastNotificationTime = 0;

    // Elementos do DOM
    const DOM = {
  // Seções principais
  productSection: document.getElementById("products") || document.getElementById("product-section"),
  checkoutSection: document.getElementById("checkout-section"),
  adminPanel: document.getElementById("admin-panel"),
  
  // Elementos do carrinho
  cartItems: document.getElementById("cart-items"),
  totalElement: document.getElementById("total"),
  subtotalElement: document.getElementById("subtotal"),
  checkoutButton: document.getElementById("checkout-button"),
  cartCount: document.getElementById("cart-count"),
  cartIndicator: document.getElementById("cart-indicator"),
  cartSidebar: document.getElementById("cart-sidebar"),
  cartOverlay: document.getElementById("cart-overlay"),
  closeCart: document.getElementById("close-cart"),
  
  // Produtos
  productContainer: document.getElementById("product-container"),
  
  // Modais (com verificação de existência)
  confirmationModal: document.getElementById("confirmationModal") ? 
    new bootstrap.Modal(document.getElementById("confirmationModal")) : null,
  adminLoginModal: document.getElementById("adminLoginModal") ? 
    new bootstrap.Modal(document.getElementById("adminLoginModal")) : null,
  kitchenOrderModal: document.getElementById("kitchenOrderModal") ? 
    new bootstrap.Modal(document.getElementById("kitchenOrderModal")) : null,
  productOptionsModal: document.getElementById("productOptionsModal") ? 
    new bootstrap.Modal(document.getElementById("productOptionsModal")) : null,
  
  // Admin
  adminAccessBtn: document.getElementById("admin-access-btn"),
  adminLogoutButton: document.getElementById("admin-logout"),
  ordersList: document.getElementById("orders-accordion"),
  todayOrders: document.getElementById("today-orders"),
  preparingOrders: document.getElementById("preparing-orders"),
  deliveryOrders: document.getElementById("delivery-orders"),
  statusFilter: document.getElementById("status-filter"),
  typeFilter: document.getElementById("type-filter"),
  applyFilters: document.getElementById("apply-filters"),
  
  // Checkout
  backToCartButton: document.getElementById("back-to-cart-button"),
  confirmOrderButton: document.getElementById("confirm-order-button"),
  checkoutItems: document.getElementById("checkout-items"),
  checkoutSubtotal: document.getElementById("checkout-subtotal"),
  checkoutDeliveryFee: document.getElementById("checkout-delivery-fee"),
  checkoutTotal: document.getElementById("checkout-total"),
  deliveryOptionCards: document.querySelectorAll('.delivery-option-card'),
  paymentMethodCards: document.querySelectorAll('.payment-method-card'),
  deliveryFields: document.querySelectorAll('.delivery-field'),
  customerInfoForm: document.getElementById("customer-info-form"),
  cashChangeField: document.getElementById("cash-change-field"),
  
  // Cozinha/Impressão
  kitchenOrderContent: document.getElementById("kitchen-order-content"),
  printKitchenOrder: document.getElementById("print-kitchen-order"),
  
  // Outros
  lastUpdate: document.getElementById("last-update"),
  notificationBell: document.getElementById("notification-bell"),
  notificationBadge: document.getElementById("notification-badge"),
  dayTabs: document.getElementById("day-tabs"),
  productOptionsContent: document.getElementById("product-options-content"),
  productOptionsModalTitle: document.getElementById("productOptionsModalTitle"),
  confirmProductOptions: document.getElementById("confirm-product-options"),
  mainHeader: document.getElementById("main-header"),
  logoHome: document.getElementById("logo-home"),
  
  // Verificação adicional para elementos críticos
  isInitialized: function() {
    return !!(
      this.productSection && 
      this.checkoutSection && 
      this.checkoutButton && 
      this.adminAccessBtn
    );
  }
};

    // Funções do Firebase
    const FirebaseService = {
      saveOrder: async (order) => {
        try {
          const newOrderRef = database.ref('orders').push();
          await newOrderRef.set(order);
          return { ...order, id: newOrderRef.key };
        } catch (error) {
          console.error("Erro ao salvar pedido:", error);
          return null;
        }
      },

      listenForOrders: (callback) => {
        database.ref('orders').on('value', (snapshot) => {
          const ordersData = snapshot.val();
          const ordersArray = ordersData ? Object.keys(ordersData).map(key => ({
            id: key,
            ...ordersData[key]
          })) : [];
          callback(ordersArray);
        });
      },

      updateOrderStatus: async (orderId, newStatus) => {
        try {
          await database.ref(`orders/${orderId}/status`).set(newStatus);
          return true;
        } catch (error) {
          console.error("Erro ao atualizar status:", error);
          return false;
        }
      }
    };

    // Funções utilitárias
    const Utils = {
      formatCurrency: (value) => {
        return value.toLocaleString('pt-PT', { style: 'currency', currency: 'EUR' });
      },
      parsePrice: (priceString) => {
        return parseFloat(priceString.replace("€", "").replace(",", ".").trim());
      },
      animateElement: (element, animation) => {
        element.classList.add("animate__animated", `animate__${animation}`);
        setTimeout(() => {
          element.classList.remove("animate__animated", `animate__${animation}`);
        }, 1000);
      },
      showNotification: (message, type = 'success') => {
        const notification = document.createElement('div');
        notification.className = `position-fixed bottom-0 end-0 m-3 alert alert-${type} alert-dismissible fade show`;
        notification.style.zIndex = '1100';
        notification.innerHTML = `
          ${message}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.classList.remove('show');
          setTimeout(() => notification.remove(), 150);
        }, 3000);
      },
      validatePhone: (phone) => {
        // Aceita qualquer formato internacional de telefone
        return /^\+?[\d\s-]{10,15}$/.test(phone);
      },
      getTodayDate: () => {
        const today = new Date();
        return `${today.getDate()}/${today.getMonth() + 1}/${today.getFullYear()}`;
      },
      updateTimestamp: () => {
        const now = new Date();
        DOM.lastUpdate.textContent = `Atualizado: ${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
      },
      getDayName: (dayIndex) => {
        const days = ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado'];
        return days[dayIndex];
      },
      formatDate: (dateString) => {
        const date = new Date(dateString);
        return date.toLocaleDateString('pt-BR');
      },
      showNewOrderNotification: (count) => {
        const notification = document.createElement('div');
        notification.className = 'new-order-notification';
        notification.innerHTML = `
          <i class="fas fa-bell"></i>
          <span>${count} novo${count > 1 ? 's' : ''} pedido${count > 1 ? 's' : ''} recebido${count > 1 ? 's' : ''}!</span>
        `;
        
        document.body.appendChild(notification);
        
        // Remove a notificação após 5 segundos
        setTimeout(() => {
          notification.style.opacity = '0';
          setTimeout(() => notification.remove(), 300);
        }, 5000);
      }
    };

    // Funções do Carrinho
    const Cart = {
      updateStorage: () => {
        localStorage.setItem('cart', JSON.stringify(cart));
      },

      addItem: (id, name, price, image = '', options = {}) => {
  const existingItem = cart.find(item => item.id === id && JSON.stringify(item.options) === JSON.stringify(options));
  
  if (existingItem) {
    existingItem.quantity += 1;
  } else {
    cart.push({ id, name, price, quantity: 1, image, options });
  }
  
  Cart.updateStorage();
  Cart.updateUI();
  
  const productElement = document.querySelector(`.product-card[data-id="${id}"]`);
  if (productElement) {
    Utils.animateElement(productElement, 'pulse');
    
    // Muda o botão para "Adicionado" e cor verde
    const addButton = productElement.querySelector('.add-to-cart');
    if (addButton) {
      addButton.innerHTML = '<i class="fas fa-check me-1"></i> Adicionado';
      addButton.classList.add('added');
      addButton.style.backgroundColor = '#617c33';
      
      // Retorna ao estado original após 2 segundos
      setTimeout(() => {
        addButton.innerHTML = '<i class="fas fa-plus me-1"></i> Adicionar';
        addButton.classList.remove('added');
        addButton.style.backgroundColor = '';
      }, 2000);
    }
  }
},

      updateItemQuantity: (id, newQuantity) => {
        const item = cart.find(item => item.id === id);
        if (item) {
          if (newQuantity <= 0) {
            Cart.removeItem(id);
          } else {
            item.quantity = newQuantity;
            Cart.updateStorage();
            Cart.updateUI();
          }
        }
      },

      removeItem: (id) => {
        const item = cart.find(item => item.id === id);
        if (item) {
          cart = cart.filter(item => item.id !== id);
          Cart.updateStorage();
          Cart.updateUI();
        }
      },

      clear: () => {
        cart = [];
        Cart.updateStorage();
        Cart.updateUI();
      },

      getTotals: () => {
        const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        const isDelivery = document.getElementById('delivery-method')?.checked || false;
        const deliveryFee = isDelivery ? APP_CONFIG.deliveryFee : 0;
        const total = subtotal + deliveryFee;
        
        return { subtotal, deliveryFee, total };
      },

      updateUI: () => {
        DOM.cartItems.innerHTML = "";
        
        const { subtotal, deliveryFee, total } = Cart.getTotals();
        const itemCount = cart.reduce((count, item) => count + item.quantity, 0);

        if (cart.length === 0) {
          DOM.cartItems.innerHTML = `
            <div class="list-group-item text-center py-4 empty-cart">
              <i class="fas fa-shopping-cart empty-cart-icon mb-3"></i>
              <p class="mb-0">Seu carrinho está vazio</p>
              <small class="text-muted">Adicione itens para continuar</small>
            </div>
          `;
        } else {
          cart.forEach(item => {
            const li = document.createElement("div");
            li.className = "list-group-item";
            
            let optionsText = '';
            if (item.options && Object.keys(item.options).length > 0) {
              optionsText = Object.values(item.options).map(opt => opt.join(', ')).join(' | ');
            }
            
            li.innerHTML = `
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="mb-1">${item.name}</h6>
                  ${optionsText ? `<small class="text-muted">${optionsText}</small>` : ''}
                  <small class="d-block text-muted">${Utils.formatCurrency(item.price)}</small>
                </div>
                <div class="d-flex align-items-center gap-2">
                  <div class="cart-item-quantity">
                    <button class="quantity-btn decrease" data-id="${item.id}">
                      <i class="fas fa-minus"></i>
                    </button>
                    <span class="quantity mx-1">${item.quantity}</span>
                    <button class="quantity-btn increase" data-id="${item.id}">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <span class="fw-bold ms-2">${Utils.formatCurrency(item.price * item.quantity)}</span>
                  <button class="remove-item btn btn-sm btn-outline-danger ms-2" data-id="${item.id}">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </div>
            `;
            DOM.cartItems.appendChild(li);
          });
        }

        DOM.subtotalElement.textContent = Utils.formatCurrency(subtotal);
        document.getElementById("delivery-fee").textContent = Utils.formatCurrency(deliveryFee);
        DOM.totalElement.textContent = Utils.formatCurrency(total);
        
        DOM.cartCount.textContent = itemCount;
        DOM.cartCount.style.display = itemCount > 0 ? "flex" : "none";
        DOM.cartIndicator.style.display = "flex";
        
        DOM.checkoutButton.disabled = cart.length === 0;
      },
      
      toggleSidebar: () => {
        if (cart.length === 0) {
          DOM.cartSidebar.classList.remove('show');
          DOM.cartOverlay.classList.remove('show');
          return;
        }
        
        if (DOM.cartSidebar.classList.contains('show')) {
          DOM.cartSidebar.classList.remove('show');
          DOM.cartOverlay.classList.remove('show');
        } else {
          DOM.cartSidebar.classList.add('show');
          DOM.cartOverlay.classList.add('show');
        }
      }
    };

    // Funções de Pedido
    const Order = {
      create: () => {
        const { subtotal, deliveryFee, total } = Cart.getTotals();
        const deliveryType = document.querySelector('input[name="delivery-method"]:checked').value;
        const paymentMethod = document.querySelector('input[name="payment-method"]:checked')?.value || 'mbway';
        
        const customerInfo = {
          name: document.getElementById("customer-name").value,
          phone: document.getElementById("customer-phone").value,
          whatsapp: document.getElementById("customer-phone").value,
          address: document.getElementById("customer-address").value,
          complement: document.getElementById("customer-complement").value,
          instructions: document.getElementById("customer-instructions").value
        };
        
        return {
          cliente: customerInfo.name,
          telefone: customerInfo.phone,
          whatsapp: customerInfo.whatsapp,
          itens: cart.map(item => ({
            nome: item.name,
            quantidade: item.quantity,
            preco: item.price,
            opcoes: item.options || {}
          })),
          subtotal,
          taxaEntrega: deliveryFee,
          total,
          status: 'pending',
          tipoEntrega: deliveryType,
          metodoPagamento: paymentMethod,
          trocoPara: paymentMethod === 'dinheiro' ? document.getElementById("cash-change").value || '0' : null,
          endereco: deliveryType === 'entrega' ? 
            `${customerInfo.address}, ${customerInfo.complement ? customerInfo.complement + ', ' : ''}` : 
            'Retirada no local',
          instrucoes: customerInfo.instructions,
          data: new Date().toLocaleString('pt-BR'),
          restaurante: APP_CONFIG.restaurantName,
          enderecoRestaurante: APP_CONFIG.restaurantAddress
        };
      },

      saveOrder: async (order) => {
        try {
          const newOrderRef = database.ref('orders').push();
          await newOrderRef.set(order);
          return { ...order, id: newOrderRef.key };
        } catch (error) {
          console.error("Erro ao salvar pedido:", error);
          throw error;
        }
      },

      sendToBackend: async () => {
        try {
          // Validação básica do carrinho
          if (cart.length === 0) {
            throw new Error("Carrinho vazio");
          }

          // Validação dos campos obrigatórios
          const name = document.getElementById("customer-name").value;
          const phone = document.getElementById("customer-phone").value;
          const isDelivery = document.getElementById("delivery-method").checked;
          const address = document.getElementById("customer-address").value;
          
          if (!name || !phone) {
            throw new Error("Por favor, preencha seu nome e telefone");
          }
          
          if (!Utils.validatePhone(phone)) {
            throw new Error("Por favor, insira um telefone válido");
          }
          
          if (isDelivery && !address) {
            throw new Error("Por favor, preencha seu endereço completo");
          }

          // Mostra estado de carregamento
          DOM.confirmOrderButton.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Processando...';
          DOM.confirmOrderButton.disabled = true;

          // Cria e salva o pedido
          const order = Order.create();
          const savedOrder = await Order.saveOrder(order);
          
          if (!savedOrder) {
            throw new Error("Falha ao salvar pedido");
          }

          return savedOrder;
          
        } catch (error) {
          console.error("Erro em sendToBackend:", error);
          Utils.showNotification(`Erro: ${error.message}`, 'danger');
          return null;
          
        } finally {
          // Restaura o botão independentemente do resultado
          DOM.confirmOrderButton.innerHTML = '<i class="fas fa-check-circle me-2"></i> Confirmar Pedido';
          DOM.confirmOrderButton.disabled = false;
        }
      },

      sendToWhatsApp: (pedido) => {
        const itemsText = pedido.itens.map(item => 
          `➡ ${item.nome} - ${item.quantidade}x ${Utils.formatCurrency(item.preco)} = ${Utils.formatCurrency(item.preco * item.quantidade)}` +
          (item.opcoes && Object.keys(item.opcoes).length > 0 ? 
            `\n   ${Object.entries(item.opcoes).map(([key, val]) => `${key}: ${val.join(', ')}`).join(' | ')}` : '')
        ).join("%0A");
        
        const deliveryText = pedido.tipoEntrega === 'entrega' ? 
          `%0A%0A📍 *Endereço de entrega:*%0A${pedido.endereco}%0A%0A📝 *Instruções:*%0A${pedido.instrucoes || 'Nenhuma instrução adicional'}` : 
          `%0A%0A🏪 *Retirada no local*%0A${APP_CONFIG.restaurantAddress}`;
        
        let paymentText = '';
        if (pedido.metodoPagamento === 'mbway') {
          paymentText = `💳 *Pagamento via MB Way*%0AVocê receberá uma solicitação de pagamento`;
        } else if (pedido.metodoPagamento === 'dinheiro') {
          paymentText = `💵 *Pagamento em dinheiro*%0ATroco para: € ${pedido.trocoPara || 'Sem troco'}`;
        } else {
          paymentText = `💳 *Pagamento com cartão*%0AMáquina será levada na entrega/retirada`;
        }
        
        const message = `*📝 Novo Pedido - ${APP_CONFIG.restaurantName}*%0A%0A👤 *Cliente:* ${pedido.cliente}%0A📞 *Telefone:* ${pedido.telefone}%0A✉ *WhatsApp:* ${pedido.whatsapp}%0A%0A📦 *Itens do Pedido:*%0A${itemsText}%0A%0A💰 *Valores:*%0A*Subtotal:* ${Utils.formatCurrency(pedido.subtotal)}%0A*Taxa de entrega:* ${Utils.formatCurrency(pedido.taxaEntrega)}%0A*Total:* ${Utils.formatCurrency(pedido.total)}%0A%0A🚚 *Forma de recebimento:* ${pedido.tipoEntrega === 'entrega' ? 'Entrega' : 'Retirada no local'}${deliveryText}%0A%0A${paymentText}%0A%0A⏰ *Data/hora:* ${pedido.data}%0A%0A_🔔 Aguardando confirmação do restaurante_`;
        
        const whatsappURL = `https://wa.me/${APP_CONFIG.whatsappNumber}?text=${message}`;
        
        DOM.confirmationModal.show();
        
        setTimeout(() => {
          window.open(whatsappURL, "_blank");
          DOM.confirmationModal.hide();
          Cart.clear();
          DOM.productSection.classList.remove("d-none");
          DOM.checkoutSection.classList.add("d-none");
          Cart.toggleSidebar();
        }, 3000);
      },

      updateAdminPanel: () => {
        newOrders = [];
        const statusFilter = DOM.statusFilter.value;
        const typeFilter = DOM.typeFilter.value;
        
        let filteredOrders = [...orders].reverse();
        
        if (statusFilter !== 'all') {
          filteredOrders = filteredOrders.filter(order => order.status === statusFilter);
        }
        
        if (typeFilter !== 'all') {
          filteredOrders = filteredOrders.filter(order => order.tipoEntrega === typeFilter);
        }
        
        // Agrupa pedidos por data
        const ordersByDate = {};
        filteredOrders.forEach(order => {
          const date = new Date(order.data);
          const dateKey = Utils.formatDate(order.data);
          
          if (!ordersByDate[dateKey]) {
            ordersByDate[dateKey] = [];
          }
          ordersByDate[dateKey].push(order);
        });
        
        // Atualiza as abas de dias
        DOM.dayTabs.innerHTML = '';
        Object.keys(ordersByDate).forEach(dateKey => {
          const tab = document.createElement('div');
          tab.className = 'day-tab';
          tab.textContent = dateKey;
          tab.addEventListener('click', () => {
            document.querySelectorAll('.day-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            Order.renderOrdersForDate(dateKey, ordersByDate[dateKey]);
          });
          
          if (DOM.dayTabs.children.length === 0) {
            tab.classList.add('active');
          }
          
          DOM.dayTabs.appendChild(tab);
        });
        
        // Renderiza os pedidos da primeira data ou mensagem de nenhum pedido
        DOM.ordersList.innerHTML = '';
        
        if (Object.keys(ordersByDate).length > 0) {
          const firstDate = Object.keys(ordersByDate)[0];
          Order.renderOrdersForDate(firstDate, ordersByDate[firstDate]);
        } else {
          DOM.ordersList.innerHTML = `
            <div class="list-group-item text-center py-5">
              <i class="fas fa-clipboard-list fa-3x text-muted mb-3"></i>
              <p class="mb-0">Nenhum pedido encontrado</p>
            </div>
          `;
        }
        
        const today = Utils.getTodayDate();
        const todayOrdersCount = orders.filter(order => order.data.includes(today)).length;
        const preparingOrdersCount = orders.filter(order => order.status === 'preparing').length;
        const deliveryOrdersCount = orders.filter(order => order.status === 'ready' && order.tipoEntrega === 'entrega').length;
        
        DOM.todayOrders.textContent = todayOrdersCount;
        DOM.preparingOrders.textContent = preparingOrdersCount;
        DOM.deliveryOrders.textContent = deliveryOrdersCount;
        
        Utils.updateTimestamp();
      },
      
      renderOrdersForDate: (dateKey, ordersForDate) => {
        DOM.ordersList.innerHTML = '';
        
        ordersForDate.forEach(order => {
          const orderElement = document.createElement('div');
          orderElement.className = `admin-order-card ${newOrders.includes(order.id) ? 'admin-order-new' : ''}`;
          
          const itemsHtml = order.itens.map(item => `
            <div class="admin-order-item">
              <span>${item.quantidade}x ${item.nome}${item.opcoes && Object.keys(item.opcoes).length > 0 ? ` (${Object.values(item.opcoes).join(', ')})` : ''}</span>
              <span>${Utils.formatCurrency(item.preco * item.quantidade)}</span>
            </div>
          `).join('');
          
          orderElement.innerHTML = `
            <div class="admin-order-header">
              <div>
                <span class="fw-bold">Pedido #${order.id.slice(-6)}</span>
                <span class="admin-order-status ${Order.getStatusClass(order.status)}">${Order.getStatusText(order.status)}</span>
              </div>
              <div class="text-muted small">${order.data}</div>
            </div>
            
            <div class="admin-order-body">
              <div class="mb-2">
                <div class="d-flex align-items-center mb-1">
                  <i class="fas fa-user me-2"></i>
                  <span>${order.cliente}</span>
                </div>
                <div class="d-flex align-items-center mb-1">
                  <i class="fas fa-phone me-2"></i>
                  <span>${order.telefone}</span>
                </div>
                <div class="d-flex align-items-center">
                  <i class="fas ${order.tipoEntrega === 'entrega' ? 'fa-motorcycle' : 'fa-store'} me-2"></i>
                  <span>${order.tipoEntrega === 'entrega' ? 'Entrega' : 'Retirada'}</span>
                </div>
                ${order.instrucoes ? `
                  <div class="d-flex align-items-center mt-2">
                    <i class="fas fa-sticky-note me-2"></i>
                    <span>${order.instrucoes}</span>
                  </div>
                ` : ''}
              </div>
              
              <div class="border-top pt-2">
                ${itemsHtml}
              </div>
            </div>
            
            <div class="admin-order-footer">
              <div class="admin-order-total">Total: ${Utils.formatCurrency(order.total)}</div>
              <div class="admin-order-actions">
                <button class="btn btn-outline-primary btn-sm update-status admin-btn" data-id="${order.id}" data-status="preparing">
                  <i class="fas fa-utensils me-1"></i> Preparar
                </button>
                <button class="btn btn-outline-success btn-sm update-status whatsapp-ready-btn admin-btn" data-id="${order.id}" data-status="ready">
                  <i class="fab fa-whatsapp me-1"></i> Avisar Pronto
                </button>
                <button class="btn btn-outline-danger btn-sm update-status admin-btn" data-id="${order.id}" data-status="cancelled">
                  <i class="fas fa-times me-1"></i> Cancelar
                </button>
                <button class="btn btn-outline-secondary btn-sm view-kitchen-order admin-btn" data-id="${order.id}">
                  <i class="fas fa-print me-1"></i> Imprimir
                </button>
              </div>
            </div>
          `;
          
          DOM.ordersList.appendChild(orderElement);
        });
      },
      
      getStatusText: (status) => {
        switch(status) {
          case 'pending': return 'Pendente';
          case 'preparing': return 'Em Preparo';
          case 'ready': return 'Pronto';
          case 'delivered': return 'Entregue';
          case 'cancelled': return 'Cancelado';
          default: return status;
        }
      },
      
      getStatusClass: (status) => {
        switch(status) {
          case 'pending': return 'status-pending';
          case 'preparing': return 'status-preparing';
          case 'ready': return 'status-ready';
          case 'delivered': return 'status-delivered';
          case 'cancelled': return 'status-cancelled';
          default: return 'bg-secondary';
        }
      },
      
      getPaymentText: (method, change) => {
        switch(method) {
          case 'mbway': return 'MB Way';
          case 'dinheiro': return `Dinheiro${change ? ' (Troco p/ ' + Utils.formatCurrency(parseFloat(change)) + ')' : ''}`;
          case 'cartao': return 'Cartão';
          default: return method;
        }
      },
      
      updateStatus: (orderId, newStatus) => {
        FirebaseService.updateOrderStatus(orderId, newStatus).then(success => {
          if (success) {
            Utils.showNotification(`Status do pedido #${orderId.slice(-6)} atualizado para ${Order.getStatusText(newStatus)}`, 'success');
            
            // Se o status for "preparando", enviar mensagem pelo WhatsApp
            if (newStatus === 'preparing') {
              const order = orders.find(o => o.id === orderId);
              if (order) {
                Order.sendPreparingNotification(order);
              }
            }
            
            // Se o status for "pronto", enviar mensagem pelo WhatsApp
            if (newStatus === 'ready') {
              const order = orders.find(o => o.id === orderId);
              if (order) {
                Order.sendReadyNotification(order);
              }
            }
          }
        });
      },
      
      sendPreparingNotification: (order) => {
        const message = `*🍳 Pedido em Preparo - ${APP_CONFIG.restaurantName}*%0A%0A👤 *Cliente:* ${order.cliente}%0A📞 *Telefone:* ${order.telefone}%0A%0A📦 *Número do Pedido:* #${order.id.slice(-6)}%0A%0A⏱ *Tempo estimado:* 45-50 minutos%0A%0A_Recebemos o seu pedido e estamos preparando. O tempo de espera é de 45-50 minutos. Obrigado por escolher a Cozinha da Vivi._`;
        
        const whatsappURL = `https://wa.me/${order.whatsapp.replace(/\D/g, '')}?text=${message}`;
        window.open(whatsappURL, "_blank");
      },
      
      sendReadyNotification: (order) => {
        const message = `*✅ Pedido Pronto - ${APP_CONFIG.restaurantName}*%0A%0A👤 *Cliente:* ${order.cliente}%0A📞 *Telefone:* ${order.telefone}%0A%0A📦 *Número do Pedido:* #${order.id.slice(-6)}%0A%0A🚚 *Forma de recebimento:* ${order.tipoEntrega === 'entrega' ? 'Entrega' : 'Retirada no local'}%0A%0A💰 *Total do Pedido:* ${Utils.formatCurrency(order.total)}%0A%0A_⌛ Por favor, dirija-se ao restaurante para retirar seu pedido ou aguarde a entrega._`;
        
        const whatsappURL = `https://wa.me/${order.whatsapp.replace(/\D/g, '')}?text=${message}`;
        window.open(whatsappURL, "_blank");
      },
      
      generateKitchenOrder: (orderId) => {
        const order = orders.find(o => o.id === orderId);
        if (!order) return '';
        
        const itemsText = order.itens.map(item => `
          <div class="kitchen-order-item">
            <span>${item.quantidade}x ${item.nome}${item.opcoes && Object.keys(item.opcoes).length > 0 ? ` (${Object.values(item.opcoes).join(', ')})` : ''}</span>
          </div>
        `).join('');
        
        const notes = order.instrucoes ? `
          <div class="kitchen-order-item">
            <span><strong>OBS:</strong> ${order.instrucoes}</span>
          </div>
        ` : '';
        
        const kitchenOrder = `
          <div class="kitchen-order" id="kitchen-order-print">
            <div class="kitchen-order-header">
              ${APP_CONFIG.restaurantName}<br>
              Pedido #${order.id.slice(-6)}
            </div>
            
            <div class="kitchen-order-item">
              <span><strong>Cliente:</strong> ${order.cliente}</span>
            </div>
            
            <div class="kitchen-order-item">
              <span><strong>${order.tipoEntrega === 'entrega' ? 'Entrega' : 'Retirada'}</strong></span>
            </div>
            
            ${order.tipoEntrega === 'entrega' ? `
              <div class="kitchen-order-item">
                <span><strong>Endereço:</strong> ${order.endereco}</span>
              </div>
            ` : ''}
            
            <div class="kitchen-order-item">
              <span><strong>Data:</strong> ${order.data}</span>
            </div>
            
            <div style="margin: 10px 0; border-top: 1px dashed #000;"></div>
            
            ${itemsText}
            
            ${notes}
            
            <div class="kitchen-order-footer">
              Total: ${Utils.formatCurrency(order.total)}
            </div>
          </div>
        `;
        
        return kitchenOrder;
      },
      printKitchenOrder: async (orderId) => {
  try {
    // 1. Encontrar o pedido
    const order = orders.find(o => o.id === orderId);
    if (!order) {
      throw new Error("Pedido não encontrado");
    }

    // 2. Verificar suporte Bluetooth
    if (!navigator.bluetooth) {
      throw new Error("Bluetooth não suportado neste navegador. Use Chrome ou Edge no Android.");
    }

    // 3. Conectar à impressora Bluetooth
    const device = await navigator.bluetooth.requestDevice({
      filters: [{ 
        name: "BlueTooth Printer", // Nome exato da sua impressora
        deviceId: "27A0A417-4342-A5B4-3199-702B5E923859" // ID do seu dispositivo
      }],
      optionalServices: ['000018f0-0000-1000-8000-00805f9b34fb'] // Serviço específico
    });

    // 4. Estabelecer conexão
    const server = await device.gatt.connect();
    const service = await server.getPrimaryService('000018f0-0000-1000-8000-00805f9b34fb');
    const characteristic = await service.getCharacteristic('00002af1-0000-1000-8000-00805f9b34fb');

    // 5. Função para envio seguro em pequenos pedaços
    const sendToPrinter = async (data) => {
      const encoder = new TextEncoder();
      const buffer = encoder.encode(data);
      const CHUNK_SIZE = 64; // Tamanho reduzido para maior confiabilidade
      const DELAY = 20; // Tempo entre envios
      
      for (let i = 0; i < buffer.length; i += CHUNK_SIZE) {
        await characteristic.writeValue(buffer.slice(i, i + CHUNK_SIZE));
        await new Promise(resolve => setTimeout(resolve, DELAY));
      }
    };

    // 6. Gerar conteúdo otimizado para impressão (versão corrigida)
    const generatePrintContent = () => {
      let content = '';
      
      // Inicialização da impressora (comandos universais)
      content += '\x1B\x40'; // Reset printer
      content += '\x1B\x52\x0F'; // Select character table (Portugal)
      
      // Configurações iniciais
      content += '\x1B\x20\x00'; // Set default line spacing
      content += '\x1B\x21\x00'; // Reset text style
      
      // Cabeçalho do restaurante
      content += '\x1B\x61\x01'; // Center align
      content += '\x1B\x21\x08'; // Double height
      content += '\x1B\x21\x20'; // Bold
      content += `${APP_CONFIG.restaurantName}\n`;
      content += '\x1B\x21\x00'; // Reset text style
      content += '\n';
      
      // Dados do pedido
      content += '\x1B\x61\x00'; // Left align
      content += '--------------------------------\n';
      content += '\x1B\x21\x08'; // Bold
      content += `PEDIDO #${order.id.slice(-6)}\n`;
      content += '\x1B\x21\x00'; // Normal
      content += '--------------------------------\n\n';
      
      // Informações do cliente
      content += `Cliente: ${order.cliente}\n`;
      content += `Telefone: ${order.telefone}\n`;
      content += `Data: ${new Date(order.data).toLocaleString('pt-BR')}\n`;
      content += order.tipoEntrega === 'entrega' 
        ? `Endereço: ${order.endereco}\n\n` 
        : 'RETIRADA NO LOCAL\n\n';
      
      // Itens do pedido
      content += '\x1B\x21\x08'; // Bold
      content += 'ITENS DO PEDIDO:\n';
      content += '\x1B\x21\x00'; // Normal
      content += '--------------------------------\n';
      
      order.itens.forEach(item => {
        content += `${item.quantidade}x ${item.nome}\n`;
        if (item.opcoes) {
          content += ' • ' + Object.entries(item.opcoes)
            .map(([key, value]) => `${key}: ${value}`)
            .join('\n • ') + '\n';
        }
      });
      
      // Total
      content += '--------------------------------\n';
      content += '\x1B\x61\x02'; // Right align
      content += '\x1B\x21\x08'; // Bold
      content += `TOTAL: ${Utils.formatCurrency(order.total)}\n\n`;
      
      // Rodapé
      content += '\x1B\x61\x01'; // Center align
      content += 'Obrigado pela preferência!\n';
      content += '\n\n\n';
      
      // Comandos finais
      content += '\x1D\x56\x41\x00'; // Full cut with feed
      content += '\x1B\x69'; // Partial cut (alternativa)
      
      return content;
    };

    // 7. Executar impressão
    await sendToPrinter(generatePrintContent());
    
    // Garantir que todos os dados foram enviados
    await new Promise(resolve => setTimeout(resolve, 200));
    
    Utils.showNotification('Comanda impressa com sucesso!', 'success');

  } catch (error) {
    console.error("Erro na impressão:", error);
    Utils.showNotification(`Falha ao imprimir: ${error.message}`, 'danger');
    
    // Desconectar em caso de erro
    try {
      if (device?.gatt?.connected) {
        await device.gatt.disconnect();
      }
    } catch (e) {
      console.error("Erro ao desconectar:", e);
    }
  }
}


    };

    // Funções de Filtro
    const Filter = {
      apply: (category) => {
        const products = document.querySelectorAll('.product-card');
        const tabs = document.querySelectorAll('.category-tab');
        
        products.forEach(product => {
          if (category === 'all' || product.dataset.category === category) {
            product.style.display = 'block';
            setTimeout(() => {
              product.style.opacity = '1';
            }, 50);
          } else {
            product.style.opacity = '0';
            setTimeout(() => {
              product.style.display = 'none';
            }, 300);
          }
        });
        
        tabs.forEach(tab => {
          if (tab.dataset.category === category) {
            tab.classList.add('active');
          } else {
            tab.classList.remove('active');
          }
        });
      }
    };
     // Adicionar event listeners para as novas abas de categoria
     document.querySelectorAll('.category-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        Filter.apply(tab.dataset.category);
      });
    });
    // Funções de Checkout
    const Checkout = {
      init: () => {
        const { subtotal, deliveryFee, total } = Cart.getTotals();
        
        DOM.checkoutSubtotal.textContent = Utils.formatCurrency(subtotal);
        DOM.checkoutDeliveryFee.textContent = Utils.formatCurrency(deliveryFee);
        DOM.checkoutTotal.textContent = Utils.formatCurrency(total);
        
        DOM.checkoutItems.innerHTML = '';
        cart.forEach(item => {
          const li = document.createElement("div");
          li.className = "list-group-item";
          
          let optionsText = '';
          if (item.options && Object.keys(item.options).length > 0) {
            optionsText = Object.values(item.options).map(opt => opt.join(', ')).join(' | ');
          }
          
          li.innerHTML = `
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="mb-1">${item.name}</h6>
                ${optionsText ? `<small class="text-muted">${optionsText}</small>` : ''}
              </div>
              <div class="d-flex align-items-center gap-3">
                <span class="quantity">${item.quantity}x</span>
                <span class="fw-bold">${Utils.formatCurrency(item.price * item.quantity)}</span>
              </div>
            </div>
          `;
          DOM.checkoutItems.appendChild(li);
        });
      },
      
      toggleDeliveryFields: (show) => {
        DOM.deliveryFields.forEach(field => {
          field.style.display = show ? 'block' : 'none';
        });
        
        const deliveryFee = show ? APP_CONFIG.deliveryFee : 0;
        DOM.checkoutDeliveryFee.textContent = Utils.formatCurrency(deliveryFee);
        
        const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        const total = subtotal + deliveryFee;
        DOM.checkoutTotal.textContent = Utils.formatCurrency(total);
      }
    };

    // Funções de Admin
    // Correção no processo de login
    const Admin = {
      login: (username, password) => {
        if (username === APP_CONFIG.adminCredentials.username && 
            password === APP_CONFIG.adminCredentials.password) {
          isAdminLoggedIn = true;
          localStorage.setItem('adminLoggedIn', 'true');
          
          // Esconde o modal de login
          if (DOM.adminLoginModal) {
            DOM.adminLoginModal.hide();
          }
          
          // Mostra o painel admin
          DOM.adminPanel.classList.remove("d-none");
          DOM.productSection.classList.add("d-none");
          DOM.checkoutSection.classList.add("d-none");
          DOM.cartIndicator.style.display = 'none';
          DOM.adminAccessBtn.style.display = 'none';
          
          // Atualiza o painel de pedidos
          Order.updateAdminPanel();
          
          Utils.showNotification('Login realizado com sucesso!', 'success');
          return true;
        } else {
          Utils.showNotification('Usuário ou senha incorretos', 'danger');
          return false;
        }
      },
      
      logout: () => {
        isAdminLoggedIn = false;
        localStorage.setItem('adminLoggedIn', 'false');
        
        DOM.adminPanel.classList.add("d-none");
        DOM.productSection.classList.remove("d-none");
        DOM.cartIndicator.style.display = 'flex';
        DOM.adminAccessBtn.style.display = 'flex';
        
        Utils.showNotification('Logout realizado com sucesso', 'info');
      },
      
      checkLoginStatus: () => {
        if (isAdminLoggedIn) {
          DOM.adminPanel.classList.remove("d-none");
          DOM.productSection.classList.add("d-none");
          DOM.checkoutSection.classList.add("d-none");
          DOM.cartIndicator.style.display = 'none';
          DOM.adminAccessBtn.style.display = 'none';
          Order.updateAdminPanel();
        }
      }
    };

    // Funções para lidar com opções de produtos
    const ProductOptions = {
  showOptions: (productId, productName) => {
    let optionsHtml = '';
    let basePrice = 0;
    
    // Identifica o tipo de produto
    const isChurrascoItem = ['101', '102', '103', '104'].includes(productId);
    const isAcaiItem = ['601', '602'].includes(productId);

    // Opções para Churrasco
    if (isChurrascoItem) {
      basePrice = productId === "101" ? 12.00 : 
                 productId === "102" ? 13.00 : 
                 productId === "103" ? 12.00 : 
                 productId === "104" ? 12.00 : 0;
      
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Feijão <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="feijao" value="Feijão de caldo" required>
              Feijão de caldo
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="feijao" value="Feijão tropeiro" required>
              Feijão tropeiro
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Acompanhamentos <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Banana frita" required>
              Banana frita
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Batata frita" required>
              Batata frita
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca cozida" required>
              Mandioca cozida
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca frita" required>
              Mandioca frita
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
      `;
     
// Adicione este caso no início da função showOptions
if (productId === "601" || productId === "602") {
  basePrice = productId === "601" ? 6.00 : 10.00;
  
  optionsHtml = `
    <div class="option-section">
      <div class="option-section-title">Escolha seus acompanhamentos</div>
      <div class="option-item">
        <label>
          <input type="checkbox" name="acompanhamentos" value="Granola">
          Granola
        </label>
      </div>
      <div class="option-item">
        <label>
          <input type="checkbox" name="acompanhamentos" value="Leite condensado">
          Leite condensado
        </label>
      </div>
      <div class="option-item">
        <label>
          <input type="checkbox" name="acompanhamentos" value="Banana">
          Banana
        </label>
      </div>
      <div class="option-item">
        <label>
          <input type="checkbox" name="acompanhamentos" value="Morango">
          Morango
        </label>
      </div>
      <div class="option-item">
        <label>
          <input type="checkbox" name="acompanhamentos" value="Leite Ninho">
          Leite Ninho
        </label>
      </div>
    </div>
    
    <div class="option-section">
      <div class="option-section-title">Ou selecione:</div>
      <div class="option-item">
        <label>
          <input type="radio" name="opcao_açai" value="completo" onclick="selectAllAçaiToppings()">
          Quero Completo (todos os acompanhamentos)
        </label>
      </div>
      <div class="option-item">
        <label>
          <input type="radio" name="opcao_açai" value="personalizado" checked>
          Personalizado (escolher acompanhamentos)
        </label>
      </div>
    </div>
  `;
}
      
      // Seções específicas para cada tipo de item
      if (productId === "101") { // Churrasco Misto
        optionsHtml += `
          <div class="option-section" id="carnes-section">
            <div class="option-section-title">Carnes <span class="required-option">*</span></div>
            <div class="option-item">
              <label>
                <input type="checkbox" name="carnes" value="Coração de galinha" data-max="2">
                Coração de galinha
              </label>
            </div>
            <div class="option-item">
              <label>
                <input type="checkbox" name="carnes" value="Costelinha de porco" data-max="2">
                Costelinha de porco
              </label>
            </div>
            <div class="option-item">
              <label>
                <input type="checkbox" name="carnes" value="Filé de frango" data-max="2">
                Filé de frango
              </label>
            </div>
            <div class="option-item">
              <label>
                <input type="checkbox" name="carnes" value="Linguiça" data-max="2">
                Linguiça
              </label>
            </div>
            <div class="option-item">
              <label>
                <input type="checkbox" name="carnes" value="Maminha (+1€)" data-additional-price="1" data-exclusive>
                Maminha <span class="additional-price">+€1,00</span>
              </label>
            </div>
            <div class="option-item">
              <label>
                <input type="checkbox" name="carnes" value="Torresmo" data-max="2">
                Torresmo
              </label>
            </div>
            <div class="max-selection" id="max-carnes">Escolha até 2 carnes (ou somente Maminha)</div>
          </div>
          
             <div class="option-section" id="ponto-carne-section" style="display:none;">
      <div class="option-section-title">Ponto da Carne <span class="required-option">*</span></div>
      <div class="option-item">
        <label>
          <input type="radio" name="ponto_carne" value="Selada" required>
          Selada
        </label>
      </div>
      <div class="option-item">
        <label>
          <input type="radio" name="ponto_carne" value="Mal passada" required>
          Mal passada
        </label>
      </div>
      <div class="option-item">
        <label>
          <input type="radio" name="ponto_carne" value="Ao ponto" required>
          Ao ponto
        </label>
      </div>
      <div class="option-item">
        <label>
          <input type="radio" name="ponto_carne" value="Ao ponto para bem" required>
          Ao ponto para bem
        </label>
      </div>
      <div class="option-item">
        <label>
          <input type="radio" name="ponto_carne" value="Bem passado" required>
          Bem passado
        </label>
      </div>
      <div class="max-selection">Selecione uma opção</div>
    </div>
  `;
      }
      
      // Opções comuns para salada
      optionsHtml += `
        <div class="option-section">
          <div class="option-section-title">Salada <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Salada mista" required>
              Salada mista (Alface, tomate, pepino, cebola, e salsa)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Vinagrete" required>
              Vinagrete
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Não quero salada" required>
              Não quero salada
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Refrigerante</div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água 500ml (+1€)" data-additional-price="1">
              Água 500ml <span class="additional-price">+€1,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água Castelo 500ml (+1.5€)" data-additional-price="1.5">
              Água Castelo 500ml <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água das Pedras 500ml (+1.5€)" data-additional-price="1.5">
              Água das Pedras 500ml <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola (+2€)" data-additional-price="2">
              Coca-Cola <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola Zero (+2€)" data-additional-price="2">
              Coca-Cola Zero <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Fanta (+2€)" data-additional-price="2">
              Fanta <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Guaraná do Brasil (+2€)" data-additional-price="2">
              Guaraná do Brasil <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Ice Tea de Manga (+2€)" data-additional-price="2">
              Ice Tea de Manga <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Sem refrigerante">
              Sem refrigerante
            </label>
          </div>
        </div>
      `;
    } else {
      // Opções padrão para outros produtos
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Observações</div>
          <div class="option-item">
            <textarea class="form-control" id="observacoes" rows="3" placeholder="Alguma observação sobre este item?"></textarea>
          </div>
        </div>
      `;
    }
    
    DOM.productOptionsModalTitle.textContent = `Opções: ${productName}`;
    DOM.productOptionsContent.innerHTML = optionsHtml;
    
    currentProductOptions = {
      id: productId,
      name: productName,
      price: basePrice,
      image: document.querySelector(`.product-card[data-id="${productId}"] .product-image`)?.src || ''
    };
    
    // Adiciona eventos para controlar a seleção máxima
    if (isChurrascoItem && productId === "101") {
      const carnesSection = DOM.productOptionsContent.querySelector('#carnes-section');
      const carnesCheckboxes = carnesSection.querySelectorAll('input[type="checkbox"]');
      const maxMessage = carnesSection.querySelector('.max-selection');
      
      carnesCheckboxes.forEach(checkbox => {
    checkbox.addEventListener('change', function() {
        const isExclusive = this.hasAttribute('data-exclusive');
        const checkedCount = Array.from(carnesCheckboxes)
            .filter(cb => cb.checked && !cb.hasAttribute('data-exclusive')).length;
        
        if (isExclusive && this.checked) {
            // Se selecionou Maminha (opção exclusiva)
            // Desmarca e desabilita todas as outras carnes
            carnesCheckboxes.forEach(cb => {
                if (cb !== this) {
                    cb.checked = false;
                    cb.disabled = true;
                    cb.closest('.option-item').classList.add('disabled');
                }
            });
            
            // Mostra a seção de ponto da carne
            document.getElementById('ponto-carne-section').style.display = 'block';
            maxMessage.textContent = "Opção 'Maminha' selecionada";
        } 
        else if (this.checked && checkedCount >= 2) {
            // Se selecionou 2 carnes normais
            // Desabilita as não selecionadas
            carnesCheckboxes.forEach(cb => {
                if (!cb.checked && !cb.hasAttribute('data-exclusive')) {
                    cb.disabled = true;
                    cb.closest('.option-item').classList.add('disabled');
                }
            });
            maxMessage.textContent = "Máximo de 2 carnes selecionadas";
        } 
        else {
            // Reativa todas as opções (exceto se Maminha estiver selecionada)
            const maminhaSelected = Array.from(carnesCheckboxes)
                .some(cb => cb.hasAttribute('data-exclusive') && cb.checked);
            
            if (!maminhaSelected) {
                carnesCheckboxes.forEach(cb => {
                    cb.disabled = false;
                    cb.closest('.option-item').classList.remove('disabled');
                });
                
                // Atualiza mensagem
                if (checkedCount === 0) {
                    maxMessage.textContent = "Escolha até 2 carnes (ou somente Maminha)";
                } else {
                    maxMessage.textContent = `Selecionado: ${checkedCount}/2 carnes`;
                }
                
                // Esconde a seção de ponto da carne
                document.getElementById('ponto-carne-section').style.display = 'none';
            }
        }
        
        maxMessage.style.display = 'block';
    });
});
      
      // Validação de campos obrigatórios
      const requiredSections = DOM.productOptionsContent.querySelectorAll('.option-section [required]');
      requiredSections.forEach(section => {
        section.addEventListener('change', function() {
          const sectionContainer = this.closest('.option-section');
          const maxMessage = sectionContainer.querySelector('.max-selection');
          
          if (this.type === 'checkbox' || this.type === 'radio') {
            const selected = sectionContainer.querySelector('input:checked');
            if (selected) {
              maxMessage.style.display = 'none';
              sectionContainer.classList.remove('required-field');
            } else {
              maxMessage.style.display = 'block';
              maxMessage.textContent = 'Selecione uma opção';
              sectionContainer.classList.add('required-field');
            }
          }
        });
      });
    }
    
    DOM.productOptionsModal.show();
  },
  handleOptionsConfirmation: () => {
    // Validação de campos obrigatórios
    const requiredSections = DOM.productOptionsContent.querySelectorAll('.option-section [required]');
    let isValid = true;
    
    requiredSections.forEach(section => {
      const sectionContainer = section.closest('.option-section');
      if (sectionContainer.style.display !== 'none') {
        const maxMessage = sectionContainer.querySelector('.max-selection');
        
        if (section.type === 'checkbox' || section.type === 'radio') {
          const selected = sectionContainer.querySelector('input:checked');
          if (!selected) {
            maxMessage.style.display = 'block';
            sectionContainer.classList.add('required-field');
            isValid = false;
          }
        }
      }
    });
    
    if (!isValid) {
      Utils.showNotification('Por favor, selecione todas as opções obrigatórias', 'danger');
      return;
    }
    
    // Coletar todas as opções selecionadas
    const options = {};
    
    // Lógica específica para Açaí
    if (currentProductOptions.id === "601" || currentProductOptions.id === "602") {
      const opcaoCompleta = document.querySelector('input[name="opcao_açai"]:checked').value === "completo";
      const acompanhamentos = [];
      
      if (opcaoCompleta) {
        // Adiciona todos os acompanhamentos
        acompanhamentos.push("Granola", "Leite condensado", "Banana", "Morango", "Leite Ninho");
      } else {
        // Adiciona apenas os selecionados
        const selected = document.querySelectorAll('input[name="acompanhamentos"]:checked');
        selected.forEach(input => {
          acompanhamentos.push(input.value);
        });
      }
      
      options["Acompanhamentos"] = acompanhamentos.length > 0 ? acompanhamentos : ["Sem acompanhamentos"];
    } 
    else {
      // Lógica para outros produtos
      const sections = DOM.productOptionsContent.querySelectorAll('.option-section');
      
      sections.forEach(section => {
        const title = section.querySelector('.option-section-title')?.textContent.replace(' *', '');
        const inputs = section.querySelectorAll('input:checked');
        
        if (inputs.length > 0 && title) {
          options[title] = Array.from(inputs).map(input => {
            const additionalPrice = input.getAttribute('data-additional-price') || 0;
            if (additionalPrice) {
              currentProductOptions.price += parseFloat(additionalPrice);
            }
            return input.value;
          });
        }
      });
    }
    
    // Adicionar ao carrinho com as opções
    Cart.addItem(
      currentProductOptions.id,
      currentProductOptions.name,
      currentProductOptions.price,
      currentProductOptions.image,
      options
    );
    
    // Resetar o produto atual e fechar o modal
    currentProductOptions = null;
    DOM.productOptionsModal.hide();
    
    // Mostrar feedback visual
    DOM.confirmProductOptions.classList.add('added');
    setTimeout(() => {
      DOM.confirmProductOptions.classList.remove('added');
    }, 2000);
  }
};

// Função auxiliar para selecionar todos os acompanhamentos do açaí
function selectAllAçaiToppings() {
  const checkboxes = document.querySelectorAll('input[name="acompanhamentos"]');
  checkboxes.forEach(checkbox => {
    checkbox.checked = true;
  });
}
    // Event Listeners
    function setupEventListeners() {
      // Botão Adicionar ao Carrinho
      document.addEventListener('click', (event) => {
        if (event.target.closest('.add-to-cart')) {
          const button = event.target.closest('.add-to-cart');
          const productCard = button.closest('.product-card');
          
          if (productCard) {
            const id = productCard.getAttribute("data-id");
            const nameElement = productCard.querySelector(".product-name");
            const priceElement = productCard.querySelector(".product-price");
            const imageElement = productCard.querySelector(".product-image");
            
            if (nameElement && priceElement) {
              const name = nameElement.textContent;
              const price = Utils.parsePrice(priceElement.textContent);
              const image = imageElement?.src || '';
              
              if (productCard.getAttribute('data-has-options') === 'true') {
                ProductOptions.showOptions(id, name);
              } else {
                Cart.addItem(id, name, price, image);
              }
            }
          }
        }

    // Remover item do carrinho
    if (event.target.closest('.remove-item')) {
      const id = event.target.closest('.remove-item').getAttribute("data-id");
      Cart.removeItem(id);
    }

    // Aumentar quantidade
    if (event.target.closest('.increase')) {
      const id = event.target.closest('.increase').getAttribute("data-id");
      const item = cart.find(item => item.id === id);
      if (item) {
        Cart.updateItemQuantity(id, item.quantity + 1);
      }
    }

    // Diminuir quantidade
    if (event.target.closest('.decrease')) {
      const id = event.target.closest('.decrease').getAttribute("data-id");
      const item = cart.find(item => item.id === id);
      if (item) {
        Cart.updateItemQuantity(id, item.quantity - 1);
      }
    }
  });

  // Botão Finalizar Pedido
  if (DOM.checkoutButton) {
    DOM.checkoutButton.addEventListener('click', function(e) {
      e.preventDefault();
      
      if (cart.length === 0) {
        alert('Seu carrinho está vazio!');
        return;
      }

      if (DOM.productSection && DOM.checkoutSection) {
        DOM.productSection.classList.add("d-none");
        DOM.checkoutSection.classList.remove("d-none");
        Checkout.init();
        
        if (DOM.cartSidebar && DOM.cartSidebar.classList.contains('show')) {
          Cart.toggleSidebar();
        }
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    });
  }

  // Botão Voltar para o Carrinho
  if (DOM.backToCartButton) {
    DOM.backToCartButton.addEventListener("click", () => {
      if (DOM.productSection && DOM.checkoutSection) {
        DOM.productSection.classList.remove("d-none");
        DOM.checkoutSection.classList.add("d-none");
      }
    });
  }

  // Botões de Categoria
  document.querySelectorAll('.category-tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelectorAll('.category-tab').forEach(c => c.classList.remove('active'));
      tab.classList.add('active');
      Filter.apply(tab.dataset.category);
    });
  });

  // Botão do Carrinho
  if (DOM.cartIndicator) {
    DOM.cartIndicator.addEventListener('click', () => {
      Cart.toggleSidebar();
    });
  }

  // Botão Fechar Carrinho
  if (DOM.closeCart) {
    DOM.closeCart.addEventListener('click', () => {
      Cart.toggleSidebar();
    });
  }
  
  // Overlay do Carrinho
  if (DOM.cartOverlay) {
    DOM.cartOverlay.addEventListener('click', () => {
      Cart.toggleSidebar();
    });
  }
  
  // Opções de Entrega
  DOM.deliveryOptionCards?.forEach(card => {
    card.addEventListener('click', () => {
      const input = card.querySelector('input');
      if (input) {
        input.checked = true;
        DOM.deliveryOptionCards?.forEach(c => c.classList.remove('active'));
        card.classList.add('active');
        Checkout.toggleDeliveryFields(input.value === 'entrega');
      }
    });
  });

  // Métodos de Pagamento
  DOM.paymentMethodCards?.forEach(card => {
    card.addEventListener('click', () => {
      const input = card.querySelector('input');
      if (input) {
        input.checked = true;
        DOM.paymentMethodCards?.forEach(c => c.classList.remove('active'));
        card.classList.add('active');
        
        if (input.value === 'dinheiro' && DOM.cashChangeField) {
          DOM.cashChangeField.classList.remove('d-none');
        } else if (DOM.cashChangeField) {
          DOM.cashChangeField.classList.add('d-none');
        }
      }
    });
  });

   // Botão de acesso admin (NOVO)
   if (DOM.adminAccessBtn) {
        DOM.adminAccessBtn.addEventListener('click', () => {
          if (DOM.adminLoginModal) {
            DOM.adminLoginModal.show();
          }
        });
      }
  
   // Formulário de Login Admin (ATUALIZADO)
   const adminLoginForm = document.getElementById('admin-login-form');
      if (adminLoginForm) {
        adminLoginForm.addEventListener('submit', (e) => {
          e.preventDefault();
          const username = document.getElementById('admin-username')?.value;
          const password = document.getElementById('admin-password')?.value;
          
          if (username && password) {
            Admin.login(username, password);
          } else {
            Utils.showNotification('Por favor, preencha todos os campos', 'danger');
          }
        });
      }

  // Botão Logout Admin
  if (DOM.adminLogoutButton) {
    DOM.adminLogoutButton.addEventListener('click', () => {
      Admin.logout();
    });
  }
  
  // Botões no Painel Admin
  if (DOM.ordersList) {
    DOM.ordersList.addEventListener('click', (event) => {
      if (event.target.closest('.update-status')) {
        const button = event.target.closest('.update-status');
        const orderId = button.getAttribute('data-id');
        const newStatus = button.getAttribute('data-status');
        Order.updateStatus(orderId, newStatus);
      }
      
      if (event.target.closest('.view-kitchen-order')) {
        const button = event.target.closest('.view-kitchen-order');
        const orderId = button.getAttribute('data-id');
        const kitchenOrder = Order.generateKitchenOrder(orderId);
        DOM.kitchenOrderContent.innerHTML = kitchenOrder;
        DOM.kitchenOrderModal.show();
      }
    });
  }

  // Botão Imprimir Pedido
  if (DOM.printKitchenOrder) {
    DOM.printKitchenOrder.addEventListener('click', () => {
      const orderId = document.querySelector('.view-kitchen-order.active')?.getAttribute('data-id') || 
                      document.querySelector('.view-kitchen-order')?.getAttribute('data-id');
      if (orderId) {
        Order.printKitchenOrder(orderId);
        DOM.kitchenOrderModal.hide();
      }
    });
  }
  
  // Botão Aplicar Filtros
  if (DOM.applyFilters) {
    DOM.applyFilters.addEventListener('click', () => {
      Order.updateAdminPanel();
    });
  }

  // Notificação de Pedidos
  if (DOM.notificationBell) {
    DOM.notificationBell.addEventListener('click', () => {
      DOM.notificationBadge.classList.add('d-none');
      pendingOrdersCount = 0;
      newOrders = [];
    });
  }
  
  // Confirmar Opções do Produto
  if (DOM.confirmProductOptions) {
    DOM.confirmProductOptions.addEventListener('click', () => {
      ProductOptions.handleOptionsConfirmation();
    });
  }
}
    
 

    // Adicionar este código na seção de Event Listeners
  // Botão Confirmar Pedido (ATUALIZADO)
  if (DOM.confirmOrderButton) {
        DOM.confirmOrderButton.addEventListener('click', async (e) => {
          e.preventDefault();
          
          // Validar campos obrigatórios
          const name = document.getElementById('customer-name').value;
          const phone = document.getElementById('customer-phone').value;
          const isDelivery = document.getElementById('delivery-method').checked;
          const address = document.getElementById('customer-address').value;
          
          if (!name || !phone) {
            Utils.showNotification('Por favor, preencha seu nome e telefone', 'danger');
            return;
          }
          
          if (!Utils.validatePhone(phone)) {
            Utils.showNotification('Por favor, insira um telefone válido', 'danger');
            return;
          }
          
          if (isDelivery && !address) {
            Utils.showNotification('Por favor, preencha seu endereço completo', 'danger');
            return;
          }

          try {
            // Mostrar estado de carregamento
            DOM.confirmOrderButton.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Processando...';
            DOM.confirmOrderButton.disabled = true;

            // Criar e salvar o pedido
            const order = Order.create();
            const savedOrder = await Order.saveOrder(order);
            
            if (!savedOrder) {
              throw new Error("Falha ao salvar pedido");
            }

            // Enviar para WhatsApp
            Order.sendToWhatsApp(savedOrder);
            
          } catch (error) {
            console.error("Erro ao confirmar pedido:", error);
            Utils.showNotification(`Erro: ${error.message}`, 'danger');
            
          } finally {
            // Restaurar o botão
            DOM.confirmOrderButton.innerHTML = '<i class="fas fa-check-circle me-2"></i> Confirmar Pedido';
            DOM.confirmOrderButton.disabled = false;
          }
        });
      }
    
    document.addEventListener('DOMContentLoaded', function() {
  if (DOM.productSection && DOM.checkoutSection && DOM.adminPanel) {
    DOM.productSection.classList.remove("d-none");
    DOM.checkoutSection.classList.add("d-none");
    DOM.adminPanel.classList.add("d-none");
  }

  setupEventListeners();
  Cart.updateUI();
  Filter.apply('all');
  Checkout.toggleDeliveryFields(true);
  Admin.checkLoginStatus();

  FirebaseService.listenForOrders((ordersFromFirebase) => {
    orders = ordersFromFirebase;
    if (isAdminLoggedIn) {
      Order.updateAdminPanel();
    }
  });
});

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>   