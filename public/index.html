<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Faça seu pedido online no Restaurante Cozinha da Vivi - Comida caseira de qualidade">
  <title>Cozinha da Vivi - Pedido Online</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

  <style>
/* Estilos Gerais Aprimorados */
:root {
  --primary-color: #280b04;
  --secondary-color: #ffb501;
  --dark-color: #2f3542;
  --light-color: #f1f2f6;
  --success-color: #617c33;
  --transition-speed: 0.3s;
}

body {
  font-family: 'Poppins', sans-serif;
  background-color: #fff1ea;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  line-height: 1.6;
  overflow-x: hidden;
}

.main-content {
  flex: 1;
  background-color: #fff1ea;
  padding-bottom: 2rem;
}

/* Navbar Modernizado */
.main-header {
  position: sticky;
  top: 0;
  z-index: 1030;
  background-color: #fff1e4;
  box-shadow: 0 2px 10px rgba(0,0,0,0.08);
  padding: 0.5rem 0;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  transition: all var(--transition-speed) ease;
}

.navbar-container {
  max-width: 1200px;
  margin: 0 auto;
  width: 100%;
  padding: 0 1.5rem;
}

.logo-container {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  transition: transform var(--transition-speed) ease;
}

.logo-container:hover {
  transform: scale(1.02);
}

.logo-img {
  height: 50px;
  width: 50px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--primary-color);
  transition: all var(--transition-speed) ease;
  box-shadow: 0 3px 6px rgba(0,0,0,0.1);
}

.logo-img:hover {
  transform: scale(1.05);
  box-shadow: 0 5px 10px rgba(0,0,0,0.15);
}

.logo-text {
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.logo-text h1 {
  font-size: 1.3rem;
  margin-bottom: 0.2rem;
  line-height: 1.2;
  color: var(--primary-color);
  font-weight: 800;
  letter-spacing: -0.5px;
}

.logo-text p {
  font-size: 0.8rem;
  margin-bottom: 0;
  color: #5a4a42;
  font-weight: 500;
}

.cart-icon-container {
  position: relative;
  cursor: pointer;
  transition: transform var(--transition-speed) ease;
}

.cart-icon-container:hover {
  transform: scale(1.1);
}

.cart-icon {
  font-size: 1.4rem;
  color: var(--primary-color);
}

.cart-icon-badge {
  position: absolute;
  top: -8px;
  right: -8px;
  background-color: var(--secondary-color);
  color: var(--primary-color);
  border-radius: 50%;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.7rem;
  font-weight: bold;
}

/* Seção do Cardápio Modernizada */
.menu-section {
  margin-bottom: 2rem;
  padding: 0 1.5rem;
}

.menu-header {
  display: flex;
  flex-direction: column;
  margin-bottom: 2rem;
  text-align: center;
}

.menu-title {
  margin-top: 1.5rem;
  font-family: 'Playfair Display', serif;
  font-weight: 800;
  font-size: 2.2rem;
  color: var(--primary-color);
  margin-bottom: 1.2rem;
  position: relative;
  display: inline-block;
  padding-bottom: 10px;
  letter-spacing: -0.5px;
}

.menu-title:after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 4px;
  background-color: var(--secondary-color);
  border-radius: 3px;
}

.category-tabs {
  display: flex;
  gap: 10px;
  overflow-x: auto;
  padding-bottom: 15px;
  scrollbar-width: thin;
  scrollbar-color: var(--secondary-color) transparent;
  margin-top: 1rem;
  justify-content: center;
}

.category-tabs::-webkit-scrollbar {
  height: 5px;
}

.category-tabs::-webkit-scrollbar-thumb {
  background-color: var(--secondary-color);
  border-radius: 3px;
}

.category-tabs::-webkit-scrollbar-track {
  background-color: transparent;
}

.category-tab {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-width: 90px;
  padding: 12px 10px;
  border-radius: 12px;
  font-size: 0.8rem;
  font-weight: 600;
  transition: all var(--transition-speed) ease;
  border: 1px solid rgba(40, 11, 4, 0.1);
  background-color: white;
  color: var(--primary-color);
  cursor: pointer;
  text-align: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  flex-shrink: 0;
}

.category-tab i {
  font-size: 1.2rem;
  margin-bottom: 8px;
  color: var(--primary-color);
  transition: all var(--transition-speed) ease;
}

.category-tab.active {
  background-color: var(--primary-color);
  color: var(--secondary-color);
  border-color: var(--primary-color);
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(40, 11, 4, 0.15);
}

.category-tab.active i {
  color: var(--secondary-color);
  transform: scale(1.05);
}

.category-tab:hover:not(.active) {
  background-color: #f8f9fa;
  transform: translateY(-2px);
  box-shadow: 0 3px 8px rgba(0,0,0,0.1);
}

/* Grid de Produtos Modernizado */
.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
  margin-top: 1.5rem;
}

.product-card {
  background-color: white;
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1);
  display: flex;
  flex-direction: column;
  height: 100%;
  border: none;
  position: relative;
}

.product-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
}

.product-badge {
  position: absolute;
  top: 12px;
  right: 12px;
  padding: 5px 12px;
  border-radius: 16px;
  font-size: 0.7rem;
  font-weight: 700;
  z-index: 2;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.product-image-container {
  position: relative;
  height: 180px;
  overflow: hidden;
  border-bottom: 1px solid rgba(0,0,0,0.05);
}

.product-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.product-card:hover .product-image {
  transform: scale(1.05);
}

.product-content {
  padding: 18px;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.product-name {
  font-size: 1.1rem;
  font-weight: 800;
  color: var(--primary-color);
  margin-bottom: 8px;
  line-height: 1.3;
}

.product-description {
  font-size: 0.85rem;
  color: #6c757d;
  margin-bottom: 15px;
  line-height: 1.5;
  flex: 1;
}

.product-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: auto;
  padding-top: 15px;
  border-top: 1px solid rgba(0, 0, 0, 0.05);
}

.product-price {
  font-weight: 800;
  color: var(--primary-color);
  font-size: 1.2rem;
  margin: 0;
}

.add-to-cart {
  background-color: var(--primary-color);
  color: var(--secondary-color);
  border: none;
  border-radius: 8px;
  padding: 8px 16px;
  font-size: 0.9rem;
  font-weight: 600;
  transition: all var(--transition-speed);
  display: flex;
  align-items: center;
  gap: 6px;
  cursor: pointer;
  box-shadow: 0 3px 6px rgba(40, 11, 4, 0.15);
}

.add-to-cart:hover {
  background-color: var(--primary-color);
  transform: translateY(-2px);
  box-shadow: 0 5px 10px rgba(40, 11, 4, 0.25);
}

.add-to-cart.added {
  background-color: var(--success-color) !important;
  box-shadow: 0 3px 6px rgba(97, 124, 51, 0.25);
}

/* Carrinho Sidebar Modernizado */
.cart-sidebar {
  position: fixed;
  top: 0;
  right: -100%;
  width: 100%;
  max-width: 380px;
  height: 100vh;
  background-color: white;
  z-index: 1050;
  transition: right 0.3s cubic-bezier(0.215, 0.61, 0.355, 1);
  box-shadow: -5px 0 20px rgba(0,0,0,0.08);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
}

.cart-sidebar.show {
  right: 0;
}

.cart-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.5);
  z-index: 1040;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease;
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}

.cart-overlay.show {
  opacity: 1;
  visibility: visible;
}

.cart-sidebar .card {
  border: none;
  border-radius: 0;
  height: 100%;
  display: flex;
  flex-direction: column;
}

.cart-sidebar .card-header {
  padding: 16px 20px;
  background-color: var(--primary-color);
  color: white;
  border-bottom: none;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.cart-sidebar .card-header h2 {
  font-size: 1.2rem;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

.cart-sidebar .card-body {
  padding: 0;
  flex: 1;
  overflow-y: auto;
}

.cart-sidebar .list-group-item {
  padding: 16px 20px;
  border-bottom: 1px solid rgba(0,0,0,0.05);
  transition: background-color 0.2s;
}

.cart-sidebar .list-group-item:hover {
  background-color: #f9f9f9;
}

.cart-sidebar .empty-cart {
  padding: 30px 20px;
  text-align: center;
}

.empty-cart-icon {
  font-size: 2.5rem;
  opacity: 0.15;
  margin-bottom: 12px;
}

.cart-sidebar .card-footer {
  padding: 18px 20px;
  background-color: #f8f9fa;
  border-top: 1px solid rgba(0,0,0,0.05);
}

/* Botões e Controles */
.btn {
  transition: all var(--transition-speed) ease;
  font-weight: 600;
}

.btn-primary {
  background-color: var(--primary-color);
  border-color: var(--primary-color);
  color: var(--secondary-color);
  padding: 10px 20px;
  border-radius: 8px;
  box-shadow: 0 3px 6px rgba(40, 11, 4, 0.15);
}

.btn-primary:hover {
  background-color: var(--primary-color);
  border-color: var(--primary-color);
  color: var(--secondary-color);
  transform: translateY(-2px);
  box-shadow: 0 5px 10px rgba(40, 11, 4, 0.25);
}

.btn-outline-secondary {
  border-radius: 8px;
  padding: 8px 16px;
}

/* Adicione isso na seção de estilo */
.quantity-control {
  display: flex;
  align-items: center;
  gap: 6px;
}

.quantity-btn {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background: #f5f5f5;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  padding: 0;
  margin: 0;
}

.quantity {
  min-width: 20px;
  text-align: center;
  font-weight: 600;
}
/* Se ainda estiver desalinhado, adicione isso: */
.quantity-control {
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Garante que os ícones dentro dos botões estejam centralizados */
.quantity-btn i {
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}
.quantity-btn:hover {
  background-color: #e9ecef;
  transform: scale(1.1);
}

.quantity-input {
  width: 40px;
  text-align: center;
  border: none;
  background: transparent;
  font-weight: bold;
  font-size: 0.9rem;
}

.remove-item {
  transition: all var(--transition-speed);
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  color: #dc3545;
  background-color: transparent;
  border: none;
}

.remove-item:hover {
  transform: scale(1.1);
  background-color: #f8d7da;
}

/* Checkout Modernizado */
.checkout-container {
  max-width: 800px;
  margin: 0 auto;
  padding: 0 1.5rem;
}

.checkout-step {
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 1px solid #eee;
}

.checkout-step:last-child {
  border-bottom: none;
}

.delivery-option-card, 
.payment-method-card {
  cursor: pointer;
  transition: all var(--transition-speed) ease;
  border: 1px solid #ddd;
  border-radius: 10px;
  padding: 16px;
  background-color: white;
  box-shadow: 0 3px 8px rgba(0,0,0,0.04);
  margin-bottom: 12px;
}

.delivery-option-card:hover, 
.payment-method-card:hover {
  border-color: var(--primary-color);
  transform: translateY(-2px);
  box-shadow: 0 5px 12px rgba(0,0,0,0.08);
}

.delivery-option-card.active, 
.payment-method-card.active {
  border-color: var(--primary-color);
  background-color: rgba(40, 11, 4, 0.03);
}

.payment-icon {
  font-size: 1.5rem;
  margin-right: 10px;
  color: var(--primary-color);
}

.payment-method-label {
  font-weight: 600;
  display: flex;
  align-items: center;
  font-size: 1rem;
}

/* Formulários Modernizados */
.form-control {
  padding: 10px 14px;
  border-radius: 8px;
  border: 1px solid #ddd;
  transition: all var(--transition-speed);
  font-size: 0.9rem;
}

.form-control:focus {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 0.2rem rgba(40, 11, 4, 0.1);
}

.form-label {
  font-weight: 600;
  margin-bottom: 6px;
  color: var(--dark-color);
  font-size: 0.9rem;
}

/* Painel Admin Modernizado */
.admin-navbar {
  background-color: var(--primary-color);
  position: sticky;
  top: 0;
  z-index: 1020;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  padding: 10px 0;
}

.admin-navbar .navbar-brand {
  font-weight: 700;
  font-size: 1.1rem;
  display: flex;
  align-items: center;
  color: var(--secondary-color);
  letter-spacing: -0.5px;
  gap: 8px;
}

.admin-navbar .btn-outline-light {
  color: var(--secondary-color);
  border-color: var(--secondary-color);
  border-radius: 6px;
  font-weight: 600;
  padding: 6px 12px;
  font-size: 0.85rem;
}

.admin-navbar .btn-outline-light:hover {
  background-color: var(--secondary-color);
  color: var(--primary-color);
}

.admin-panel-container {
  padding: 20px 0;
}

.admin-stats-card {
  border-left: 4px solid var(--primary-color);
  margin-bottom: 16px;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 3px 8px rgba(0,0,0,0.06);
  background-color: white;
  transition: all var(--transition-speed) ease;
}

.admin-stats-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 6px 15px rgba(0,0,0,0.1);
}

.admin-stats-card .card-body {
  padding: 16px;
}

.admin-stats-card h5 {
  font-size: 1rem;
  margin-bottom: 8px;
  color: var(--dark-color);
  font-weight: 600;
}

.admin-stats-card .stat-value {
  font-size: 1.5rem;
  font-weight: 800;
  color: var(--primary-color);
}

.admin-order-card {
  border-radius: 10px;
  margin-bottom: 15px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  overflow: hidden;
  border-left: 4px solid var(--primary-color);
  transition: all 0.3s ease;
}

.admin-order-card:hover {
  box-shadow: 0 6px 15px rgba(0,0,0,0.1);
  transform: translateY(-2px);
}

.admin-order-header {
  background-color: #f8f9fa;
  padding: 15px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #e9ecef;
}

.admin-order-body {
  padding: 20px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
}


.admin-order-item {
  padding: 8px 0;
  border-bottom: 1px dashed #eee;
  font-size: 0.9rem;
  display: flex;
  justify-content: space-between;
}

.admin-order-footer {
  background-color: #f8f9fa;
  padding: 15px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-top: 1px solid #e9ecef;
}

.admin-order-actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.admin-order-total {
  font-weight: 800;
  color: var(--primary-color);
  font-size: 1.1rem;
}

.day-header {
  color: var(--primary-color);
  padding-bottom: 10px;
  border-bottom: 1px solid #eee;
  margin-bottom: 15px;
}

.orders-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 15px;
}

@keyframes pulseHighlight {
  0% { opacity: 0.8; }
  50% { opacity: 1; }
  100% { opacity: 0.8; }
}

/* Status colors */
.status-pending { background-color: #fff3cd; color: #856404; }
.status-preparing { background-color: #ffe8cc; color: #d35400; }
.status-ready { background-color: #d4edda; color: #155724; }
.status-delivered { background-color: #d1ecf1; color: #0c5460; }
.status-cancelled { background-color: #f8d7da; color: #721c24; }

/* Badge de status */
.admin-order-status {
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
  margin-left: 10px;
}

/* Modal de Opções Modernizado */
.options-modal .modal-content {
  border-radius: 14px;
  overflow: hidden;
  border: none;
}

.options-modal .modal-header {
  padding: 16px 20px;
  border-bottom: 1px solid rgba(0,0,0,0.05);
  background-color: var(--primary-color);
  color: white;
}

.options-modal .modal-body {
  max-height: 60vh;
  overflow-y: auto;
  padding: 20px;
}

.options-modal .modal-footer {
  padding: 16px 20px;
  border-top: 1px solid rgba(0,0,0,0.05);
}

.option-group {
  margin-bottom: 16px;
  border-bottom: 1px solid #eee;
  padding-bottom: 12px;
}

.option-group:last-child {
  border-bottom: none;
}

.option-group-title {
  font-weight: 700;
  margin-bottom: 12px;
  color: var(--dark-color);
  font-size: 1rem;
  display: flex;
  align-items: center;
}

.option-group-title:after {
  content: '';
  flex: 1;
  height: 1px;
  background: #eee;
  margin-left: 12px;
}

.option-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
  padding: 6px 10px;
  border-radius: 6px;
  transition: background-color 0.2s;
}

.option-item:hover {
  background-color: #f8f9fa;
}

.option-item label {
  display: flex;
  align-items: center;
  cursor: pointer;
  width: 100%;
  margin: 0;
  font-size: 0.9rem;
}

.option-item input[type="checkbox"],
.option-item input[type="radio"] {
  margin-right: 10px;
  width: 16px;
  height: 16px;
  cursor: pointer;
}

.additional-price {
  color: var(--success-color);
  font-weight: 700;
  margin-left: 6px;
  font-size: 0.8rem;
}

.required-option {
  color: #dc3545;
  font-weight: bold;
  margin-left: 4px;
}

/* Footer Modernizado */
footer {
  background-color: var(--secondary-color) !important;
  color: #333333;
  font-family: 'Poppins', sans-serif;
  padding: 30px 0 15px;
  margin-top: 50px;
}

footer h3 {
  font-weight: 700;
  color: var(--primary-color);
  margin-bottom: 16px;
  font-size: 1.2rem;
}

footer .text-muted {
  color: #5a4a42 !important;
  font-size: 0.85rem;
}

footer hr {
  border-color: var(--primary-color);
  opacity: 0.2;
  margin: 25px 0;
}

footer ul {
  padding-left: 0;
  list-style: none;
}

footer ul li {
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  font-size: 0.9rem;
}

footer ul li i {
  margin-right: 8px;
  width: 18px;
  text-align: center;
  font-size: 0.9rem;
}

/* Botão Admin Access */
.admin-access-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background-color: var(--primary-color);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  z-index: 1000;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  transition: all var(--transition-speed) ease;
  font-size: 1.3rem;
}

.admin-access-btn:hover {
  transform: scale(1.1) translateY(-3px);
  background-color: var(--primary-color);
  box-shadow: 0 8px 20px rgba(0,0,0,0.25);
}

/* Controle de Disponibilidade */
.admin-switch-container {
  background-color: white;
  border-radius: 10px;
  padding: 16px;
  margin-top: 20px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.04);
  border: 1px solid rgba(0,0,0,0.05);
}

.admin-switch-container h4 {
  color: var(--primary-color);
  font-weight: 700;
  margin-bottom: 16px;
  font-size: 1.1rem;
  padding-bottom: 8px;
  border-bottom: 1px solid #eee;
}

.admin-switch-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 0;
  border-bottom: 1px solid #eee;
}

.admin-switch-item:last-child {
  border-bottom: none;
}

.switch-label {
  font-weight: 600;
  color: var(--primary-color);
  font-size: 0.9rem;
}

.switch {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 24px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  transition: .4s;
  border-radius: 24px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: .4s;
  border-radius: 50%;
}

input:checked + .slider {
  background-color: #28a745;
}

input:not(:checked) + .slider {
  background-color: #dc3545;
}

input:checked + .slider:before {
  transform: translateX(26px);
}

/* Produtos Indisponíveis */
.product-card.disabled {
  opacity: 0.6;
  pointer-events: none;
  position: relative;
  filter: grayscale(70%);
}

.product-card.disabled::after {
  content: "INDISPONÍVEL";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: rgba(220, 53, 69, 0.9);
  color: white;
  padding: 6px 12px;
  border-radius: 4px;
  font-weight: bold;
  font-size: 0.9rem;
  z-index: 10;
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* Notificações */
.notification-bell {
  position: relative;
  margin-right: 16px;
  cursor: pointer;
  color: var(--secondary-color);
  font-size: 1.2rem;
  transition: transform var(--transition-speed);
}

.notification-bell:hover {
  transform: scale(1.1);
}

.notification-badge {
  position: absolute;
  top: -4px;
  right: -4px;
  background-color: var(--secondary-color);
  color: var(--primary-color);
  border-radius: 50%;
  width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: bold;
  animation: pulse 1.5s infinite;
}

.new-order-notification {
  position: fixed;
  bottom: 25px;
  right: 25px;
  background-color: var(--primary-color);
  color: var(--secondary-color);
  padding: 14px 20px;
  border-radius: 10px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
  z-index: 1100;
  display: flex;
  align-items: center;
  animation: slideInUp 0.4s, pulse 2s infinite;
  font-weight: 600;
  font-size: 0.9rem;
}

.new-order-notification i {
  margin-right: 10px;
  font-size: 1.3rem;
}

.new-order {
  animation: pulseHighlight 2s ease-in-out;
  border-left: 4px solid var(--secondary-color);
}

/* Animações */
@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

@keyframes slideInUp {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Responsividade Aprimorada */
@media (max-width: 1199px) {
  .product-grid {
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  }
}

/* Layout responsivo */
@media (max-width: 768px) {
  .admin-order-body {
    grid-template-columns: 1fr;
  }
  .orders-grid {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 991px) {
  .admin-panel-container .row {
    flex-direction: column;
  }
  
  .admin-panel-container .col-md-3 {
    margin-bottom: 20px;
  }
  
  .admin-order-actions {
    flex-direction: column;
    gap: 6px;
  }
  
  .admin-order-actions .btn {
    width: 100%;
  }
}

@media (max-width: 767px) {
  .menu-title {
    font-size: 1.8rem;
  }
  .quantity-control {
    flex-direction: row;
  }
  
  .form-check-label {
    font-size: 0.9rem;
  }
  .category-tabs {
    gap: 6px;
    justify-content: flex-start;
  }
  
  .category-tab {
    min-width: 80px;
    padding: 10px 6px;
    font-size: 0.75rem;
  }
  
  .category-tab i {
    font-size: 1rem;
    margin-bottom: 5px;
  }
  
  .product-grid {
    grid-template-columns: 1fr;
    gap: 15px;
  }
  
  .product-image-container {
    height: 160px;
  }
  
  .product-name {
    font-size: 1.05rem;
  }
  
  .product-price {
    font-size: 1.1rem;
  }
  
  .add-to-cart {
    padding: 7px 14px;
    font-size: 0.85rem;
  }
  
  .cart-sidebar {
    max-width: 100%;
  }
  
  .checkout-step {
    padding-bottom: 1rem;
    margin-bottom: 1.5rem;
  }
  
  .delivery-option-card, 
  .payment-method-card {
    padding: 14px;
  }
  
  .admin-order-header,
  .admin-order-footer {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  
  .admin-order-total {
    width: 100%;
  }
  
  .logo-img {
    height: 45px;
    width: 45px;
  }
  
  .logo-text h1 {
    font-size: 1.1rem;
  }
  
  .logo-text p {
    font-size: 0.75rem;
  }
  
  .admin-access-btn {
    width: 45px;
    height: 45px;
    font-size: 1.1rem;
    bottom: 15px;
    right: 15px;
  }
  
  .new-order-notification {
    width: calc(100% - 30px);
    left: 15px;
    right: auto;
  }
}

@media (max-width: 575px) {
  .menu-title {
    font-size: 1.6rem;
    padding-bottom: 6px;
  }
  
  .menu-title:after {
    height: 3px;
    width: 50px;
  }
  
  .category-tab {
    min-width: 70px;
    padding: 8px 5px;
    font-size: 0.7rem;
  }
  
  .category-tab i {
    font-size: 0.9rem;
    margin-bottom: 4px;
  }
  
  .product-content {
    padding: 14px;
  }
  
  .product-description {
    font-size: 0.8rem;
  }
  
  .admin-switch-container {
    padding: 12px;
  }
  
  .switch {
    width: 45px;
    height: 22px;
  }
  
  .slider:before {
    height: 16px;
    width: 16px;
  }
  
  input:checked + .slider:before {
    transform: translateX(23px);
  }

  /* Estilo para os botões de rádio da faturação */
.form-check {
  margin-bottom: 10px;
}

.form-check-input {
  margin-right: 8px;
}

/* Estilo para a seção de faturação */
#nif-field {
  transition: all 0.3s ease;
  margin-top: 15px;
  padding: 15px;
  background-color: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #eee;
}

#nif-field label {
  font-weight: 600;
  color: var(--primary-color);
}

.form-check {
  margin-bottom: 10px;
}

.form-check-label {
  cursor: pointer;
  user-select: none;
}

.form-check-input {
  cursor: pointer;
}

#customer-nif {
  max-width: 200px;
}

/* Adicione na seção de estilos */
#customer-nif:invalid {
  border-color: #ffc107; /* Amarelo para sinalizar incompleto */
}

#customer-nif:valid {
  border-color: #28a745; /* Verde quando válido (com 9 dígitos) */
}
/* Estilo para o campo de endereço durante loading */
input[placeholder="Obtendo sua localização..."] {
  color: #999;
  font-style: italic;
}

/* Ajustes para os campos de entrega */
.delivery-field {
  transition: all 0.3s ease;
  margin-bottom: 15px;
}

/* Estilo para quando o campo está desabilitado */
input:disabled {
  background-color: #f8f9fa;
}
}
  </style>
</head>
<body>
  <!-- Main Navigation -->
  <header class="main-header">
    <div class="container navbar-container">
      <div class="d-flex justify-content-between align-items-center py-1">
        <div id="main-header" class="logo-container">
          <img src="vivi.jpg" alt="Cozinha da Vivi" class="logo-img">
          <div class="logo-text">
            <h1 class="mb-0">Cozinha da Vivi</h1>
            <p class="mb-0">Comida caseira com amor</p>
          </div>
        </div>
        <div class="cart-icon-container cart-visibility-control" id="cart-indicator" style="display: none;">
          <i class="fas fa-shopping-cart cart-icon"></i>
          <span id="cart-count" class="cart-icon-badge" style="display: none;">0</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Cart Overlay -->
  <div class="cart-overlay" id="cart-overlay"></div>

  <!-- Cart Sidebar -->
  <div class="cart-sidebar" id="cart-sidebar">
    <div class="card border-0 h-100">
      <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
        <h2 class="h5 mb-0"><i class="fas fa-shopping-cart me-2"></i> Seu Pedido</h2>
        <button class="btn btn-sm btn-outline-light" id="close-cart">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="card-body p-0 d-flex flex-column">
        <div id="cart-items" class="list-group list-group-flush flex-grow-1">
          <div class="list-group-item text-center py-4 empty-cart">
            <i class="fas fa-shopping-cart empty-cart-icon mb-3"></i>
            <p class="mb-0">Seu carrinho está vazio</p>
            <small class="text-muted">Adicione itens para continuar</small>
          </div>
        </div>
        <div class="p-3 border-top">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <span class="text-muted">Subtotal:</span>
            <span id="subtotal" class="fw-bold">€ 0,00</span>
          </div>
          
          <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="text-muted">Taxa de Entrega:</span>
            <span id="delivery-fee" class="fw-bold">€ 5,00</span>
          </div>
          
          <div class="d-flex justify-content-between align-items-center border-top pt-3">
            <span class="h5 mb-0">Total:</span>
            <span id="total" class="h4 mb-0 text-primary fw-bold">€ 0,00</span>
          </div>
          
          <button id="checkout-button" class="btn btn-primary w-100 mt-3 py-2 fw-bold" disabled>
            <i class="fas fa-check-circle me-2"></i> Finalizar Pedido
          </button>
          
          <p class="small text-muted mt-2 mb-0 text-center">
            <i class="fas fa-lock me-1"></i> Seus dados estão protegidos
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Seção de Produtos Atualizada -->
  <section id="products" class="menu-section">
    <div class="container">
      <div class="menu-header">
        <h2 class="menu-title">O Nosso Menu</h2>
        <div class="category-tabs">
          <div class="category-tab active" data-category="all">
            <i class="fas fa-utensils"></i>
            <span>Todos</span>
          </div>
          <div class="category-tab" data-category="churrasco">
            <i class="fas fa-fire-alt"></i>
            <span>Churrasco</span>
          </div>
          <div class="category-tab" data-category="burguers">
            <i class="fas fa-hamburger"></i>
            <span>Burguers</span>
          </div>
          <div class="category-tab" data-category="combos">
            <i class="fas fa-box-open"></i>
            <span>Combos</span>
          </div>
          <div class="category-tab" data-category="porcoes">
            <i class="fas fa-utensil-spoon"></i>
            <span>Porções</span>
          </div>
          <div class="category-tab" data-category="bebidas">
            <i class="fas fa-glass-whiskey"></i>
            <span>Bebidas</span>
          </div>
          <div class="category-tab" data-category="sobremesas">
            <i class="fas fa-ice-cream"></i>
            <span>Sobremesas</span>
          </div>
        </div>
      </div>

      <div class="product-grid" id="product-container">
        <!-- Churrasco Misto -->
        <div class="product-card" data-id="101" data-category="churrasco" data-has-options="true">
          <div class="product-badge bg-primary">Mais pedido</div>
          <div class="product-image-container">
            <img src="imagens/mistadecarne (2).jpeg" alt="Churrasco Misto" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Churrasco Misto</h3>
            <p class="product-description">Refeição completa com carnes e acompanhamentos selecionados, preparados na brasa com tempero especial.</p>
            <div class="product-footer">
              <span class="product-price">€ 12,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Maminha -->
        <div class="product-card" data-id="102" data-category="churrasco" data-has-options="true">
          <div class="product-image-container">
            <img src="imagens/maminha.jpeg" alt="Maminha" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Maminha</h3>
            <p class="product-description">Maminha suculenta grelhada na brasa, servida com acompanhamentos à escolha.</p>
            <div class="product-footer">
              <span class="product-price">€ 13,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Linguiça Toscana -->
        <div class="product-card" data-id="103" data-category="churrasco" data-has-options="true">
          <div class="product-image-container">
            <img src="imagens/toscana.jpg" alt="Linguiça Toscana" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Linguiça Toscana</h3>
            <p class="product-description">Linguiça toscana artesanal grelhada, acompanhada de farofa e vinagrete.</p>
            <div class="product-footer">
              <span class="product-price">€ 12,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Costelinha de Porco -->
        <div class="product-card" data-id="104" data-category="churrasco" data-has-options="true">
          <div class="product-image-container">
            <img src="imagens/costelinha.jpg" alt="Costelinha de Porco" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Costelinha de Porco</h3>
            <p class="product-description">Costelinha de porco assada lentamente, com molho barbecue caseiro.</p>
            <div class="product-footer">
              <span class="product-price">€ 12,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- X-Salada -->
        <div class="product-card" data-id="201" data-category="burguers">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=500&auto=format&fit=crop" alt="X-Salada" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">X-Salada</h3>
            <p class="product-description">Pão de hambúrguer, bife de hambúrguer, fiambre, queijo, salada, batata palha e milho.</p>
            <div class="product-footer">
              <span class="product-price">€ 6,50</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- X-Bacon -->
        <div class="product-card" data-id="202" data-category="burguers">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=500&auto=format&fit=crop" alt="X-Bacon" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">X-Bacon</h3>
            <p class="product-description">Pão, hambúrguer, bacon, queijo, fiambre, ovo, alface, tomate, milho e batata palha.</p>
            <div class="product-footer">
              <span class="product-price">€ 8,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        
        
        <!-- X-frango -->
        <div class="product-card" data-id="203" data-category="burguers">
          <div class="product-image-container">
            <img src="imagens/xfrango.jpg" alt="X-Frango" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">X-Frango</h3>
            <p class="product-description">Pão, hambúrguer de frango, queijo, fiambre, ovo, alface, tomate, milho e batata palha.</p>
            <div class="product-footer">
              <span class="product-price">€ 8,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>
       
<!-- Combo Frango Supreme -->
<div class="product-card" data-id="301" data-category="combos" data-has-options="true">
  <div class="product-badge bg-success">Combo</div>
  <div class="product-image-container">
    <img src="https://images.unsplash.com/photo-1544025162-d76694265947?w=500&auto=format&fit=crop" alt="Combo Frango Supreme" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Combo Frango Supreme</h3>
    <p class="product-description">Sanduíche de frango com batata frita e bebida. Economize €2,50 em relação à compra separada.</p>
    <div class="product-footer">
      <span class="product-price">€ 10,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Combo X-Tudo -->
<div class="product-card" data-id="302" data-category="combos" data-has-options="true">
  <div class="product-badge bg-success">Combo</div>
  <div class="product-image-container">
    <img src="imagens/combo xtudo.jpeg" alt="Combo X-Tudo" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Combo X-Tudo</h3>
    <p class="product-description">Sanduíche completo com batata frita e bebida. Economize €3,00 em relação à compra separada.</p>
    <div class="product-footer">
      <span class="product-price">€ 12,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

        <!-- Porção de Arroz -->
        <div class="product-card" data-id="401" data-category="porcoes">
          <div class="product-image-container">
            <img src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=500&auto=format&fit=crop" alt="Porção de Arroz" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Porção de Arroz</h3>
            <p class="product-description">Porção de arroz branco soltinho, ideal para acompanhar seus pratos favoritos.</p>
            <div class="product-footer">
              <span class="product-price">€ 3,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Porção de Queijo Coalho -->
<div class="product-card" data-id="402" data-category="porcoes">
  <div class="product-image-container">
    <img src="imagens/queijo.jpeg" alt="Queijo Coalho" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Queijo Coalho</h3>
    <p class="product-description">Queijo coalho grelhado, tradicional do nordeste brasileiro, perfeito para acompanhar molhos.</p>
    <div class="product-footer">
      <span class="product-price">€ 6,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Torresmo -->
<div class="product-card" data-id="403" data-category="porcoes">
  <div class="product-image-container">
    <img src="imagens/torresmo.jpeg" alt="Torresmo" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Torresmo</h3>
    <p class="product-description">Torresmo brasileiro: crocante e delicioso, feito com pedaços de carne de porco, ideal para acompanhar uma cerveja gelada.</p>
    <div class="product-footer">
      <span class="product-price">€ 6,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Porção de Mandioca -->
<div class="product-card" data-id="404" data-category="porcoes">
  <div class="product-image-container">
    <img src="imagens/madioca.jpg" alt="Mandioca" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Porção de Mandioca</h3>
    <p class="product-description">Mandioca frita crocante por fora e macia por dentro, acompanha molho à escolha.</p>
    <div class="product-footer">
      <span class="product-price">€ 6,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Porção de Batata Frita -->
<div class="product-card" data-id="405" data-category="porcoes">
  <div class="product-image-container">
    <img src="imagens/batatafrita.jpg" alt="Batata Frita" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Porção de Batata Frita</h3>
    <p class="product-description">Batata frita crocante temperada com sal e ervas finas, acompanha molho à escolha.</p>
    <div class="product-footer">
      <span class="product-price">€ 3,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Porção de Carnes -->
<div class="product-card" data-id="406" data-category="porcoes" data-has-options="true">
  <div class="product-image-container">
    <img src="imagens/carnes.jpg" alt="Porção de Carnes" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Porção de Carnes</h3>
    <p class="product-description">Selecione suas carnes preferidas para montar sua porção especial.</p>
    <div class="product-footer">
      <span class="product-price">€ 10,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Coca-Cola (lata) - Atualizado com todas as opções -->
<div class="product-card" data-id="5021" data-category="bebidas" data-has-options="true">
  <div class="product-image-container">
    <img src="imagens/refrigerantes.jpg" alt="Bebidas" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Refrigerantes e Águas</h3>
    <p class="product-description">Selecione seu refrigerante preferido. Todos em lata 350ml, geladinhos.</p>
    <div class="product-footer">
      <span class="product-price">€ 2,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

  <!-- Açai Pequeno -->
<div class="product-card" data-id="601" data-category="sobremesas" data-has-options="true">
  <div class="product-image-container">
    <img src="imagens/Açai.png" alt="Açai Pequeno" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Açai Pequeno</h3>
    <p class="product-description">Açai cremoso com acompanhamentos à escolha. Tamanho pequeno (300ml).</p>
    <div class="product-footer">
      <span class="product-price">€ 6,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

<!-- Açai Grande -->
<div class="product-card" data-id="602" data-category="sobremesas" data-has-options="true">
  <div class="product-image-container">
    <img src="imagens/Açai.png" alt="Açai Grande" class="product-image">
  </div>
  <div class="product-content">
    <h3 class="product-name">Açai Grande</h3>
    <p class="product-description">Açai cremoso com acompanhamentos à escolha. Tamanho grande (500ml).</p>
    <div class="product-footer">
      <span class="product-price">€ 10,00</span>
      <button class="add-to-cart">
        <i class="fas fa-plus"></i> Adicionar
      </button>
    </div>
  </div>
</div>

        <!-- Pudim Caseiro -->
        <div class="product-card" data-id="603" data-category="sobremesas">
          <div class="product-image-container">
            <img src="imagens/pudim.jpeg" alt="Pudim Caseiro" class="product-image">
          </div>
          <div class="product-content">
            <h3 class="product-name">Pudim Caseiro</h3>
            <p class="product-description">Pudim tradicional caseiro com calda de caramelo. Feito com ingredientes selecionados.</p>
            <div class="product-footer">
              <span class="product-price">€ 3,00</span>
              <button class="add-to-cart">
                <i class="fas fa-plus"></i> Adicionar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

    <!-- Checkout Section (Hidden by default) -->
    <section id="checkout-section" class="container my-4 d-none">
      <div class="checkout-container">
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <div class="card border-0 shadow-sm mb-4">
              <div class="card-header bg-primary text-white">
                <h2 class="h5 mb-0"><i class="fas fa-shopping-cart me-2"></i> Finalizar Pedido</h2>
              </div>
              <div class="card-body">
                <div class="checkout-step">
                  <h3 class="h5 mb-3">1. Método de Recebimento</h3>
                  <div class="row g-3">
                    <div class="col-md-6">
                      <div class="card delivery-option-card p-3 active" id="delivery-option">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="delivery-method" id="delivery-method" value="entrega" checked>
                          <label class="form-check-label fw-bold" for="delivery-method">
                            <i class="fas fa-motorcycle me-2"></i> Entrega
                          </label>
                        </div>
                        <p class="small text-muted mt-2">Entregamos no seu endereço (Taxa: € 2,00)</p>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="card delivery-option-card p-3" id="pickup-option">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="delivery-method" id="pickup-method" value="retirada">
                          <label class="form-check-label fw-bold" for="pickup-method">
                            <i class="fas fa-store me-2"></i> Retirada
                          </label>
                        </div>
                        <p class="small text-muted mt-2">Retire seu pedido no restaurante</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="checkout-step">
                  <h3 class="h5 mb-3">2. Informações do Cliente</h3>
                  <form id="customer-info-form">
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label for="customer-name" class="form-label">Nome Completo *</label>
                        <input type="text" class="form-control" id="customer-name" required>
                      </div>
                      <div class="col-md-6">
                        <label for="customer-phone" class="form-label">Telefone *</label>
                        <input type="tel" class="form-control" id="customer-phone" required placeholder="Ex: +351 933 737 672">
                      </div>
                      <div class="col-12 delivery-field">
                        <label for="customer-address" class="form-label">Endereço *</label>
                        <input type="text" class="form-control" id="customer-address" placeholder="Rua, Número">
                      </div>
                      <div class="col-md-12 delivery-field">
                        <label for="customer-complement" class="form-label">Complemento</label>
                        <input type="text" class="form-control" id="customer-complement" placeholder="Apto, Bloco, Referência">
                      </div>
                      <div class="col-12">
                        <label for="customer-instructions" class="form-label">Instruções para entrega/pedido</label>
                        <textarea class="form-control" id="customer-instructions" rows="2" placeholder="Ex: Portão azul, tocar campainha ou Sem cebola, bem passado"></textarea>
                      </div>

                    </div>
                  </form>
                </div>
                <div class="checkout-step">
                  <h3 class="h5 mb-3">3. Faturação</h3>
                  <div class="mb-3">
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="fatura" id="fatura-nao" value="nao" checked>
                      <label class="form-check-label" for="fatura-nao">
                        Não necessito de fatura com NIF
                      </label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="fatura" id="fatura-sim" value="sim">
                      <label class="form-check-label" for="fatura-sim">
                        Sim, quero fatura com NIF
                      </label>
                    </div>
                  </div>
                  <div class="mb-3 d-none" id="nif-field">
                    <label for="customer-nif" class="form-label">Número de Contribuinte (NIF)</label>
                    <input type="text" class="form-control" id="customer-nif" placeholder="Digite seu NIF">
                  </div>
                </div>
                <div class="mb-3 d-none" id="nif-field">
                  <label for="customer-nif" class="form-label">Número de Contribuinte (NIF)</label>
                  <input type="text" 
                         class="form-control" 
                         id="customer-nif" 
                         placeholder="Digite seu NIF (9 dígitos)" 
                         maxlength="9"
                         pattern="\d{9}"
                         title="Por favor, insira exatamente 9 dígitos">
                  <small class="text-muted">Pressione Enter após digitar para confirmar</small>
              </div>

                <div class="checkout-step">
                  <h3 class="h5 mb-3">3. Método de Pagamento</h3>
                  <div class="row g-3">
                    <div class="col-md-6">
                      <div class="card payment-method-card p-3 active" id="mbway-payment">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="payment-method" id="mbway-method" value="mbway" checked>
                          <label class="form-check-label payment-method-label" for="mbway-method">
                            <i class="fas fa-mobile-alt payment-icon mbway-icon"></i> MB Way
                          </label>
                        </div>
                        <p class="small text-muted mt-2">Você receberá uma solicitação de pagamento via MB Way</p>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="card payment-method-card p-3" id="cash-payment">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="payment-method" id="cash-method" value="dinheiro">
                          <label class="form-check-label payment-method-label" for="cash-method">
                            <i class="fas fa-money-bill-wave payment-icon"></i> Dinheiro
                          </label>
                        </div>
                        <div id="cash-change-field" class="mt-2 d-none">
                          <label for="cash-change" class="form-label small">Valor para troco</label>
                          <input type="text" class="form-control form-control-sm" id="cash-change" placeholder="Ex: 50,00">
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="card payment-method-card p-3" id="card-payment">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="payment-method" id="card-method" value="cartao">
                          <label class="form-check-label payment-method-label" for="card-method">
                            <i class="fas fa-credit-card payment-icon"></i> Cartão
                          </label>
                        </div>
                        <p class="small text-muted mt-2">Pagamento com máquina na entrega/retirada</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="checkout-step">
                  <h3 class="h5 mb-3">4. Resumo do Pedido</h3>
                  <div class="card border-0 shadow-sm">
                    <div class="card-body p-0">
                      <div id="checkout-items" class="list-group list-group-flush">
                        <!-- Itens serão adicionados dinamicamente aqui -->
                      </div>
                      <div class="p-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                          <span class="text-muted">Subtotal:</span>
                          <span id="checkout-subtotal" class="fw-bold">€ 0,00</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                          <span class="text-muted">Taxa de Entrega:</span>
                          <span id="checkout-delivery-fee" class="fw-bold">€ 5,00</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center border-top pt-3">
                          <span class="h5 mb-0">Total:</span>
                          <span id="checkout-total" class="h4 mb-0 text-primary fw-bold">€ 0,00</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="d-grid gap-2">
                  <button id="confirm-order-button" class="btn btn-primary btn-lg py-3">
                    <i class="fas fa-check-circle me-2"></i> Confirmar Pedido
                  </button>
                  <button id="back-to-cart-button" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-2"></i> Voltar para o Carrinho
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Admin Panel (Hidden by default) -->
    <section id="admin-panel" class="container-fluid px-0 d-none">
      <nav class="navbar navbar-dark admin-navbar">
        <div class="container">
          <a class="navbar-brand" href="#">
            <i class="fas fa-utensils me-2"></i> Painel Administrativo
          </a>
          <div class="d-flex align-items-center">
            <div class="notification-bell" id="notification-bell">
              <i class="fas fa-bell"></i>
              <span class="notification-badge d-none" id="notification-badge">0</span>
            </div>
            <button id="admin-logout" class="btn btn-outline-light btn-sm">
              <i class="fas fa-sign-out-alt me-1"></i> Sair
            </button>
          </div>
        </div>
      </nav>
    
      <div class="container admin-panel-container my-4">
        <div class="row">
          <div class="col-md-3">
            <div class="admin-stats-container">
              <div class="card admin-stats-card">
                <div class="card-body">
                  <h5 class="card-title">Pedidos Hoje</h5>
                  <div class="stat-value text-primary" id="today-orders">0</div>
                </div>
              </div>
              
              <div class="card admin-stats-card">
                <div class="card-body">
                  <h5 class="card-title">Em Preparo</h5>
                  <div class="stat-value text-warning" id="preparing-orders">0</div>
                </div>
              </div>
              
              <div class="card admin-stats-card">
                <div class="card-body">
                  <h5 class="card-title">Para Entregar</h5>
                  <div class="stat-value text-info" id="delivery-orders">0</div>
                </div>
              </div>
            </div>
    
            <div class="card admin-card">
              <div class="card-body">
                <h3 class="h5 card-title">Filtros</h3>
                <div class="mb-3">
                  <label class="form-label">Status</label>
                  <select class="form-select admin-filter-dropdown" id="status-filter">
                    <option value="all">Todos</option>
                    <option value="pending">Pendentes</option>
                    <option value="preparing">Em Preparo</option>
                    <option value="ready">Prontos</option>
                    <option value="delivered">Entregues</option>
                    <option value="cancelled">Cancelados</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label class="form-label">Tipo</label>
                  <select class="form-select admin-filter-dropdown" id="type-filter">
                    <option value="all">Todos</option>
                    <option value="delivery">Entrega</option>
                    <option value="pickup">Retirada</option>
                  </select>
                </div>
                <button id="apply-filters" class="btn btn-primary w-100 admin-btn">
                  <i class="fas fa-filter me-1"></i> Aplicar
                </button>
              </div>
            </div>
          </div>
    
          <div class="col-md-9">
            <div class="card admin-card">
              <div class="card-header bg-white">
                <div class="d-flex justify-content-between align-items-center">
                  <h3 class="h5 mb-0">Pedidos Recentes</h3>
                  <div class="small text-muted" id="last-update">
                    Atualizado: agora
                  </div>
                </div>
              </div>
              <div class="card-body p-0">
                <div id="day-tabs" class="day-tabs"></div>
                <div class="admin-orders-container" id="orders-accordion">
                  <!-- Pedidos serão agrupados por data aqui -->
                  <div class="list-group-item text-center py-5">
                    <i class="fas fa-clipboard-list fa-3x text-muted mb-3"></i>
                    <p class="mb-0">Nenhum pedido encontrado</p>
                  </div>
                </div>
              </div>
            </div>
    
 <!-- Adicionando a seção de controle de disponibilidade de produtos -->
  <!-- Adicionando a seção de controle de disponibilidade de produtos -->
  <div class="admin-switch-container">
    <h4 class="mb-3">Controle de Disponibilidade</h4>
    
    <div class="admin-switch-item">
      <span class="switch-label">Torresmo</span>
      <label class="switch">
        <input type="checkbox" id="403-switch" checked>
        <span class="slider"></span>
      </label>
    </div>
    
    <div class="admin-switch-item">
      <span class="switch-label">Mandioca Frita</span>
      <label class="switch">
        <input type="checkbox" id="404-switch" checked>
        <span class="slider"></span>
      </label>
    </div>
    
    <div class="admin-switch-item">
      <span class="switch-label">Mandioca Cozida</span>
      <label class="switch">
        <input type="checkbox" id="mandioca-cozida-switch" checked>
        <span class="slider"></span>
      </label>
    </div>
    
    <div class="admin-switch-item">
      <span class="switch-label">Açaí Grande</span>
      <label class="switch">
        <input type="checkbox" id="602-switch" checked>
        <span class="slider"></span>
      </label>
    </div>
    
    <div class="admin-switch-item">
      <span class="switch-label">Açaí Pequeno</span>
      <label class="switch">
        <input type="checkbox" id="601-switch" checked>
        <span class="slider"></span>
      </label>
    </div>
  </div>

    </section>
     </main>

  <!-- Modal de Confirmação -->
  <div class="modal fade" id="confirmationModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">Pedido Confirmado!</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center py-4">
          <i class="fas fa-check-circle text-success mb-3" style="font-size: 3rem;"></i>
          <h4 class="mb-3">Seu pedido foi recebido!</h4>
          <p class="mb-4">Agora vamos preparar seu pedido com todo cuidado. Você será redirecionado para o WhatsApp para confirmar os detalhes.</p>
          <div class="d-flex justify-content-center">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Carregando...</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Login Admin -->
<div class="modal fade" id="adminLoginModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Acesso Administrativo</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="admin-login-form">
          <div class="mb-3">
            <label for="admin-username" class="form-label">Usuário</label>
            <input type="text" class="form-control" id="admin-username" required>
          </div>
          <div class="mb-3">
            <label for="admin-password" class="form-label">Senha</label>
            <input type="password" class="form-control" id="admin-password" required>
          </div>
          <button type="submit" class="btn btn-primary w-100">
            <i class="fas fa-sign-in-alt me-1"></i> Entrar
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

  <!-- Modal para Visualizar Pedido da Cozinha -->
  <div class="modal fade" id="kitchenOrderModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">Pedido para Cozinha</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="kitchen-order-content">
          <!-- Conteúdo do pedido será inserido aqui -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
          <button type="button" class="btn btn-primary" id="print-kitchen-order">
            <i class="fas fa-print me-1"></i> Imprimir
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Opções do Produto -->
  <div class="modal fade options-modal" id="productOptionsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="productOptionsModalTitle">Opções do Produto</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="product-options-content">
          <!-- Conteúdo das opções será inserido aqui -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" id="confirm-product-options">
            <i class="fas fa-check me-1"></i> Confirmar
          </button>
        </div>
      </div>
    </div>
  </div>

  <footer style="background-color: #ffb501; color: #333333;" class="py-4">
    <div class="container">
      <div class="row">
        <div class="col-md-4 mb-4 mb-md-0">
          <h3 class="h5"><span class="text-primary">Cozinha</span> da Vivi</h3>
          <p class="small text-muted">Comida caseira feita com ingredientes frescos e muito amor.</p>
        </div>
        <div class="col-md-4 mb-4 mb-md-0">
          <h3 class="h5">Horário de Funcionamento</h3>
          <ul class="list-unstyled small text-muted">
            <li>Segunda a Sexta: 11h às 22h</li>
            <li>Sábado: 11h às 23h</li>
            <li>Domingo: 11h às 17h</li>
          </ul>
        </div>
        <div class="col-md-4">
          <h3 class="h5">Contato</h3>
          <ul class="list-unstyled small text-muted">
            <li><i class="fas fa-phone-alt me-2"></i> (31) 3333-4444</li>
            <li><i class="fas fa-map-marker-alt me-2"></i> Rua das Flores, 123 - Centro</li>
            <li><i class="fab fa-whatsapp me-2"></i> (31) 93373-7672</li>
          </ul>
        </div>
      </div>
      <hr class="my-4 bg-secondary">
      <div class="text-center small text-muted">
        <p class="mb-0">&copy; 2025 Cozinha da Vivi - Todos os direitos reservados</p>
      </div>
    </div>
  </footer>

  <!-- Botão de acesso admin (oculto para usuários comuns) -->
  <div class="admin-access-btn" id="admin-access-btn">
    <i class="fas fa-lock"></i>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  
  <script>
    // Configurações do Firebase (com suas credenciais)
    const firebaseConfig = {
      apiKey: "AIzaSyCV809Fi4JTLZclARfU4MtNSAVkJIrGcfk",
      authDomain: "cozinha-da-vivi-83d09.firebaseapp.com",
      projectId: "cozinha-da-vivi-83d09",
      storageBucket: "cozinha-da-vivi-83d09.appspot.com",
      messagingSenderId: "740046409209",
      appId: "1:740046409209:web:f8cff12dc530e22fba4128",
      databaseURL: "https://cozinha-da-vivi-83d09-default-rtdb.europe-west1.firebasedatabase.app"
    };

    // Inicializa o Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // Configurações do aplicativo
    const APP_CONFIG = {
      whatsappNumber: "351933737672",
      deliveryFee: 2.00,
      restaurantName: "Cozinha da Vivi",
      restaurantAddress: "Rua das Flores, 123 - Centro",
      adminCredentials: {
        username: "admin",
        password: "2320"
      }
    };

    // Estado do aplicativo
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let orders = [];
    let isAdminLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
    let lastOrderCount = 0;
    let pendingOrdersCount = 0;
    let currentProductOptions = null;
    let newOrders = []; // Para rastrear novos pedidos
    let lastNotificationTime = 0;

    // Elementos do DOM
    const DOM = {
  // Seções principais
  productSection: document.getElementById("products") || document.getElementById("product-section"),
  checkoutSection: document.getElementById("checkout-section"),
  adminPanel: document.getElementById("admin-panel"),
  
  // Elementos do carrinho
  cartItems: document.getElementById("cart-items"),
  totalElement: document.getElementById("total"),
  subtotalElement: document.getElementById("subtotal"),
  checkoutButton: document.getElementById("checkout-button"),
  cartCount: document.getElementById("cart-count"),
  cartIndicator: document.getElementById("cart-indicator"),
  cartSidebar: document.getElementById("cart-sidebar"),
  cartOverlay: document.getElementById("cart-overlay"),
  closeCart: document.getElementById("close-cart"),
  
  // Produtos
  productContainer: document.getElementById("product-container"),
  
  // Modais (com verificação de existência)
  confirmationModal: document.getElementById("confirmationModal") ? 
    new bootstrap.Modal(document.getElementById("confirmationModal")) : null,
  adminLoginModal: document.getElementById("adminLoginModal") ? 
    new bootstrap.Modal(document.getElementById("adminLoginModal")) : null,
  kitchenOrderModal: document.getElementById("kitchenOrderModal") ? 
    new bootstrap.Modal(document.getElementById("kitchenOrderModal")) : null,
  productOptionsModal: document.getElementById("productOptionsModal") ? 
    new bootstrap.Modal(document.getElementById("productOptionsModal")) : null,
  
  // Admin
  adminAccessBtn: document.getElementById("admin-access-btn"),
  adminLogoutButton: document.getElementById("admin-logout"),
  ordersList: document.getElementById("orders-accordion"),
  todayOrders: document.getElementById("today-orders"),
  preparingOrders: document.getElementById("preparing-orders"),
  deliveryOrders: document.getElementById("delivery-orders"),
  statusFilter: document.getElementById("status-filter"),
  typeFilter: document.getElementById("type-filter"),
  applyFilters: document.getElementById("apply-filters"),
  
  // Checkout
  backToCartButton: document.getElementById("back-to-cart-button"),
  confirmOrderButton: document.getElementById("confirm-order-button"),
  checkoutItems: document.getElementById("checkout-items"),
  checkoutSubtotal: document.getElementById("checkout-subtotal"),
  checkoutDeliveryFee: document.getElementById("checkout-delivery-fee"),
  checkoutTotal: document.getElementById("checkout-total"),
  deliveryOptionCards: document.querySelectorAll('.delivery-option-card'),
  paymentMethodCards: document.querySelectorAll('.payment-method-card'),
  deliveryFields: document.querySelectorAll('.delivery-field'),
  customerInfoForm: document.getElementById("customer-info-form"),
  cashChangeField: document.getElementById("cash-change-field"),
  
  // Cozinha/Impressão
  kitchenOrderContent: document.getElementById("kitchen-order-content"),
  printKitchenOrder: document.getElementById("print-kitchen-order"),
  
  // Outros
  lastUpdate: document.getElementById("last-update"),
  notificationBell: document.getElementById("notification-bell"),
  notificationBadge: document.getElementById("notification-badge"),
  dayTabs: document.getElementById("day-tabs"),
  productOptionsContent: document.getElementById("product-options-content"),
  productOptionsModalTitle: document.getElementById("productOptionsModalTitle"),
  confirmProductOptions: document.getElementById("confirm-product-options"),
  mainHeader: document.getElementById("main-header"),
  logoHome: document.getElementById("logo-home"),
  
  // Verificação adicional para elementos críticos
  isInitialized: function() {
    return !!(
      this.productSection && 
      this.checkoutSection && 
      this.checkoutButton && 
      this.adminAccessBtn
    );
  }
};
// Função para atualizar a disponibilidade dos produtos
function updateProductAvailability() {
  // Lista de produtos que podem ser desativados
  const productSwitches = {
    '403': 'torresmo',       // Torresmo
    '404': 'mandioca-frita', // Mandioca Frita
    'mandioca-cozida': 'mandioca-cozida', // Mandioca Cozida
    '602': 'acai-grande',    // Açaí Grande
    '601': 'acai-pequeno'    // Açaí Pequeno
  };

  // Configura os switches e eventos
  Object.entries(productSwitches).forEach(([productId, productName]) => {
    const switchId = `${productId}-switch`;
    const switchElement = document.getElementById(switchId);
    
    if (switchElement) {
      // Carrega estado salvo ou define padrão como true (disponível)
      const savedState = localStorage.getItem(`product_${productId}_available`);
      const isAvailable = savedState ? savedState === 'true' : true;
      
      switchElement.checked = isAvailable;
      updateSwitchStyle(switchElement, isAvailable);
      updateProductDisplay(productId, isAvailable);

      switchElement.addEventListener('input', function() {
        const isChecked = this.checked;
        localStorage.setItem(`product_${productId}_available`, isChecked);
        updateSwitchStyle(this, isChecked);
        updateProductDisplay(productId, isChecked);
        
        // Se for mandioca, atualiza os churrascos
        if (productId === 'mandioca-cozida' || productId === '404') {
          updateMandiocaOptions();
        }
      });

    }
  });
}

// Atualiza o estilo visual do switch
function updateSwitchStyle(switchElement, isChecked) {
  const slider = switchElement.nextElementSibling;
  if (slider && slider.classList.contains('slider')) {
    if (isChecked) {
      slider.style.backgroundColor = '#28a745'; // Verde
    } else {
      slider.style.backgroundColor = '#dc3545'; // Vermelho
    }
  }
}

// Atualiza a exibição do produto
function updateProductDisplay(productId, isAvailable) {
  const productElement = document.querySelector(`.product-card[data-id="${productId}"]`);
  if (productElement) {
    if (isAvailable) {
      productElement.classList.remove('disabled');
      productElement.style.display = 'block';
    } else {
      productElement.classList.add('disabled');
      productElement.style.display = 'block'; // Mantém visível mas desativado
    }
  }
}
// Atualiza as opções de mandioca nos produtos de churrasco
function updateMandiocaOptions() {
  const mandiocaCozidaAvailable = localStorage.getItem('product_mandioca-cozida_available') !== 'false';
  const mandiocaFritaAvailable = localStorage.getItem('product_404_available') !== 'false';

  // Atualiza todos os produtos de churrasco (IDs 101-104)
  for (let i = 101; i <= 104; i++) {
    const productCard = document.querySelector(`.product-card[data-id="${i}"]`);
    if (!productCard) continue;

    // Quando o modal de opções for aberto, as opções serão atualizadas
  }
}

    // Funções do Firebase
    const FirebaseService = {
      saveOrder: async (order) => {
        try {
          const newOrderRef = database.ref('orders').push();
          await newOrderRef.set(order);
          return { ...order, id: newOrderRef.key };
        } catch (error) {
          console.error("Erro ao salvar pedido:", error);
          return null;
        }
      },

      listenForOrders: (callback) => {
        database.ref('orders').on('value', (snapshot) => {
          const ordersData = snapshot.val();
          const ordersArray = ordersData ? Object.keys(ordersData).map(key => ({
            id: key,
            ...ordersData[key]
          })) : [];
          callback(ordersArray);
        });
      },

      updateOrderStatus: async (orderId, newStatus) => {
        try {
          await database.ref(`orders/${orderId}/status`).set(newStatus);
          return true;
        } catch (error) {
          console.error("Erro ao atualizar status:", error);
          return false;
        }
      }
    };

    // Funções utilitárias
    const Utils = {
      formatCurrency: (value) => {
        return value.toLocaleString('pt-PT', { style: 'currency', currency: 'EUR' });
      },
      parsePrice: (priceString) => {
        return parseFloat(priceString.replace("€", "").replace(",", ".").trim());
      },
      animateElement: (element, animation) => {
        element.classList.add("animate__animated", `animate__${animation}`);
        setTimeout(() => {
          element.classList.remove("animate__animated", `animate__${animation}`);
        }, 1000);
      },
      showNotification: (message, type = 'success') => {
        const notification = document.createElement('div');
        notification.className = `position-fixed bottom-0 end-0 m-3 alert alert-${type} alert-dismissible fade show`;
        notification.style.zIndex = '1100';
        notification.innerHTML = `
          ${message}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.classList.remove('show');
          setTimeout(() => notification.remove(), 150);
        }, 3000);
      },
      validatePhone: (phone) => {
        // Aceita qualquer formato internacional de telefone
        return /^\+?[\d\s-]{10,15}$/.test(phone);
      },
      getTodayDate: () => {
        const today = new Date();
        return `${today.getDate()}/${today.getMonth() + 1}/${today.getFullYear()}`;
      },
      updateTimestamp: () => {
        const now = new Date();
        DOM.lastUpdate.textContent = `Atualizado: ${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
      },
      getDayName: (dayIndex) => {
        const days = ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado'];
        return days[dayIndex];
      },
      formatDate: (dateString) => {
        const date = new Date(dateString);
        return date.toLocaleDateString('pt-BR');
      },
      showNewOrderNotification: (count) => {
        const notification = document.createElement('div');
        notification.className = 'new-order-notification';
        notification.innerHTML = `
          <i class="fas fa-bell"></i>
          <span>${count} novo${count > 1 ? 's' : ''} pedido${count > 1 ? 's' : ''} recebido${count > 1 ? 's' : ''}!</span>
        `;
        
        document.body.appendChild(notification);
        
        // Remove a notificação após 5 segundos
        setTimeout(() => {
          notification.style.opacity = '0';
          setTimeout(() => notification.remove(), 300);
        }, 5000);
      }
    };

    // Funções do Carrinho
    const Cart = {
      updateStorage: () => {
        localStorage.setItem('cart', JSON.stringify(cart));
      },

      addItem: (id, name, price, image = '', options = {}) => {
  const existingItem = cart.find(item => item.id === id && JSON.stringify(item.options) === JSON.stringify(options));
  
  if (existingItem) {
    existingItem.quantity += 1;
  } else {
    cart.push({ id, name, price, quantity: 1, image, options });
  }
  
  Cart.updateStorage();
  Cart.updateUI();
  
  const productElement = document.querySelector(`.product-card[data-id="${id}"]`);
  if (productElement) {
    Utils.animateElement(productElement, 'pulse');
    
    // Muda o botão para "Adicionado" e cor verde
    const addButton = productElement.querySelector('.add-to-cart');
    if (addButton) {
      addButton.innerHTML = '<i class="fas fa-check me-1"></i> Adicionado';
      addButton.classList.add('added');
      addButton.style.backgroundColor = '#617c33';
      
      // Retorna ao estado original após 2 segundos
      setTimeout(() => {
        addButton.innerHTML = '<i class="fas fa-plus me-1"></i> Adicionar';
        addButton.classList.remove('added');
        addButton.style.backgroundColor = '';
      }, 2000);
    }
  }
},

      updateItemQuantity: (id, newQuantity) => {
        const item = cart.find(item => item.id === id);
        if (item) {
          if (newQuantity <= 0) {
            Cart.removeItem(id);
          } else {
            item.quantity = newQuantity;
            Cart.updateStorage();
            Cart.updateUI();
          }
        }
      },

      removeItem: (id) => {
        const item = cart.find(item => item.id === id);
        if (item) {
          cart = cart.filter(item => item.id !== id);
          Cart.updateStorage();
          Cart.updateUI();
        }
      },

      clear: () => {
        cart = [];
        Cart.updateStorage();
        Cart.updateUI();
      },

          getTotals: () => {
      const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      
      // Verifica se o método de entrega está selecionado como 'entrega'
      const isDelivery = document.getElementById('delivery-method')?.checked || false;
      const deliveryFee = isDelivery ? APP_CONFIG.deliveryFee : 0;
      
      const total = subtotal + deliveryFee;
      
      return { subtotal, deliveryFee, total };
      },

      updateUI: () => {
        DOM.cartItems.innerHTML = "";
        
        const { subtotal, deliveryFee, total } = Cart.getTotals();
        const itemCount = cart.reduce((count, item) => count + item.quantity, 0);

        if (cart.length === 0) {
          DOM.cartItems.innerHTML = `
            <div class="list-group-item text-center py-4 empty-cart">
              <i class="fas fa-shopping-cart empty-cart-icon mb-3"></i>
              <p class="mb-0">Seu carrinho está vazio</p>
              <small class="text-muted">Adicione itens para continuar</small>
            </div>
          `;
        } else {
          cart.forEach(item => {
            const li = document.createElement("div");
            li.className = "list-group-item";
            
            let optionsText = '';
            if (item.options && Object.keys(item.options).length > 0) {
              optionsText = Object.values(item.options).map(opt => opt.join(', ')).join(' | ');
            }
            
            li.innerHTML = `
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="mb-1">${item.name}</h6>
                  ${optionsText ? `<small class="text-muted">${optionsText}</small>` : ''}
                  <small class="d-block text-muted">${Utils.formatCurrency(item.price)}</small>
                </div>
                <div class="d-flex align-items-center gap-2">
                  <div class="cart-item-quantity">
                    <button class="quantity-btn decrease" data-id="${item.id}">
                      <i class="fas fa-minus"></i>
                    </button>
                    <span class="quantity mx-1">${item.quantity}</span>
                    <button class="quantity-btn increase" data-id="${item.id}">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <span class="fw-bold ms-2">${Utils.formatCurrency(item.price * item.quantity)}</span>
                  <button class="remove-item btn btn-sm btn-outline-danger ms-2" data-id="${item.id}">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </div>
            `;
            DOM.cartItems.appendChild(li);
          });
        }

        DOM.subtotalElement.textContent = Utils.formatCurrency(subtotal);
        document.getElementById("delivery-fee").textContent = Utils.formatCurrency(deliveryFee);
        DOM.totalElement.textContent = Utils.formatCurrency(total);
        
        DOM.cartCount.textContent = itemCount;
        DOM.cartCount.style.display = itemCount > 0 ? "flex" : "none";
        DOM.cartIndicator.style.display = "flex";
        
        DOM.checkoutButton.disabled = cart.length === 0;
      },
      
      toggleSidebar: () => {
        if (cart.length === 0) {
          DOM.cartSidebar.classList.remove('show');
          DOM.cartOverlay.classList.remove('show');
          return;
        }
        
        if (DOM.cartSidebar.classList.contains('show')) {
          DOM.cartSidebar.classList.remove('show');
          DOM.cartOverlay.classList.remove('show');
        } else {
          DOM.cartSidebar.classList.add('show');
          DOM.cartOverlay.classList.add('show');
        }
      }
    };

    // Funções de Pedido
    const Order = {
      create: () => {
        console.log("Valor do NIF:", document.getElementById('customer-nif').value);
        console.log("Checkbox marcado?", document.getElementById('fatura-sim').checked);
        const { subtotal, deliveryFee, total } = Cart.getTotals();
        const deliveryType = document.querySelector('input[name="delivery-method"]:checked').value;
        const paymentMethod = document.querySelector('input[name="payment-method"]:checked')?.value || 'mbway';
            // Captura do NIF
          const wantsInvoice = document.getElementById('fatura-sim')?.checked;
          const nifValue = wantsInvoice ? document.getElementById('customer-nif').value.trim() : null;

          if (wantsInvoice && (!nifValue || nifValue.length !== 9)) {
              Utils.showNotification("Por favor, insira um NIF válido de 9 dígitos", "danger");
              throw new Error("NIF inválido");
          }
              
        const customerInfo = {
          name: document.getElementById("customer-name").value,
          phone: document.getElementById("customer-phone").value,
          whatsapp: document.getElementById("customer-phone").value,
          address: document.getElementById("customer-address").value,
          complement: document.getElementById("customer-complement").value,
          instructions: document.getElementById("customer-instructions").value
        };
        
        return {
          cliente: customerInfo.name,
          telefone: customerInfo.phone,
          whatsapp: customerInfo.whatsapp,
          nif: nifValue || null,  
          itens: cart.map(item => ({
            nome: item.name,
            quantidade: item.quantity,
            preco: item.price,
            opcoes: item.options || {}
          })),
          subtotal,
          taxaEntrega: deliveryFee,
          total,
          status: 'pending',
          tipoEntrega: deliveryType,
          metodoPagamento: paymentMethod,
          trocoPara: paymentMethod === 'dinheiro' ? document.getElementById("cash-change").value || '0' : null,
          endereco: deliveryType === 'entrega' ? 
            `${customerInfo.address}, ${customerInfo.complement ? customerInfo.complement + ', ' : ''}` : 
            'Retirada no local',
          instrucoes: customerInfo.instructions,
          data: new Date().toISOString(),
          restaurante: APP_CONFIG.restaurantName,
          enderecoRestaurante: APP_CONFIG.restaurantAddress

        };
        
      },

      saveOrder: async (order) => {
        try {
          const newOrderRef = database.ref('orders').push();
          await newOrderRef.set(order);
          return { ...order, id: newOrderRef.key };
        } catch (error) {
          console.error("Erro ao salvar pedido:", error);
          throw error;
        }
      },

      sendToBackend: async () => {
        try {
          // Validação básica do carrinho
          if (cart.length === 0) {
            throw new Error("Carrinho vazio");
          }

          // Validação dos campos obrigatórios
          const name = document.getElementById("customer-name").value;
          const phone = document.getElementById("customer-phone").value;
          const isDelivery = document.getElementById("delivery-method").checked;
          const address = document.getElementById("customer-address").value;
          
          if (!name || !phone) {
            throw new Error("Por favor, preencha seu nome e telefone");
          }
          
          if (!Utils.validatePhone(phone)) {
            throw new Error("Por favor, insira um telefone válido");
          }
          
          if (isDelivery && !address) {
            throw new Error("Por favor, preencha seu endereço completo");
          }

          // Mostra estado de carregamento
          DOM.confirmOrderButton.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Processando...';
          DOM.confirmOrderButton.disabled = true;

          // Cria e salva o pedido
          const order = Order.create();
          const savedOrder = await Order.saveOrder(order);
          
          if (!savedOrder) {
            throw new Error("Falha ao salvar pedido");
          }

          return savedOrder;
          
        } catch (error) {
          console.error("Erro em sendToBackend:", error);
          Utils.showNotification(`Erro: ${error.message}`, 'danger');
          return null;
          
        } finally {
          // Restaura o botão independentemente do resultado
          DOM.confirmOrderButton.innerHTML = '<i class="fas fa-check-circle me-2"></i> Confirmar Pedido';
          DOM.confirmOrderButton.disabled = false;
        }
      },

      sendToWhatsApp: (pedido) => {
    // Formata os itens do pedido com emojis e quebras de linha
    const formatItem = (item) => {
        let itemText = `🍽️ *${item.nome}* - ${item.quantidade}x ${Utils.formatCurrency(item.preco)}`;
        
        if (item.opcoes && Object.keys(item.opcoes).length > 0) {
            itemText += `\n   ⚙️ ${Object.entries(item.opcoes).map(([key, val]) => 
                `${key}: ${Array.isArray(val) ? val.join(', ') : val}`).join(' | ')}`;
        }
        
        return itemText;
    };

    // Cabeçalho do pedido
    let message = `📋 *NOVO PEDIDO - ${APP_CONFIG.restaurantName}* 📋\n\n`;
    
    // Informações do cliente
    message += `👤 *Cliente:* ${pedido.cliente}\n`;
    message += `📞 *Telefone:* ${pedido.telefone}\n`;
    
    // Adiciona NIF se existir
    if (pedido.nif) {
        message += `📝 *NIF:* ${pedido.nif}\n`;
    }
    
    // Itens do pedido
    message += `\n📦 *ITENS DO PEDIDO:*\n`;
    message += pedido.itens.map(item => formatItem(item)).join('\n');
    
    // Valores
    message += `\n\n💰 *VALORES:*\n`;
    message += `➖ Subtotal: ${Utils.formatCurrency(pedido.subtotal)}\n`;
    message += `🚚 Taxa de entrega: ${Utils.formatCurrency(pedido.taxaEntrega)}\n`;
    message += `💵 *TOTAL: ${Utils.formatCurrency(pedido.total)}*\n`;
    
    // Informações de entrega/retirada
    if (pedido.tipoEntrega === 'entrega') {
        message += `\n📍 *ENDEREÇO DE ENTREGA:*\n${pedido.endereco}\n`;
    } else {
        message += `\n🏪 *RETIRADA NO LOCAL*\n${APP_CONFIG.restaurantAddress}\n`;
    }
    
    // Instruções se existirem
    if (pedido.instrucoes) {
        message += `\n📝 *INSTRUÇÕES:*\n${pedido.instrucoes}\n`;
    }
    
    // Método de pagamento
    message += `\n💳 *FORMA DE PAGAMENTO:*\n`;
    if (pedido.metodoPagamento === 'mbway') {
        message += `MB Way - Você receberá uma solicitação de pagamento\n`;
    } else if (pedido.metodoPagamento === 'dinheiro') {
        message += `Dinheiro${pedido.trocoPara ? ` (Troco para ${Utils.formatCurrency(parseFloat(pedido.trocoPara))}` : ''}\n`;
    } else {
        message += `Cartão - Pagamento na entrega/retirada\n`;
    }
    
    // Data/hora e rodapé
    message += `\n⏰ *Data/hora:* ${new Date(pedido.data).toLocaleString('pt-BR')}\n\n`;
    message += `_🔔 Aguardamos sua confirmação!_`;
    
    // Codifica a mensagem para URL
    const whatsappURL = `https://wa.me/${APP_CONFIG.whatsappNumber}?text=${encodeURIComponent(message)}`;
    
    // Mostra o modal de confirmação e abre o WhatsApp após 3 segundos
    DOM.confirmationModal.show();
    
    setTimeout(() => {
        window.open(whatsappURL, "_blank");
        DOM.confirmationModal.hide();
        Cart.clear();
        DOM.productSection.classList.remove("d-none");
        DOM.checkoutSection.classList.add("d-none");
        Cart.toggleSidebar();
    }, 3000);
},

      updateAdminPanel: () => {
        newOrders = [];
        const statusFilter = DOM.statusFilter.value;
        const typeFilter = DOM.typeFilter.value;
        
        let filteredOrders = [...orders].reverse();
        
        if (statusFilter !== 'all') {
          filteredOrders = filteredOrders.filter(order => order.status === statusFilter);
        }
        
        if (typeFilter !== 'all') {
          filteredOrders = filteredOrders.filter(order => order.tipoEntrega === typeFilter);
        }
        
        // Agrupa pedidos por data
        const ordersByDate = {};
        filteredOrders.forEach(order => {
          const date = new Date(order.data);
          const dateKey = Utils.formatDate(order.data);
          
          if (!ordersByDate[dateKey]) {
            ordersByDate[dateKey] = [];
          }
          ordersByDate[dateKey].push(order);
        });
        
        // Atualiza as abas de dias
        DOM.dayTabs.innerHTML = '';
        Object.keys(ordersByDate).forEach(dateKey => {
          const tab = document.createElement('div');
          tab.className = 'day-tab';
          tab.textContent = dateKey;
          tab.addEventListener('click', () => {
            document.querySelectorAll('.day-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            Order.renderOrdersForDate(dateKey, ordersByDate[dateKey]);
          });
          
          if (DOM.dayTabs.children.length === 0) {
            tab.classList.add('active');
          }
          
          DOM.dayTabs.appendChild(tab);
        });
        
        // Renderiza os pedidos da primeira data ou mensagem de nenhum pedido
        DOM.ordersList.innerHTML = '';
        
        if (Object.keys(ordersByDate).length > 0) {
          const firstDate = Object.keys(ordersByDate)[0];
          Order.renderOrdersForDate(firstDate, ordersByDate[firstDate]);
        } else {
          DOM.ordersList.innerHTML = `
            <div class="list-group-item text-center py-5">
              <i class="fas fa-clipboard-list fa-3x text-muted mb-3"></i>
              <p class="mb-0">Nenhum pedido encontrado</p>
            </div>
          `;
        }
        
        const today = Utils.getTodayDate();
        const todayOrdersCount = orders.filter(order => order.data.includes(today)).length;
        const preparingOrdersCount = orders.filter(order => order.status === 'preparing').length;
        const deliveryOrdersCount = orders.filter(order => order.status === 'ready' && order.tipoEntrega === 'entrega').length;
        
        DOM.todayOrders.textContent = todayOrdersCount;
        DOM.preparingOrders.textContent = preparingOrdersCount;
        DOM.deliveryOrders.textContent = deliveryOrdersCount;
        
        Utils.updateTimestamp();
      },
      
      renderOrdersForDate: (dateKey, ordersForDate) => {
        DOM.ordersList.innerHTML = '';
        
        ordersForDate.forEach(order => {
          const orderElement = document.createElement('div');
          orderElement.className = `admin-order-card ${newOrders.includes(order.id) ? 'admin-order-new' : ''}`;
          
          const itemsHtml = order.itens.map(item => `
            <div class="admin-order-item">
              <span>${item.quantidade}x ${item.nome}${item.opcoes && Object.keys(item.opcoes).length > 0 ? ` (${Object.values(item.opcoes).join(', ')})` : ''}</span>
              <span>${Utils.formatCurrency(item.preco * item.quantidade)}</span>
            </div>
          `).join('');
          
          orderElement.innerHTML = `
            <div class="admin-order-header">
              <div>
                <span class="fw-bold">Pedido #${order.id.slice(-6)}</span>
                <span class="admin-order-status ${Order.getStatusClass(order.status)}">${Order.getStatusText(order.status)}</span>
              </div>
              <div class="text-muted small">${order.data}</div>
            </div>
            
            <div class="admin-order-body">
              <div class="mb-2">
                <div class="d-flex align-items-center mb-1">
                  <i class="fas fa-user me-2"></i>
                  <span>${order.cliente}</span>
                </div>
                <div class="d-flex align-items-center mb-1">
                  <i class="fas fa-phone me-2"></i>
                  <span>${order.telefone}</span>
                </div>
                <div class="d-flex align-items-center">
                  <i class="fas ${order.tipoEntrega === 'entrega' ? 'fa-motorcycle' : 'fa-store'} me-2"></i>
                  <span>${order.tipoEntrega === 'entrega' ? 'Entrega' : 'Retirada'}</span>
                </div>
                ${order.instrucoes ? `
                  <div class="d-flex align-items-center mt-2">
                    <i class="fas fa-sticky-note me-2"></i>
                    <span>${order.instrucoes}</span>
                  </div>
                ` : ''}
              </div>
              
              <div class="border-top pt-2">
                ${itemsHtml}
              </div>
            </div>
            
            <div class="admin-order-footer">
              <div class="admin-order-total">Total: ${Utils.formatCurrency(order.total)}</div>
              <div class="admin-order-actions">
                <button class="btn btn-outline-primary btn-sm update-status admin-btn" data-id="${order.id}" data-status="preparing">
                  <i class="fas fa-utensils me-1"></i> Preparar
                </button>
                <button class="btn btn-outline-success btn-sm update-status whatsapp-ready-btn admin-btn" data-id="${order.id}" data-status="ready">
                  <i class="fab fa-whatsapp me-1"></i> Avisar Pronto
                </button>
                <button class="btn btn-outline-danger btn-sm update-status admin-btn" data-id="${order.id}" data-status="cancelled">
                  <i class="fas fa-times me-1"></i> Cancelar
                </button>
                <button class="btn btn-outline-secondary btn-sm view-kitchen-order admin-btn" data-id="${order.id}">
                  <i class="fas fa-print me-1"></i> Imprimir
                </button>
              </div>
            </div>
          `;
          
          DOM.ordersList.appendChild(orderElement);
        });
      },
      
      getStatusText: (status) => {
        switch(status) {
          case 'pending': return 'Pendente';
          case 'preparing': return 'Em Preparo';
          case 'ready': return 'Pronto';
          case 'delivered': return 'Entregue';
          case 'cancelled': return 'Cancelado';
          default: return status;
        }
      },
      
      getStatusClass: (status) => {
        switch(status) {
          case 'pending': return 'status-pending';
          case 'preparing': return 'status-preparing';
          case 'ready': return 'status-ready';
          case 'delivered': return 'status-delivered';
          case 'cancelled': return 'status-cancelled';
          default: return 'bg-secondary';
        }
      },
      
      getPaymentText: (method, change) => {
        switch(method) {
          case 'mbway': return 'MB Way';
          case 'dinheiro': return `Dinheiro${change ? ' (Troco p/ ' + Utils.formatCurrency(parseFloat(change)) + ')' : ''}`;
          case 'cartao': return 'Cartão';
          default: return method;
        }
      },
      
      updateStatus: (orderId, newStatus) => {
        FirebaseService.updateOrderStatus(orderId, newStatus).then(success => {
          if (success) {
            Utils.showNotification(`Status do pedido #${orderId.slice(-6)} atualizado para ${Order.getStatusText(newStatus)}`, 'success');
            
            // Se o status for "preparando", enviar mensagem pelo WhatsApp
            if (newStatus === 'preparing') {
              const order = orders.find(o => o.id === orderId);
              if (order) {
                Order.sendPreparingNotification(order);
              }
            }
            
            // Se o status for "pronto", enviar mensagem pelo WhatsApp
            if (newStatus === 'ready') {
              const order = orders.find(o => o.id === orderId);
              if (order) {
                Order.sendReadyNotification(order);
              }
            }
          }
        });
      },
      
      sendPreparingNotification: (order) => {
        const message = `*🍳 Pedido em Preparo - ${APP_CONFIG.restaurantName}*%0A%0A👤 *Cliente:* ${order.cliente}%0A📞 *Telefone:* ${order.telefone}%0A%0A📦 *Número do Pedido:* #${order.id.slice(-6)}%0A%0A⏱ *Tempo estimado:* 45-50 minutos%0A%0A_Recebemos o seu pedido e estamos preparando. O tempo de espera é de 45-50 minutos. Obrigado por escolher a Cozinha da Vivi._`;
        
        const whatsappURL = `https://wa.me/${order.whatsapp.replace(/\D/g, '')}?text=${message}`;
        window.open(whatsappURL, "_blank");
      },
      
      sendReadyNotification: (order) => {
        const message = `*✅ Pedido Pronto - ${APP_CONFIG.restaurantName}*%0A%0A👤 *Cliente:* ${order.cliente}%0A📞 *Telefone:* ${order.telefone}%0A%0A📦 *Número do Pedido:* #${order.id.slice(-6)}%0A%0A🚚 *Forma de recebimento:* ${order.tipoEntrega === 'entrega' ? 'Entrega' : 'Retirada no local'}%0A%0A💰 *Total do Pedido:* ${Utils.formatCurrency(order.total)}%0A%0A_⌛ Por favor, dirija-se ao restaurante para retirar seu pedido ou aguarde a entrega._`;
        
        const whatsappURL = `https://wa.me/${order.whatsapp.replace(/\D/g, '')}?text=${message}`;
        window.open(whatsappURL, "_blank");
      },
      
// Na função Order.generateKitchenOrder, substitua todo o conteúdo por:
generateKitchenOrder: (orderId) => {
    const order = orders.find(o => o.id === orderId);
    if (!order) return '';
    
    // Função auxiliar para formatar a data
    const formatOrderDate = (dateString) => {
        try {
            // Tenta parsear como data ISO ou locale pt-BR
            let date = new Date(dateString);
            if (isNaN(date.getTime())) {
                // Tenta parsear formato pt-BR (dd/mm/yyyy, hh:mm:ss)
                const [datePart, timePart] = dateString.split(', ');
                if (datePart && timePart) {
                    const [day, month, year] = datePart.split('/');
                    const [hours, minutes, seconds] = timePart.split(':');
                    date = new Date(year, month-1, day, hours, minutes, seconds);
                }
            }
            
            return date.toLocaleString('pt-BR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        } catch (e) {
            console.error("Erro ao formatar data:", e);
            return dateString; // Retorna o original se não conseguir formatar
        }
    };

    const itemsText = order.itens.map(item => `
        <div class="kitchen-order-item">
            <span>${item.quantidade}x ${item.nome}${item.opcoes && Object.keys(item.opcoes).length > 0 ? ` (${Object.values(item.opcoes).join(', ')})` : ''}</span>
        </div>
    `).join('');
    
    const notes = order.instrucoes ? `
        <div class="kitchen-order-item">
            <span><strong>OBS:</strong> ${order.instrucoes}</span>
        </div>
    ` : '';
    
    const kitchenOrder = `
        <div class="kitchen-order" id="kitchen-order-print">
            <div class="kitchen-order-header">
                ${APP_CONFIG.restaurantName}<br>
                Pedido #${order.id.slice(-6)}
            </div>
            
            <div class="kitchen-order-item">
                <span><strong>Cliente:</strong> ${order.cliente}</span>
            </div>
            
            <div class="kitchen-order-item">
                <span><strong>${order.tipoEntrega === 'entrega' ? 'Entrega' : 'Retirada'}</strong></span>
            </div>
            
            ${order.tipoEntrega === 'entrega' ? `
                <div class="kitchen-order-item">
                    <span><strong>Endereço:</strong> ${order.endereco}</span>
                </div>
            ` : ''}
            
            <div class="kitchen-order-item">
                <span><strong>Data:</strong> ${formatOrderDate(order.data)}</span>
            </div>
            
            <div style="margin: 10px 0; border-top: 1px dashed #000;"></div>
            
            ${itemsText}
            
            ${notes}
            
            <div class="kitchen-order-footer">
                Total: ${Utils.formatCurrency(order.total)}
            </div>
        </div>
    `;
    
    return kitchenOrder;
},
      printKitchenOrder: async (orderId) => {
  try {
    // 1. Encontrar o pedido
    const order = orders.find(o => o.id === orderId);
    if (!order) {
      throw new Error("Pedido nao encontrado");
    }

    // 2. Verificar suporte Bluetooth
    if (!navigator.bluetooth) {
      throw new Error("Bluetooth nao suportado neste navegador. Use Chrome ou Edge no Android.");
    }

    // 3. Conectar à impressora Bluetooth
    const device = await navigator.bluetooth.requestDevice({
      filters: [{ 
        name: "BlueTooth Printer",
        deviceId: "27A0A417-4342-A5B4-3199-702B5E923859"
      }],
      optionalServices: ['000018f0-0000-1000-8000-00805f9b34fb']
    });

    // 4. Estabelecer conexão
    const server = await device.gatt.connect();
    const service = await server.getPrimaryService('000018f0-0000-1000-8000-00805f9b34fb');
    const characteristic = await service.getCharacteristic('00002af1-0000-1000-8000-00805f9b34fb');

    // 5. Função para envio seguro em pequenos pedaços (com tratamento de erro)
    const sendToPrinter = async (data) => {
      try {
        const encoder = new TextEncoder();
        const buffer = encoder.encode(data);
        const CHUNK_SIZE = 20; // Tamanho ainda menor para garantir
        const DELAY = 50; // Delay maior entre chunks
        
        for (let i = 0; i < buffer.length; i += CHUNK_SIZE) {
          const chunk = buffer.slice(i, i + CHUNK_SIZE);
          await characteristic.writeValue(chunk);
          await new Promise(resolve => setTimeout(resolve, DELAY));
        }
      } catch (error) {
        console.error("Erro durante envio:", error);
        throw new Error("Falha ao enviar dados para impressora");
      }
    };

    // 6. Função robusta para remoção de caracteres especiais
    const removeSpecialChars = (str) => {
      if (typeof str !== 'string') return String(str);
      
      // Mapeamento completo de caracteres
      const charMap = {
        'á':'a', 'à':'a', 'ã':'a', 'â':'a', 'ä':'a',
        'é':'e', 'è':'e', 'ê':'e', 'ë':'e',
        'í':'i', 'ì':'i', 'î':'i', 'ï':'i',
        'ó':'o', 'ò':'o', 'õ':'o', 'ô':'o', 'ö':'o',
        'ú':'u', 'ù':'u', 'û':'u', 'ü':'u',
        'Á':'A', 'À':'A', 'Ã':'A', 'Â':'A', 'Ä':'A',
        'É':'E', 'È':'E', 'Ê':'E', 'Ë':'E',
        'Í':'I', 'Ì':'I', 'Î':'I', 'Ï':'I',
        'Ó':'O', 'Ò':'O', 'Õ':'O', 'Ô':'O', 'Ö':'O',
        'Ú':'U', 'Ù':'U', 'Û':'U', 'Ü':'U',
        'ç':'c', 'Ç':'C',
        'ñ':'n', 'Ñ':'N',
        '€':'E', '$':'S', '£':'L', '¥':'Y', '¢':'c', '¤':'', '§':'', '©':'', '®':''
      };
      
      let result = '';
      for (let i = 0; i < str.length; i++) {
        result += charMap[str[i]] || str[i];
      }
      
      // Remove outros caracteres especiais (mantém apenas ASCII básico)
      return result.replace(/[^a-zA-Z0-9\s,.\-@#&]/g, '');
    };

    // 7. Gerar conteúdo seguro para impressão em partes
    const generatePrintContent = () => {
      const parts = [];
      
      // Parte 1: Cabeçalho
      let content = '';
      content += '\x1B\x40'; // Reset printer
      content += '\x1B\x52\x00'; // US ASCII character set
      content += '\x1B\x20\x00';
      content += '\x1B\x21\x00';
      content += '\x1B\x61\x01'; // Center align
      content += '\x1B\x21\x30'; // Large and bold
      content += `${removeSpecialChars(APP_CONFIG.restaurantName)}\n\n`;
      parts.push(content);
      
      // Parte 2: Dados do pedido
      content = '';
      content += '\x1B\x61\x00'; // Left align
      content += '\x1B\x21\x00';
      content += '--------------------------------\n';
      content += '\x1B\x21\x08'; // Bold
      content += `PEDIDO #${order.id.slice(-6).toUpperCase()}\n`;
      content += '\x1B\x21\x00';
      content += '--------------------------------\n\n';
      content += `Cliente: ${removeSpecialChars(order.cliente)}\n`;
      content += `Telefone: ${removeSpecialChars(order.telefone)}\n`;
      content += `Data: ${removeSpecialChars(new Date(order.data).toLocaleString('pt-BR'))}\n`;
      content += order.tipoEntrega === 'entrega' 
        ? `Endereco: ${removeSpecialChars(order.endereco)}\n\n` 
        : 'RETIRADA NO LOCAL\n\n';
      parts.push(content);
      
      // Parte 3: Itens do pedido (em chunks para evitar truncamento)
      content = '';
      content += '\x1B\x21\x08';
      content += 'ITENS DO PEDIDO:\n';
      content += '\x1B\x21\x00';
      content += '--------------------------------\n';
      parts.push(content);
      
      // Dividir itens em grupos para evitar truncamento
      const itemGroups = [];
      let currentGroup = '';
      order.itens.forEach((item, index) => {
        let itemText = `${item.quantidade}x ${removeSpecialChars(item.nome)}\n`;
        if (item.opcoes && Object.keys(item.opcoes).length > 0) {
          itemText += ' * ' + Object.entries(item.opcoes)
            .map(([key, value]) => `${removeSpecialChars(key)}: ${removeSpecialChars(value)}`)
            .join('\n * ') + '\n';
        }
        
        if ((currentGroup + itemText).length > 200) { // Limite por chunk
          itemGroups.push(currentGroup);
          currentGroup = itemText;
        } else {
          currentGroup += itemText;
        }
        
        if (index === order.itens.length - 1) {
          itemGroups.push(currentGroup);
        }
      });
      
      parts.push(...itemGroups);
      
      // Parte 4: Total e rodapé
      content = '';
      content += '--------------------------------\n';
      content += '\x1B\x61\x02'; // Right align
      content += '\x1B\x21\x08'; // Bold
      content += `TOTAL: ${removeSpecialChars(Utils.formatCurrency(order.total).replace(/[R$]/g, ''))}\n\n`;
      content += '\x1B\x61\x01'; // Center align
      content += 'Obrigado pela preferencia!\n';
      content += '\n';
      content += '\x1B\x69'; // Partial cut
      content += '\x1D\x56\x41\x00'; // Full cut
      content += '\x1B\x64\x03'; // Feed 3 lines
      parts.push(content);
      
      return parts;
    };

    // 8. Executar impressão em partes com delays maiores
    const printParts = generatePrintContent();
    for (const part of printParts) {
      await sendToPrinter(part);
      await new Promise(resolve => setTimeout(resolve, 200)); // Delay maior entre partes
    }
    
    Utils.showNotification('Comanda impressa com sucesso!', 'success');

  } catch (error) {
    console.error("Erro na impressao:", error);
    Utils.showNotification(`Falha ao imprimir: ${error.message}`, 'danger');
    
    try {
      if (device?.gatt?.connected) {
        await device.gatt.disconnect();
      }
    } catch (e) {
      console.error("Erro ao desconectar:", e);
    }
  }
}
    };

    // Funções de Filtro
    const Filter = {
      apply: (category) => {
        const products = document.querySelectorAll('.product-card');
        const tabs = document.querySelectorAll('.category-tab');
        
        products.forEach(product => {
          if (category === 'all' || product.dataset.category === category) {
            product.style.display = 'block';
            setTimeout(() => {
              product.style.opacity = '1';
            }, 50);
          } else {
            product.style.opacity = '0';
            setTimeout(() => {
              product.style.display = 'none';
            }, 300);
          }
        });
        
        tabs.forEach(tab => {
          if (tab.dataset.category === category) {
            tab.classList.add('active');
          } else {
            tab.classList.remove('active');
          }
        });
      }
    };
     // Adicionar event listeners para as novas abas de categoria
     document.querySelectorAll('.category-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        Filter.apply(tab.dataset.category);
      });
    });
    // Funções de Checkout
    const Checkout = {
      init: () => {
        const { subtotal, deliveryFee, total } = Cart.getTotals();
        
        DOM.checkoutSubtotal.textContent = Utils.formatCurrency(subtotal);
        DOM.checkoutDeliveryFee.textContent = Utils.formatCurrency(deliveryFee);
        DOM.checkoutTotal.textContent = Utils.formatCurrency(total);
        
        DOM.checkoutItems.innerHTML = '';
        cart.forEach(item => {
          const li = document.createElement("div");
          li.className = "list-group-item";
          
          let optionsText = '';
          if (item.options && Object.keys(item.options).length > 0) {
            optionsText = Object.values(item.options).map(opt => opt.join(', ')).join(' | ');
          }
          
          li.innerHTML = `
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="mb-1">${item.name}</h6>
                ${optionsText ? `<small class="text-muted">${optionsText}</small>` : ''}
              </div>
              <div class="d-flex align-items-center gap-3">
                <span class="quantity">${item.quantity}x</span>
                <span class="fw-bold">${Utils.formatCurrency(item.price * item.quantity)}</span>
              </div>
            </div>
          `;
          DOM.checkoutItems.appendChild(li);
        });
      },
      
      toggleDeliveryFields: (show) => {
        DOM.deliveryFields.forEach(field => {
    field.style.display = show ? 'block' : 'none';
  });
  
  // Atualiza os valores de entrega no carrinho e checkout
  const { subtotal, deliveryFee, total } = Cart.getTotals();
  
  document.getElementById("delivery-fee").textContent = Utils.formatCurrency(deliveryFee);
  document.getElementById("checkout-delivery-fee").textContent = Utils.formatCurrency(deliveryFee);
  
  DOM.totalElement.textContent = Utils.formatCurrency(total);
  document.getElementById("checkout-total").textContent = Utils.formatCurrency(total);
  }
    };

    // Funções de Admin
    // Correção no processo de login
    const Admin = {
      login: (username, password) => {
        if (username === APP_CONFIG.adminCredentials.username && 
            password === APP_CONFIG.adminCredentials.password) {
          isAdminLoggedIn = true;
          localStorage.setItem('adminLoggedIn', 'true');
          
          // Esconde o modal de login
          if (DOM.adminLoginModal) {
            DOM.adminLoginModal.hide();
          }
          
          // Mostra o painel admin
          DOM.adminPanel.classList.remove("d-none");
          DOM.productSection.classList.add("d-none");
          DOM.checkoutSection.classList.add("d-none");
          DOM.cartIndicator.style.display = 'none';
          DOM.adminAccessBtn.style.display = 'none';
          
          // Atualiza o painel de pedidos
          Order.updateAdminPanel();
          
          Utils.showNotification('Login realizado com sucesso!', 'success');
          return true;
        } else {
          Utils.showNotification('Usuário ou senha incorretos', 'danger');
          return false;
        }
      },
      
      logout: () => {
        isAdminLoggedIn = false;
        localStorage.setItem('adminLoggedIn', 'false');
        
        DOM.adminPanel.classList.add("d-none");
        DOM.productSection.classList.remove("d-none");
        DOM.cartIndicator.style.display = 'flex';
        DOM.adminAccessBtn.style.display = 'flex';
        
        Utils.showNotification('Logout realizado com sucesso', 'info');
      },
      
      checkLoginStatus: () => {
        if (isAdminLoggedIn) {
          DOM.adminPanel.classList.remove("d-none");
          DOM.productSection.classList.add("d-none");
          DOM.checkoutSection.classList.add("d-none");
          DOM.cartIndicator.style.display = 'none';
          DOM.adminAccessBtn.style.display = 'none';
          Order.updateAdminPanel();
        }
      }
    };

    // Funções para lidar com opções de produtos
    const ProductOptions = {
  showOptions: (productId, productName) => {
    let optionsHtml = '';
    let basePrice = 0;
    
    const isChurrascoItem = ['101', '102', '103', '104'].includes(productId);
    const isAcaiItem = ['601', '602'].includes(productId);
    const isComboItem = ['301', '302'].includes(productId);
    const isBurguerItem = ['201', '202', '203'].includes(productId);
    const isBebidaItem = productId === "5021";

    // Verificar disponibilidade de mandioca
    const mandiocaCozidaAvailable = localStorage.getItem('product_mandioca-cozida_available') !== 'false';
    const mandiocaFritaAvailable = localStorage.getItem('product_404_available') !== 'false';

    // Opções para Combo Frango Supreme (ID 301) e Combo X-Tudo (ID 302)
    if (isComboItem) {
      basePrice = productId === "301" ? 10.00 : 12.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Bebidas</div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Sem bebida">
              Sem bebida
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Água sem gás 500ml" checked>
              Água sem gás 500ml
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Água com gás Castelo">
              Água com gás Castelo
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Água com gás Pedras 500ml">
              Água com gás Pedras 500ml
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Coca-Cola">
              Coca-Cola
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Coca-Cola Zero">
              Coca-Cola Zero
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Fanta Laranja">
              Fanta Laranja
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Guaraná Antarctica">
              Guaraná Antarctica
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Ice Tea de Manga">
              Ice Tea de Manga
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Maminha (ID 102)
    else if (productId === "102") {
      basePrice = 13.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Feijão <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="feijao" value="Feijão de caldo" required>
              Feijão de caldo
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="feijao" value="Feijão tropeiro" required>
              Feijão tropeiro
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Acompanhamentos <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Banana frita" required>
              Banana frita
            </label>
          </div>
          ${mandiocaCozidaAvailable ? `
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca cozida" required>
              Mandioca cozida
            </label>
          </div>
          ` : `
          <div class="option-item disabled">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca cozida" disabled>
              Mandioca cozida
            </label>
          </div>
          `}
          ${mandiocaFritaAvailable ? `
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca frita" required>
              Mandioca frita
            </label>
          </div>
          ` : `
          <div class="option-item disabled">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca frita" disabled>
              Mandioca frita
            </label>
          </div>
          `}
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Salada <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Salada mista" required>
              Salada mista
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Vinagrete" required>
              Vinagrete
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Não quero salada" required>
              Não quero salada
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Bebidas</div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Sem bebida" checked>
              Sem bebida
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água sem gás 500ml" data-additional-price="1">
              Água sem gás 500ml <span class="additional-price">+€1,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água com gás Castelo" data-additional-price="1.5">
              Água com gás Castelo <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água com gás Pedras 500ml" data-additional-price="1.5">
              Água com gás Pedras 500ml <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola" data-additional-price="2">
              Coca-Cola <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola Zero" data-additional-price="2">
              Coca-Cola Zero <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Fanta Laranja" data-additional-price="2">
              Fanta Laranja <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Guaraná Antarctica" data-additional-price="2">
              Guaraná Antarctica <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Ice Tea de Manga" data-additional-price="2">
              Ice Tea de Manga <span class="additional-price">+€2,00</span>
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Linguiça Toscana (ID 103)
    else if (productId === "103") {
      basePrice = 12.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Feijão <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="feijao" value="Feijão de caldo" required>
              Feijão de caldo
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="feijao" value="Feijão tropeiro" required>
              Feijão tropeiro
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Acompanhamentos <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Banana frita" required>
              Banana frita
            </label>
          </div>
          ${mandiocaCozidaAvailable ? `
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca cozida" required>
              Mandioca cozida
            </label>
          </div>
          ` : `
          <div class="option-item disabled">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca cozida" disabled>
              Mandioca cozida
            </label>
          </div>
          `}
          ${mandiocaFritaAvailable ? `
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca frita" required>
              Mandioca frita
            </label>
          </div>
          ` : `
          <div class="option-item disabled">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca frita" disabled>
              Mandioca frita
            </label>
          </div>
          `}
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Salada <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Salada mista" required>
              Salada mista
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Vinagrete" required>
              Vinagrete
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Não quero salada" required>
              Não quero salada
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Bebidas</div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Sem bebida" checked>
              Sem bebida
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água sem gás 500ml" data-additional-price="1">
              Água sem gás 500ml <span class="additional-price">+€1,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água com gás Castelo" data-additional-price="1.5">
              Água com gás Castelo <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água com gás Pedras 500ml" data-additional-price="1.5">
              Água com gás Pedras 500ml <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola" data-additional-price="2">
              Coca-Cola <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola Zero" data-additional-price="2">
              Coca-Cola Zero <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Fanta Laranja" data-additional-price="2">
              Fanta Laranja <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Guaraná Antarctica" data-additional-price="2">
              Guaraná Antarctica <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Ice Tea de Manga" data-additional-price="2">
              Ice Tea de Manga <span class="additional-price">+€2,00</span>
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Costelinha de Porco (ID 104)
    else if (productId === "104") {
      basePrice = 12.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Feijão <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="feijao" value="Feijão de caldo" required>
              Feijão de caldo
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="feijao" value="Feijão tropeiro" required>
              Feijão tropeiro
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Acompanhamentos <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Banana frita" required>
              Banana frita
            </label>
          </div>
          ${mandiocaCozidaAvailable ? `
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca cozida" required>
              Mandioca cozida
            </label>
          </div>
          ` : `
          <div class="option-item disabled">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca cozida" disabled>
              Mandioca cozida
            </label>
          </div>
          `}
          ${mandiocaFritaAvailable ? `
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca frita" required>
              Mandioca frita
            </label>
          </div>
          ` : `
          <div class="option-item disabled">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca frita" disabled>
              Mandioca frita
            </label>
          </div>
          `}
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Salada <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Salada mista" required>
              Salada mista
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Vinagrete" required>
              Vinagrete
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Não quero salada" required>
              Não quero salada
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Bebidas</div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Sem bebida" checked>
              Sem bebida
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água sem gás 500ml" data-additional-price="1">
              Água sem gás 500ml <span class="additional-price">+€1,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água com gás Castelo" data-additional-price="1.5">
              Água com gás Castelo <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água com gás Pedras 500ml" data-additional-price="1.5">
              Água com gás Pedras 500ml <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola" data-additional-price="2">
              Coca-Cola <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola Zero" data-additional-price="2">
              Coca-Cola Zero <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Fanta Laranja" data-additional-price="2">
              Fanta Laranja <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Guaraná Antarctica" data-additional-price="2">
              Guaraná Antarctica <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Ice Tea de Manga" data-additional-price="2">
              Ice Tea de Manga <span class="additional-price">+€2,00</span>
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Churrasco Misto (ID 101)
    else if (productId === "101") {
      basePrice = 12.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Feijão <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="feijao" value="Feijão de caldo" required>
              Feijão de caldo
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="feijao" value="Feijão tropeiro" required>
              Feijão tropeiro
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Acompanhamentos <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Banana frita" required>
              Banana frita
            </label>
          </div>
          ${mandiocaCozidaAvailable ? `
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca cozida" required>
              Mandioca cozida
            </label>
          </div>
          ` : `
          <div class="option-item disabled">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca cozida" disabled>
              Mandioca cozida
            </label>
          </div>
          `}
          ${mandiocaFritaAvailable ? `
          <div class="option-item">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca frita" required>
              Mandioca frita
            </label>
          </div>
          ` : `
          <div class="option-item disabled">
            <label>
              <input type="radio" name="acompanhamento" value="Mandioca frita" disabled>
              Mandioca frita
            </label>
          </div>
          `}
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section" id="carnes-section">
          <div class="option-section-title">Carnes <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Coração de galinha" data-max="2">
              Coração de galinha
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Costelinha de porco" data-max="2">
              Costelinha de porco
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Filé de frango" data-max="2">
              Filé de frango
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Linguiça" data-max="2">
              Linguiça
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Maminha (Exclusiva +1€)" data-additional-price="1" data-exclusive>
              Maminha (Exclusiva) <span class="additional-price">+€1,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Maminha (combinada)">
              Maminha (Combinada)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Torresmo" data-max="2">
              Torresmo
            </label>
          </div>
          <div class="max-selection" id="max-carnes">Escolha até 2 carnes (ou 1 Maminha Exclusiva)</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Salada <span class="required-option">*</span></div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Salada mista" required>
              Salada mista
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Vinagrete" required>
              Vinagrete
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="salada" value="Não quero salada" required>
              Não quero salada
            </label>
          </div>
          <div class="max-selection">Selecione uma opção</div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Bebidas</div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Sem bebida" checked>
              Sem bebida
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água sem gás 500ml" data-additional-price="1">
              Água sem gás 500ml <span class="additional-price">+€1,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água com gás Castelo" data-additional-price="1.5">
              Água com gás Castelo <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Água com gás Pedras 500ml" data-additional-price="1.5">
              Água com gás Pedras 500ml <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola" data-additional-price="2">
              Coca-Cola <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola Zero" data-additional-price="2">
              Coca-Cola Zero <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Fanta Laranja" data-additional-price="2">
              Fanta Laranja <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Guaraná Antarctica" data-additional-price="2">
              Guaraná Antarctica <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Ice Tea de Manga" data-additional-price="2">
              Ice Tea de Manga <span class="additional-price">+€2,00</span>
            </label>
          </div>
        </div>
      `;
    }
    // Opções para X-Salada (ID 201)
    else if (productId === "201") {
      basePrice = 6.50;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Adicionais</div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="adicionais" value="Bacon" data-additional-price="1.5">
              Bacon <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="adicionais" value="Queijo extra" data-additional-price="1">
              Queijo extra <span class="additional-price">+€1,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="adicionais" value="Ovo" data-additional-price="0.5">
              Ovo <span class="additional-price">+€0,50</span>
            </label>
          </div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Remover Ingredientes</div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem cebola">
              Sem cebola
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem tomate">
              Sem tomate
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem alface">
              Sem alface
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem maionese">
              Sem maionese
            </label>
          </div>
        </div>
      `;
    }
    // Opções para X-Bacon (ID 202)
    else if (productId === "202") {
      basePrice = 8.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Adicionais</div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="adicionais" value="Queijo extra" data-additional-price="1">
              Queijo extra <span class="additional-price">+€1,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="adicionais" value="Ovo" data-additional-price="0.5">
              Ovo <span class="additional-price">+€0,50</span>
            </label>
          </div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Remover Ingredientes</div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem cebola">
              Sem cebola
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem tomate">
              Sem tomate
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem alface">
              Sem alface
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem maionese">
              Sem maionese
            </label>
          </div>
        </div>
      `;
    }
    // Opções para X-Frango (ID 203)
    else if (productId === "203") {
      basePrice = 8.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Adicionais</div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="adicionais" value="Bacon" data-additional-price="1.5">
              Bacon <span class="additional-price">+€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="adicionais" value="Queijo extra" data-additional-price="1">
              Queijo extra <span class="additional-price">+€1,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="adicionais" value="Ovo" data-additional-price="0.5">
              Ovo <span class="additional-price">+€0,50</span>
            </label>
          </div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Remover Ingredientes</div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem cebola">
              Sem cebola
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem tomate">
              Sem tomate
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem alface">
              Sem alface
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="remover" value="Sem maionese">
              Sem maionese
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Combo Frango Supreme (ID 301)
    else if (productId === "301") {
      basePrice = 10.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Bebidas</div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Sem bebida">
              Sem bebida
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Água sem gás 500ml" checked>
              Água sem gás 500ml
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Água com gás Castelo">
              Água com gás Castelo
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Água com gás Pedras 500ml">
              Água com gás Pedras 500ml
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Coca-Cola">
              Coca-Cola
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Coca-Cola Zero">
              Coca-Cola Zero
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Fanta Laranja">
              Fanta Laranja
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Guaraná Antarctica">
              Guaraná Antarctica
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Ice Tea de Manga">
              Ice Tea de Manga
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Combo X-Tudo (ID 302)
    else if (productId === "302") {
      basePrice = 12.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Bebidas</div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Sem bebida">
              Sem bebida
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Água sem gás 500ml" checked>
              Água sem gás 500ml
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Água com gás Castelo">
              Água com gás Castelo
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Água com gás Pedras 500ml">
              Água com gás Pedras 500ml
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Coca-Cola">
              Coca-Cola
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Coca-Cola Zero">
              Coca-Cola Zero
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Fanta Laranja">
              Fanta Laranja
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Guaraná Antarctica">
              Guaraná Antarctica
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida_combo" value="Ice Tea de Manga">
              Ice Tea de Manga
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Porção de Arroz (ID 401)
    else if (productId === "401") {
      basePrice = 3.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Observações</div>
          <div class="option-item">
            <textarea class="form-control" id="observacoes" rows="3" placeholder="Alguma observação sobre este item?"></textarea>
          </div>
        </div>
      `;
    }
    // Opções para Queijo Coalho (ID 402)
    else if (productId === "402") {
      basePrice = 6.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Tamanho</div>
          <div class="option-item">
            <label>
              <input type="radio" name="tamanho" value="Pequena" checked>
              Pequena (200g)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="tamanho" value="Grande" data-additional-price="2">
              Grande (400g) <span class="additional-price">+€2,00</span>
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Torresmo (ID 403)
    else if (productId === "403") {
      basePrice = 6.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Tamanho</div>
          <div class="option-item">
            <label>
              <input type="radio" name="tamanho" value="Pequena" checked>
              Pequena (200g)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="tamanho" value="Grande" data-additional-price="2">
              Grande (400g) <span class="additional-price">+€2,00</span>
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Porção de Mandioca (ID 404)
    else if (productId === "404") {
      basePrice = 6.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Tipo</div>
          <div class="option-item">
            <label>
              <input type="radio" name="tipo_mandioca" value="Frita" checked>
              Frita
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="tipo_mandioca" value="Cozida">
              Cozida
            </label>
          </div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Tamanho</div>
          <div class="option-item">
            <label>
              <input type="radio" name="tamanho" value="Pequena" checked>
              Pequena (200g)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="tamanho" value="Grande" data-additional-price="2">
              Grande (400g) <span class="additional-price">+€2,00</span>
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Porção de Batata Frita (ID 405)
    else if (productId === "405") {
      basePrice = 3.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Tamanho</div>
          <div class="option-item">
            <label>
              <input type="radio" name="tamanho" value="Pequena" checked>
              Pequena (200g)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="tamanho" value="Grande" data-additional-price="1.5">
              Grande (400g) <span class="additional-price">+€1,50</span>
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Porção de Carnes (ID 406)
    else if (productId === "406") {
      basePrice = 10.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Carnes</div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Coração de galinha">
              Coração de galinha
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Costelinha de porco">
              Costelinha de porco
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Filé de frango">
              Filé de frango
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Linguiça">
              Linguiça
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Maminha (+2€)" data-additional-price="2">
              Maminha <span class="additional-price">+€2,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="carnes" value="Torresmo">
              Torresmo
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Bebidas (Refrigerantes e Águas - ID 5021)
    else if (isBebidaItem) {
      basePrice = 2.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Tipo de Bebida</div>
          <div class="option-item">
            <label>
              <input type="radio" name="tipo_bebida" value="refrigerante" checked id="tipo-refrigerante">
              Refrigerante (€2,00)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="tipo_bebida" value="agua" id="tipo-agua">
              Água
            </label>
          </div>
        </div>

        <div class="option-section" id="refrigerantes-section">
          <div class="option-section-title">Escolha seu refrigerante</div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola" checked>
              Coca-Cola
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="7Up">
              7Up
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Coca-Cola Zero">
              Coca-Cola Zero
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Fanta Laranja">
              Fanta Laranja
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Guaraná Antarctica">
              Guaraná Antarctica
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="bebida" value="Ice Tea de Manga">
              Ice Tea de Manga
            </label>
          </div>
        </div>

        <div class="option-section" id="aguas-section" style="display: none;">
          <div class="option-section-title">Escolha sua água</div>
          <div class="option-item">
            <label>
              <input type="radio" name="agua" value="Água sem gás 500ml" data-price="1.00">
              Água sem gás 500ml <span class="additional-price">€1,00</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="agua" value="Água com gás Castelo (pequena)" data-price="1.50">
              Água com gás Castelo (pequena) <span class="additional-price">€1,50</span>
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="agua" value="Água com gás Pedras (pequena)" data-price="1.50">
              Água com gás Pedras (pequena) <span class="additional-price">€1,50</span>
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Açai Pequeno (ID 601)
    else if (productId === "601") {
      basePrice = 6.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Escolha seus acompanhamentos</div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="acompanhamentos" value="Granola">
              Granola
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="acompanhamentos" value="Leite condensado">
              Leite condensado
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="acompanhamentos" value="Banana">
              Banana
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="acompanhamentos" value="Morango">
              Morango
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="acompanhamentos" value="Leite Ninho">
              Leite Ninho
            </label>
          </div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Ou selecione:</div>
          <div class="option-item">
            <label>
              <input type="radio" name="opcao_açai" value="completo" id="açai-completo">
              Quero Completo (todos os acompanhamentos)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="opcao_açai" value="personalizado" checked id="açai-personalizado">
              Personalizado (escolher acompanhamentos)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="opcao_açai" value="puro">
              Quero Açai Puro
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Açai Grande (ID 602)
    else if (productId === "602") {
      basePrice = 10.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Escolha seus acompanhamentos</div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="acompanhamentos" value="Granola">
              Granola
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="acompanhamentos" value="Leite condensado">
              Leite condensado
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="acompanhamentos" value="Banana">
              Banana
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="acompanhamentos" value="Morango">
              Morango
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="checkbox" name="acompanhamentos" value="Leite Ninho">
              Leite Ninho
            </label>
          </div>
        </div>
        
        <div class="option-section">
          <div class="option-section-title">Ou selecione:</div>
          <div class="option-item">
            <label>
              <input type="radio" name="opcao_açai" value="completo" id="açai-completo">
              Quero Completo (todos os acompanhamentos)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="opcao_açai" value="personalizado" checked id="açai-personalizado">
              Personalizado (escolher acompanhamentos)
            </label>
          </div>
          <div class="option-item">
            <label>
              <input type="radio" name="opcao_açai" value="puro">
              Quero Açai Puro
            </label>
          </div>
        </div>
      `;
    }
    // Opções para Pudim Caseiro (ID 603)
    else if (productId === "603") {
      basePrice = 3.00;
      
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Observações</div>
          <div class="option-item">
            <textarea class="form-control" id="observacoes" rows="3" placeholder="Alguma observação sobre este item?"></textarea>
          </div>
        </div>
      `;
    }
    // Opções padrão para outros produtos
    else {
      optionsHtml = `
        <div class="option-section">
          <div class="option-section-title">Observações</div>
          <div class="option-item">
            <textarea class="form-control" id="observacoes" rows="3" placeholder="Alguma observação sobre este item?"></textarea>
          </div>
        </div>
      `;
    }

    DOM.productOptionsModalTitle.textContent = `Opções: ${productName}`;
    DOM.productOptionsContent.innerHTML = optionsHtml;
    
    currentProductOptions = {
      id: productId,
      name: productName,
      price: basePrice,
      image: document.querySelector(`.product-card[data-id="${productId}"] .product-image`)?.src || ''
    };

    // Configura eventos específicos após o modal ser exibido
    setTimeout(() => {
      // Controle para açaí completo/personalizado
      if (isAcaiItem) {
        const acaiCompleto = document.getElementById('açai-completo');
        const acaiPersonalizado = document.getElementById('açai-personalizado');
        const checkboxes = document.querySelectorAll('input[name="acompanhamentos"]');

        acaiCompleto.addEventListener('change', function() {
          if (this.checked) {
            checkboxes.forEach(checkbox => {
              checkbox.checked = true;
              checkbox.disabled = true;
              checkbox.closest('.option-item').classList.add('disabled');
            });
          }
        });

        acaiPersonalizado.addEventListener('change', function() {
          if (this.checked) {
            checkboxes.forEach(checkbox => {
              checkbox.disabled = false;
              checkbox.checked = false;
              checkbox.closest('.option-item').classList.remove('disabled');
            });
          }
        });
      }

      // Controle para alternar entre refrigerantes e águas
      if (isBebidaItem) {
        document.getElementById('tipo-refrigerante').addEventListener('change', function() {
          document.getElementById('refrigerantes-section').style.display = 'block';
          document.getElementById('aguas-section').style.display = 'none';
          currentProductOptions.price = 2.00;
        });

        document.getElementById('tipo-agua').addEventListener('change', function() {
          document.getElementById('refrigerantes-section').style.display = 'none';
          document.getElementById('aguas-section').style.display = 'block';
          currentProductOptions.price = 1.00;
        });
      }

      // Controle para carnes no churrasco misto (ID 101)
      if (productId === "101") {
        const carnesCheckboxes = document.querySelectorAll('#carnes-section input[type="checkbox"]');
        const maxCarnesMessage = document.getElementById('max-carnes');
        
        carnesCheckboxes.forEach(checkbox => {
          checkbox.addEventListener('change', function() {
            const isExclusive = this.hasAttribute('data-exclusive');
            const isCombinableMaminha = this.value.includes("(combinada)");
            const checkedCount = Array.from(carnesCheckboxes)
              .filter(cb => cb.checked && !cb.hasAttribute('data-exclusive') && !cb.value.includes("(combinada)")).length;
            
            // Se selecionou Maminha Exclusiva
            if (isExclusive && this.checked) {
              maxCarnesMessage.textContent = "Maminha Exclusiva selecionada (+€1,00)";
              carnesCheckboxes.forEach(cb => {
                if (cb !== this) {
                  cb.checked = false;
                  cb.disabled = true;
                  cb.closest('.option-item').classList.add('disabled');
                }
              });
            } 
            // Se selecionou Maminha Combinada
            else if (isCombinableMaminha && this.checked) {
              maxCarnesMessage.textContent = "Maminha Combinada selecionada - pode escolher mais 1 carne";
              
              // Permite selecionar mais 1 carne normal
              carnesCheckboxes.forEach(cb => {
                if (!cb.hasAttribute('data-exclusive') && !cb.checked && !cb.value.includes("(combinada)")) {
                  cb.disabled = false;
                  cb.closest('.option-item').classList.remove('disabled');
                }
              });
            }
            // Se selecionou carnes normais
            else if (this.checked && !isExclusive && !isCombinableMaminha) {
              const maminhaCombinadaSelected = Array.from(carnesCheckboxes)
                .some(cb => cb.value.includes("(combinada)") && cb.checked);
              
              if (maminhaCombinadaSelected && checkedCount >= 1) {
                maxCarnesMessage.textContent = "Limite atingido (1 carne + Maminha Combinada)";
                carnesCheckboxes.forEach(cb => {
                  if (!cb.checked && !cb.hasAttribute('data-exclusive') && !cb.value.includes("(combinada)")) {
                    cb.disabled = true;
                    cb.closest('.option-item').classList.add('disabled');
                  }
                });
              } 
              else if (!maminhaCombinadaSelected && checkedCount >= 2) {
                maxCarnesMessage.textContent = "Limite de 2 carnes atingido";
                carnesCheckboxes.forEach(cb => {
                  if (!cb.checked && !cb.hasAttribute('data-exclusive') && !cb.value.includes("(combinada)")) {
                    cb.disabled = true;
                    cb.closest('.option-item').classList.add('disabled');
                  }
                });
              }
            }
            // Se desmarcou algo
            else if (!this.checked) {
              const anyChecked = Array.from(carnesCheckboxes).some(cb => cb.checked);
              
              if (!anyChecked) {
                maxCarnesMessage.textContent = "Escolha até 2 carnes (ou 1 Maminha Exclusiva)";
                carnesCheckboxes.forEach(cb => {
                  cb.disabled = false;
                  cb.closest('.option-item').classList.remove('disabled');
                });
              }
            }
          });
        });
      }
    }, 100);
    
    DOM.productOptionsModal.show();
  },

  handleOptionsConfirmation: () => {
    // Validação de campos obrigatórios
    const requiredSections = DOM.productOptionsContent.querySelectorAll('.option-section [required]');
    let isValid = true;
    
    requiredSections.forEach(section => {
      const sectionContainer = section.closest('.option-section');
      if (sectionContainer.style.display !== 'none') {
        const maxMessage = sectionContainer.querySelector('.max-selection');
        
        if (section.type === 'checkbox' || section.type === 'radio') {
          const selected = sectionContainer.querySelector('input:checked');
          if (!selected) {
            maxMessage.style.display = 'block';
            sectionContainer.classList.add('required-field');
            isValid = false;
          }
        }
      }
    });
    
    if (!isValid) {
      Utils.showNotification('Por favor, selecione todas as opções obrigatórias', 'danger');
      return;
    }
    
    // Coletar todas as opções selecionadas
    const options = {};
    
    // Lógica específica para Combos
    if (['301', '302'].includes(currentProductOptions.id)) {
      const bebidaSelecionada = document.querySelector('input[name="bebida_combo"]:checked');
      if (bebidaSelecionada && bebidaSelecionada.value !== "Sem bebida") {
        options["Bebida"] = [bebidaSelecionada.value];
      }
    }
    // Lógica específica para Açaí
    else if (['601', '602'].includes(currentProductOptions.id)) {
      const opcaoCompleta = document.getElementById('açai-completo').checked;
      const acompanhamentos = [];
      
      if (opcaoCompleta) {
        options["Acompanhamentos"] = ["Completo (todos os acompanhamentos)"];
      } else {
        document.querySelectorAll('input[name="acompanhamentos"]:checked').forEach(input => {
          acompanhamentos.push(input.value);
        });
        options["Acompanhamentos"] = acompanhamentos.length > 0 ? acompanhamentos : ["Sem acompanhamentos"];
      }
    }
    // Lógica para Bebidas (Refrigerantes e Águas)
    else if (currentProductOptions.id === "5021") {
      const isAgua = document.getElementById('tipo-agua').checked;
      
      if (isAgua) {
        const aguaSelecionada = document.querySelector('input[name="agua"]:checked');
        if (aguaSelecionada) {
          options["Tipo"] = ["Água"];
          options["Sabor"] = [aguaSelecionada.value];
          currentProductOptions.price = parseFloat(aguaSelecionada.getAttribute('data-price') || 0);
        }
      } else {
        const refrigeranteSelecionado = document.querySelector('input[name="bebida"]:checked');
        if (refrigeranteSelecionado) {
          options["Tipo"] = ["Refrigerante"];
          options["Sabor"] = [refrigeranteSelecionado.value];
          currentProductOptions.price = 2.00;
        }
      }
    }
    // Lógica para outros produtos
    else {
      const sections = DOM.productOptionsContent.querySelectorAll('.option-section');
      
      sections.forEach(section => {
        const title = section.querySelector('.option-section-title')?.textContent.replace(' *', '');
        const inputs = section.querySelectorAll('input:checked');
        
        if (inputs.length > 0 && title) {
          options[title] = Array.from(inputs).map(input => {
            const additionalPrice = input.getAttribute('data-additional-price') || 0;
            if (additionalPrice) {
              currentProductOptions.price += parseFloat(additionalPrice);
            }
            return input.value;
          });
        }
      });
    }
    
    // Adicionar ao carrinho com as opções
    Cart.addItem(
      currentProductOptions.id,
      currentProductOptions.name,
      currentProductOptions.price,
      currentProductOptions.image,
      options
    );
    
    // Resetar o produto atual e fechar o modal
    currentProductOptions = null;
    DOM.productOptionsModal.hide();
    
    // Mostrar feedback visual
    DOM.confirmProductOptions.classList.add('added');
    setTimeout(() => {
      DOM.confirmProductOptions.classList.remove('added');
    }, 2000);
  }
};
// Função auxiliar para selecionar todos os acompanhamentos do açaí
function selectAllAçaiToppings() {
  const checkboxes = document.querySelectorAll('input[name="acompanhamentos"]');
  checkboxes.forEach(checkbox => {
    checkbox.checked = true;
  });
}
    // Event Listeners
    function setupEventListeners() {
    // Botão Adicionar ao Carrinho
    document.addEventListener('click', (event) => {
        if (event.target.closest('.add-to-cart')) {
            const button = event.target.closest('.add-to-cart');
            const productCard = button.closest('.product-card');
            
            if (productCard) {
                const id = productCard.getAttribute("data-id");
                const nameElement = productCard.querySelector(".product-name");
                const priceElement = productCard.querySelector(".product-price");
                const imageElement = productCard.querySelector(".product-image");
                
                if (nameElement && priceElement) {
                    const name = nameElement.textContent;
                    const price = Utils.parsePrice(priceElement.textContent);
                    const image = imageElement?.src || '';
                    
                    if (productCard.getAttribute('data-has-options') === 'true') {
                        ProductOptions.showOptions(id, name);
                    } else {
                        Cart.addItem(id, name, price, image);
                    }
                }
            }
        }

        // Remover item do carrinho
        if (event.target.closest('.remove-item')) {
            const id = event.target.closest('.remove-item').getAttribute("data-id");
            Cart.removeItem(id);
        }

        // Aumentar quantidade
        if (event.target.closest('.increase')) {
            const id = event.target.closest('.increase').getAttribute("data-id");
            const item = cart.find(item => item.id === id);
            if (item) {
                Cart.updateItemQuantity(id, item.quantity + 1);
            }
        }

        // Diminuir quantidade
        if (event.target.closest('.decrease')) {
            const id = event.target.closest('.decrease').getAttribute("data-id");
            const item = cart.find(item => item.id === id);
            if (item) {
                Cart.updateItemQuantity(id, item.quantity - 1);
            }
        }
    });

    // Botão Finalizar Pedido
    if (DOM.checkoutButton) {
        DOM.checkoutButton.addEventListener('click', function(e) {
            e.preventDefault();
            
            if (cart.length === 0) {
                alert('Seu carrinho está vazio!');
                return;
            }

            if (DOM.productSection && DOM.checkoutSection) {
                DOM.productSection.classList.add("d-none");
                DOM.checkoutSection.classList.remove("d-none");
                Checkout.init();
                
                if (DOM.cartSidebar && DOM.cartSidebar.classList.contains('show')) {
                    Cart.toggleSidebar();
                }
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });
    }

    // Botão Voltar para o Carrinho
    if (DOM.backToCartButton) {
        DOM.backToCartButton.addEventListener("click", () => {
            if (DOM.productSection && DOM.checkoutSection) {
                DOM.productSection.classList.remove("d-none");
                DOM.checkoutSection.classList.add("d-none");
            }
        });
    }

    // Botões de Categoria
    document.querySelectorAll('.category-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.category-tab').forEach(c => c.classList.remove('active'));
            tab.classList.add('active');
            Filter.apply(tab.dataset.category);
        });
    });

    // Botão do Carrinho
    if (DOM.cartIndicator) {
        DOM.cartIndicator.addEventListener('click', () => {
            Cart.toggleSidebar();
        });
    }

    // Botão Fechar Carrinho
    if (DOM.closeCart) {
        DOM.closeCart.addEventListener('click', () => {
            Cart.toggleSidebar();
        });
    }
    
    // Overlay do Carrinho
    if (DOM.cartOverlay) {
        DOM.cartOverlay.addEventListener('click', () => {
            Cart.toggleSidebar();
        });
    }
    
    // Opções de Entrega
 // Opções de Entrega
DOM.deliveryOptionCards?.forEach(card => {
  card.addEventListener('click', () => {
    const input = card.querySelector('input');
    if (input) {
      input.checked = true;
      DOM.deliveryOptionCards?.forEach(c => c.classList.remove('active'));
      card.classList.add('active');
      
      // Atualiza os campos e valores
      Checkout.toggleDeliveryFields(input.value === 'entrega');
      
      // Atualiza o carrinho
      Cart.updateUI();
    }
  });
});

    // Geolocalização para endereço automático (NOVO)
    if (navigator.geolocation && document.getElementById('delivery-method')) {
    document.getElementById('delivery-method').addEventListener('change', function() {
        if (this.checked) {
            const addressField = document.getElementById('customer-address');
            const originalPlaceholder = addressField.placeholder;
            addressField.placeholder = "Obtendo sua localização...";
            addressField.disabled = true;
            
            navigator.geolocation.getCurrentPosition(
                position => {
                    fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${position.coords.latitude}&lon=${position.coords.longitude}`)
                        .then(response => {
                            if (!response.ok) throw new Error('Erro na API');
                            return response.json();
                        })
                        .then(data => {
                            if (data.address) {
                                const road = data.address.road || data.address.footway || '';
                                const houseNumber = data.address.house_number || '';
                                const suburb = data.address.suburb || '';
                                const city = data.address.city || data.address.town || data.address.village || data.address.municipality || '';
                                const postcode = data.address.postcode || '';
                                
                                let addressParts = [];
                                if (road) addressParts.push(road);
                                if (houseNumber) addressParts.push(houseNumber);
                                if (suburb && suburb !== city) addressParts.push(suburb);
                                if (city) addressParts.push(city);
                                if (postcode) addressParts.push(postcode);
                                
                                addressField.value = addressParts.join(', ');
                            }
                        })
                        .catch(error => {
                            console.error("Erro ao obter endereço:", error);
                            Utils.showNotification("Não foi possível obter o endereço automaticamente. Por favor, preencha manualmente.", "warning");
                        })
                        .finally(() => {
                            addressField.placeholder = originalPlaceholder;
                            addressField.disabled = false;
                        });
                },
                error => {
                    console.error("Erro ao obter localização:", error);
                    addressField.placeholder = originalPlaceholder;
                    addressField.disabled = false;
                    Utils.showNotification("Por favor, ative a localização ou preencha o endereço manualmente.", "warning");
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
        }
    });
}
    // Métodos de Pagamento
    DOM.paymentMethodCards?.forEach(card => {
        card.addEventListener('click', () => {
            const input = card.querySelector('input');
            if (input) {
                input.checked = true;
                DOM.paymentMethodCards?.forEach(c => c.classList.remove('active'));
                card.classList.add('active');
                
                if (input.value === 'dinheiro' && DOM.cashChangeField) {
                    DOM.cashChangeField.classList.remove('d-none');
                } else if (DOM.cashChangeField) {
                    DOM.cashChangeField.classList.add('d-none');
                }
            }
        });
    });

// Controle do campo NIF - Mantenha esse primeiro
document.querySelectorAll('input[name="fatura"]').forEach(radio => {
  radio.addEventListener('change', function() {
    const nifField = document.getElementById('nif-field');
    if (this.value === 'sim') {
      nifField.classList.remove('d-none');
      document.getElementById('customer-nif').focus();
    } else {
      nifField.classList.add('d-none');
    }
  });
});

// Validação do NIF em tempo real (apenas números e limite de 9 dígitos)
document.getElementById('customer-nif')?.addEventListener('input', function(e) {
  this.value = this.value.replace(/\D/g, ''); // Remove não-números
  if (this.value.length > 9) {
    this.value = this.value.slice(0, 9); // Limita a 9 dígitos
  }
});

// Submissão com Enter - Adicione este novo listener
document.getElementById('customer-nif')?.addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    e.preventDefault();
    
    // Valida se está completo antes de submeter
    if (this.value.length === 9) {
      document.getElementById('confirm-order-button').click();
    } else {
      Utils.showNotification("O NIF precisa ter 9 dígitos", "warning");
      this.focus();
    }
  }
});

    // Botão de acesso admin
    if (DOM.adminAccessBtn) {
        DOM.adminAccessBtn.addEventListener('click', () => {
            if (DOM.adminLoginModal) {
                DOM.adminLoginModal.show();
            }
        });
    }
  
    // Formulário de Login Admin
    const adminLoginForm = document.getElementById('admin-login-form');
    if (adminLoginForm) {
        adminLoginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('admin-username')?.value;
            const password = document.getElementById('admin-password')?.value;
            
            if (username && password) {
                Admin.login(username, password);
            } else {
                Utils.showNotification('Por favor, preencha todos os campos', 'danger');
            }
        });
    }

    // Botão Logout Admin
    if (DOM.adminLogoutButton) {
        DOM.adminLogoutButton.addEventListener('click', () => {
            Admin.logout();
        });
    }
    
    // Botões no Painel Admin
    if (DOM.ordersList) {
        DOM.ordersList.addEventListener('click', (event) => {
            if (event.target.closest('.update-status')) {
                const button = event.target.closest('.update-status');
                const orderId = button.getAttribute('data-id');
                const newStatus = button.getAttribute('data-status');
                Order.updateStatus(orderId, newStatus);
            }
            
            if (event.target.closest('.view-kitchen-order')) {
                const button = event.target.closest('.view-kitchen-order');
                const orderId = button.getAttribute('data-id');
                const kitchenOrder = Order.generateKitchenOrder(orderId);
                DOM.kitchenOrderContent.innerHTML = kitchenOrder;
                DOM.kitchenOrderModal.show();
            }
        });
    }

    // Botão Imprimir Pedido
    if (DOM.printKitchenOrder) {
        DOM.printKitchenOrder.addEventListener('click', () => {
            const orderId = document.querySelector('.view-kitchen-order.active')?.getAttribute('data-id') || 
                            document.querySelector('.view-kitchen-order')?.getAttribute('data-id');
            if (orderId) {
                Order.printKitchenOrder(orderId);
                DOM.kitchenOrderModal.hide();
            }
        });
    }
    
    // Botão Aplicar Filtros
    if (DOM.applyFilters) {
        DOM.applyFilters.addEventListener('click', () => {
            Order.updateAdminPanel();
        });
    }

    // Notificação de Pedidos
    if (DOM.notificationBell) {
        DOM.notificationBell.addEventListener('click', () => {
            DOM.notificationBadge.classList.add('d-none');
            pendingOrdersCount = 0;
            newOrders = [];
        });
    }
    
    // Confirmar Opções do Produto
    if (DOM.confirmProductOptions) {
        DOM.confirmProductOptions.addEventListener('click', () => {
            ProductOptions.handleOptionsConfirmation();
        });
    }

    // Botão Confirmar Pedido
    if (DOM.confirmOrderButton) {
        DOM.confirmOrderButton.addEventListener('click', async (e) => {
            e.preventDefault();
            
            // Validar campos obrigatórios
            const name = document.getElementById('customer-name').value;
            const phone = document.getElementById('customer-phone').value;
            const isDelivery = document.getElementById('delivery-method').checked;
            const address = document.getElementById('customer-address').value;
            
            if (!name || !phone) {
                Utils.showNotification('Por favor, preencha seu nome e telefone', 'danger');
                return;
            }
            
            if (!Utils.validatePhone(phone)) {
                Utils.showNotification('Por favor, insira um telefone válido', 'danger');
                return;
            }
            
            if (isDelivery && !address) {
                Utils.showNotification('Por favor, preencha seu endereço completo', 'danger');
                return;
            }

            try {
                // Mostrar estado de carregamento
                DOM.confirmOrderButton.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Processando...';
                DOM.confirmOrderButton.disabled = true;

                // Criar e salvar o pedido
                const order = Order.create();
                const savedOrder = await Order.saveOrder(order);
                
                if (!savedOrder) {
                    throw new Error("Falha ao salvar pedido");
                }

                // Enviar para WhatsApp
                Order.sendToWhatsApp(savedOrder);
                
            } catch (error) {
                console.error("Erro ao confirmar pedido:", error);
                Utils.showNotification(`Erro: ${error.message}`, 'danger');
                
            } finally {
                // Restaurar o botão
                DOM.confirmOrderButton.innerHTML = '<i class="fas fa-check-circle me-2"></i> Confirmar Pedido';
                DOM.confirmOrderButton.disabled = false;
            }
        });
    }
}
    
document.addEventListener('DOMContentLoaded', function() {
    // Atualiza a disponibilidade dos produtos logo após o carregamento da página
    updateProductAvailability();
  
    // Força a atualização inicial dos estados dos switches
    document.querySelectorAll('.admin-switch-container input[type="checkbox"]').forEach(switchElement => {
        const productId = switchElement.id.replace('-switch', ''); // Extrai o ID do produto
        const isAvailable = localStorage.getItem(`product_${productId}_available`) !== 'false'; // Verifica o estado salvo no localStorage
        switchElement.checked = isAvailable; // Define o estado do switch
        updateSwitchStyle(switchElement, isAvailable); // Atualiza o estilo visual do switch
        updateProductDisplay(productId, isAvailable); // Atualiza a exibição do produto com base na disponibilidade
    });
  
    // Verifica e exibe as seções adequadas
    if (DOM.productSection && DOM.checkoutSection && DOM.adminPanel) {
        DOM.productSection.classList.remove("d-none"); // Exibe a seção de produtos
        DOM.checkoutSection.classList.add("d-none"); // Oculta a seção de checkout
        DOM.adminPanel.classList.add("d-none"); // Oculta o painel administrativo
    }

    // Configura os event listeners
    setupEventListeners();
    
    // Atualiza a interface do carrinho
    Cart.updateUI();
    
    // Aplica o filtro de produtos
    Filter.apply('all');
    
    // Exibe ou oculta os campos de entrega com base no estado do pedido
    Checkout.toggleDeliveryFields(true);
    
    // Verifica o status de login do administrador
    Admin.checkLoginStatus();

    // Escuta por novos pedidos no Firebase e atualiza o painel de administração, se necessário
    FirebaseService.listenForOrders((ordersFromFirebase) => {
        orders = ordersFromFirebase; // Atualiza a lista de pedidos
        if (isAdminLoggedIn) { // Se o administrador estiver logado, atualiza o painel
            Order.updateAdminPanel();
        }
    });
});


    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>   